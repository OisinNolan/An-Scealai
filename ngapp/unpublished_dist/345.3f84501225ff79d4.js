(self.webpackChunkan_scealai=self.webpackChunkan_scealai||[]).push([[345],{6345:(l,h,n)=>{"use strict";n.r(h),n.d(h,{StudentModule:()=>sn});var s=n(6895),o=n(1390),a=n(970),d=n(6839),t=n(4650);let m=(()=>{class i{canDeactivate(e,r,c){if(e.chosenSections)for(const _ of e.chosenSections)_.stop();return!0}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var u=n(5861),f=n(4715),T=n(1765),y=n(1745),b=n(1512),x=n(6469),v=n(8977),p=n(4687),w=n(1245),S=n(25),k=n(5042),O=n(530),C=n(8443);let A=(()=>{class i{transform(e,r){return e?r?(r=r.toLocaleLowerCase(),e.filter(c=>c instanceof C.n?c.username.toLocaleLowerCase().includes(r):c instanceof f.o?c.title.toLocaleLowerCase().includes(r)||c.text.toLocaleLowerCase().includes(r):void 0)):e:[]}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275pipe=t.Yjl({name:"appFilter",type:i,pure:!0}),i})();var j=n(4633),B=n(3905),H=n(5412),L=n(4006);function q(i,g){1&i&&(t.TgZ(0,"div",17),t._UZ(1,"grid-spinner"),t.qZA())}function N(i,g){if(1&i&&(t.TgZ(0,"div",17),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.ts.l.click_new_story," ")}}function z(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"input",23),t.NdJ("click",function(){t.CHM(e);const c=t.oxw().$implicit,_=t.oxw();return t.KtG(_.toggleDelete(c._id))}),t.qZA()}}function E(i,g){if(1&i&&(t.TgZ(0,"div",24),t._uU(1),t.ALo(2,"date"),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.lastUpdated,"M/d/yy, h:mm a"))}}function K(i,g){if(1&i&&(t.TgZ(0,"div",24),t._uU(1),t.ALo(2,"date"),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.lastUpdated,"d/M/yy, h:mm a"))}}const nt=function(i){return["../dashboard",i]};function ut(i,g){if(1&i&&(t.TgZ(0,"div")(1,"div",18)(2,"div",19),t.YNc(3,z,1,0,"input",20),t.TgZ(4,"div",21),t._uU(5),t.qZA()(),t.YNc(6,E,3,4,"div",22),t.YNc(7,K,3,4,"div",22),t.qZA(),t._UZ(8,"hr"),t.qZA()),2&i){const e=g.$implicit,r=t.oxw();t.xp6(3),t.Q6J("ngIf",r.deleteMode),t.xp6(1),t.Q6J("searchedWord",r.searchText)("content",e.title)("classToApply","font-weight-bold")("setTitle","true")("routerLink",t.VKq(9,nt,e._id)),t.xp6(1),t.hij(" ",e.title," "),t.xp6(1),t.Q6J("ngIf",r.isFromAmerica),t.xp6(1),t.Q6J("ngIf",!r.isFromAmerica)}}function bt(i,g){if(1&i&&(t.TgZ(0,"span",27),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.unreadMessages," ")}}function _t(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.goToMessages())}),t._uU(1),t.YNc(2,bt,2,1,"span",26),t.qZA()}if(2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.ts.l.messages," "),t.xp6(1),t.Q6J("ngIf",e.unreadMessages>0)}}function Tt(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.goToStats())}),t._uU(1),t.qZA()}if(2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.ts.l.stats," ")}}let pt=(()=>{class i{constructor(e,r,c,_,I,M,Z,F,Q,G,R){this.storyService=e,this.auth=r,this.engagement=c,this.ts=_,this.router=I,this.messageService=M,this.profileService=Z,this.classroomService=F,this.notificationService=Q,this.recordingService=G,this.dialog=R,this.stories=[],this.toBeDeleted=[],this.userId="",this.messagesForNotifications=[],this.unreadMessages=0,this.isFromAmerica=!1,this.isEnrolled=!1,this.searchText="",this.storiesLoaded=!1}ngOnInit(){var e=this;return(0,u.Z)(function*(){const r=e.auth.getUserDetails();r?(e.stories=(yield(0,B.z)(e.storyService.getStoriesForLoggedInUser())).map(c=>(new f.o).fromJSON(c)),e.stories.sort((c,_)=>c.date>_.date?-1:1),e.storiesLoaded=!0,e.userId=r._id,e.deleteMode=!1,e.toBeDeleted=[],e.notificationService.getStudentNotifications(),e.classroomService.getClassroomOfStudent(e.userId).subscribe(c=>{e.isEnrolled=null!=c}),e.messageService.getMessagesForLoggedInUser().subscribe(c=>{e.messagesForNotifications=c,e.unreadMessages=e.messageService.getNumberOfUnreadMessages(e.messagesForNotifications)}),e.profileService.getForUser(e.userId).subscribe(c=>{let I=c.profile.country;e.isFromAmerica="United States of America"==I||"America"==I||"USA"==I||"United States"==I},c=>{e.router.navigateByUrl("/register-profile")})):e.auth.logout()})()}toggleDeleteMode(){if(this.deleteMode&&this.toBeDeleted.length>0)for(let e of this.toBeDeleted)this.engagement.addEventForLoggedInUser(b.tw["DELETE-STORY"],{_id:e}),this.recordingService.deleteStoryRecordingAudio(e).subscribe(r=>{}),this.recordingService.deleteStoryRecording(e).subscribe(r=>{}),this.storyService.deleteStory(e).subscribe(r=>{this.ngOnInit()});else this.deleteMode=!this.deleteMode||0!==this.toBeDeleted.length}toggleEditMode(){this.editMode=!this.editMode}toggleDelete(e){if(this.toBeDeleted.includes(e)){var r=this.toBeDeleted.indexOf(e);this.toBeDeleted.splice(r,1)}else this.toBeDeleted.push(e)}goToMessages(){this.router.navigateByUrl("/messages/"+this.userId)}goToStats(){this.router.navigateByUrl("/stats-dashboard/"+this.userId)}createNewStory(){var e=this;this.dialogRef=this.dialog.open(j.p,{data:{title:this.ts.l.story_details,type:"select",data:[this.ts.l.enter_title,[this.ts.l.connacht,this.ts.l.munster,this.ts.l.ulster],[this.ts.l.title,this.ts.l.dialect]],confirmText:this.ts.l.save_details,cancelText:this.ts.l.cancel},width:"50vh"}),this.dialogRef.afterClosed().subscribe(function(){var r=(0,u.Z)(function*(c){if(e.dialogRef=void 0,c)if(c[0]){let _="connemara";c[1]==e.ts.l.munster&&(_="kerry"),c[1]==e.ts.l.ulster&&(_="donegal"),e.storyService.saveStory(e.auth.getUserDetails()._id,c[0],new Date,_,"",e.auth.getUserDetails().username,!1)}else alert(e.ts.l.title_required)});return function(c){return r.apply(this,arguments)}}())}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(T.N),t.Y36(y.$),t.Y36(x.M),t.Y36(v.D),t.Y36(o.F0),t.Y36(w.e),t.Y36(p.H),t.Y36(S.u),t.Y36(k.g),t.Y36(O.s),t.Y36(H.uw))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-book-contents"]],features:[t._Bn([A])],decls:27,vars:17,consts:[[1,"bookContainer"],[1,"contentsContainer"],[1,"bookContentsTitle"],[1,"contentsTitleContainer"],[1,"contentsLinkTitle"],[1,"contentsDateTitle"],["role","main"],[1,"form-group"],["type","text","id","search-text","aria-describedby","search-text",1,"form-control",3,"ngModel","placeholder","ngModelChange"],[1,"contentsLinkContainer"],["class","newStoryMessage",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"contentsBtnsContainer"],[1,"btn","deleteBtn",3,"click"],["src","assets/img/trash.ico",1,"trashImg"],["class","btn messagesBtn",3,"click",4,"ngIf"],["data-cy","create-story",1,"btn","newStoryBtn",3,"click"],[1,"newStoryMessage"],[1,"contentSection"],[1,"contentsLink"],["type","checkbox","class","deleteCheckbox",3,"click",4,"ngIf"],["appHighlight","",3,"searchedWord","content","classToApply","setTitle","routerLink"],["class","contentsDate",4,"ngIf"],["type","checkbox",1,"deleteCheckbox",3,"click"],[1,"contentsDate"],[1,"btn","messagesBtn",3,"click"],["class","notificationBtn",4,"ngIf"],[1,"notificationBtn"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3),t.qZA(),t.TgZ(4,"div",3)(5,"div",4),t._uU(6),t.qZA(),t.TgZ(7,"div",5),t._uU(8),t.qZA()(),t.TgZ(9,"div",6)(10,"div")(11,"div",7)(12,"input",8),t.NdJ("ngModelChange",function(_){return r.searchText=_}),t.qZA()()()(),t.TgZ(13,"div",9)(14,"div"),t._uU(15),t.qZA(),t.YNc(16,q,2,0,"div",10),t.YNc(17,N,2,1,"div",10),t.YNc(18,ut,9,11,"div",11),t.ALo(19,"appFilter"),t.qZA(),t.TgZ(20,"div",12)(21,"button",13),t.NdJ("click",function(){return r.toggleDeleteMode()}),t._UZ(22,"img",14),t.qZA(),t.YNc(23,_t,3,2,"button",15),t.YNc(24,Tt,2,1,"button",15),t.TgZ(25,"button",16),t.NdJ("click",function(){return r.createNewStory()}),t._uU(26),t.qZA()()()()),2&e&&(t.xp6(3),t.Oqu(r.ts.l.my_stories),t.xp6(3),t.Oqu(r.ts.l.title),t.xp6(2),t.Oqu(r.ts.l.last_updated),t.xp6(4),t.s9C("placeholder",r.ts.l.search_story_title_or_content),t.Q6J("ngModel",r.searchText),t.xp6(3),t.hij(" ",r.ts.l.loading," "),t.xp6(1),t.Q6J("ngIf",!r.storiesLoaded),t.xp6(1),t.Q6J("ngIf",0===r.stories.length&&r.storiesLoaded),t.xp6(1),t.Q6J("ngForOf",t.xi3(19,14,r.stories,r.searchText)),t.xp6(3),t.ekj("deleteModeBtn",r.deleteMode),t.xp6(2),t.Q6J("ngIf",r.isEnrolled),t.xp6(1),t.Q6J("ngIf",r.stories.length>0),t.xp6(2),t.hij("",r.ts.l.new_story," "))},dependencies:[s.sg,s.O5,o.rH,L.Fj,L.JJ,L.On,s.uU,A],styles:[".bookContainer[_ngcontent-%COMP%]{height:auto;width:80%;background:url(https://www.abair.ie/scealai/assets/img/paperBg.jpg) no-repeat center fixed;margin-left:10%;box-shadow:0 0 11px 2px #0006;border-radius:5px;border:solid 2px rgba(130,118,98,.7215686275)}.contentsContainer[_ngcontent-%COMP%]{padding:20px}.bookContentsTitle[_ngcontent-%COMP%]{color:var(--dark-text);padding-left:5%;padding-right:5%;display:inline-block;font-size:18pt}.contentsLinkContainer[_ngcontent-%COMP%]{height:500px;overflow:auto;padding:10px;background-color:#f7f2e7;box-shadow:inset 0 0 12px #00000080;border-radius:5px}.contentsLink[_ngcontent-%COMP%]{color:var(--dark-text);text-align:left;width:50%;text-decoration:none}.contentsLink[_ngcontent-%COMP%]:hover{text-decoration:underline;cursor:pointer}.contentsDate[_ngcontent-%COMP%]{color:var(--dark-text)}.contentsBtnsContainer[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:space-between;flex-wrap:wrap;gap:1rem}.deleteBtn[_ngcontent-%COMP%]{background-color:var(--scealai-yellow);border-style:none;color:#fff;margin:0 4px 0 0;padding:2px 7px 7px;height:38px;border-radius:5px}.deleteBtn[_ngcontent-%COMP%]:hover{background-color:var(--scealai-yellow-hover)}.deleteModeBtn[_ngcontent-%COMP%]{background-color:var(--delete-red)}.deleteModeBtn[_ngcontent-%COMP%]:hover{background-color:var(--delete-red-hover)}.trashImg[_ngcontent-%COMP%]{width:24px}.messagesBtn[_ngcontent-%COMP%]{background-color:var(--scealai-yellow);border-style:none;color:#fff;font-size:12pt;border-radius:5px;display:flex}.messagesBtn[_ngcontent-%COMP%]:hover{background-color:var(--scealai-yellow-hover);color:#fff}.newStoryBtn[_ngcontent-%COMP%]{background-color:var(--scealai-yellow);border-style:none;color:#fff;font-size:12pt;margin:0;border-radius:5px}.newStoryBtn[_ngcontent-%COMP%]:hover{background-color:var(--scealai-yellow-hover);color:#fff}@media only screen and (max-width: 700px){.contentsContainer[_ngcontent-%COMP%]{width:90%;margin-left:5%}.contentsLinkContainer[_ngcontent-%COMP%]{height:270px;padding-top:10px}.contentsLinkTitle[_ngcontent-%COMP%], .contentsDateTitle[_ngcontent-%COMP%]{font-size:12pt}.optionsPopupBtn[_ngcontent-%COMP%]{padding:2px 5px 5px;margin:0 4px 0 0;height:30px;font-size:12pt}.deleteBtn[_ngcontent-%COMP%]{background-color:var(--scealai-yellow);border-style:none;color:#fff;margin:0 4px 0 0;float:left;padding:0 3px 3px;height:30px;border-radius:5px}.deleteBtn[_ngcontent-%COMP%]:hover{background-color:var(--scealai-yellow-hover)}.deleteModeBtn[_ngcontent-%COMP%]{background-color:var(--delete-red)}.deleteModeBtn[_ngcontent-%COMP%]:hover{background-color:var(--delete-red-hover)}.trashImg[_ngcontent-%COMP%]{width:20px}}.newStoryMessage[_ngcontent-%COMP%]{color:#a79d88;width:80%;margin-left:10%;margin-top:30px}@media only screen and (min-width: 700px){.optionsPopup[_ngcontent-%COMP%]{margin-left:55px}}@media only screen and (min-width: 1400px) and (min-height: 800px){.optionsPopup[_ngcontent-%COMP%]{margin-left:55px}}"]}),i})();var dt=n(7579),Ct=n(1884),wt=n(9971),ot=n.n(wt),rt=n(9742),St=n(6618);let At=(()=>{class i{constructor(){}convertHtmlTextToArrayOfSentences(e){return this.sentences(this.convertHtmlToPlainText(e))}sentences(e){return this.naiveSentences(e)}splitWithReplacement(e,r){const c=e.split(r);return c.slice(0,-1).filter(Boolean).map(_=>_+r).concat(c.slice(-1).filter(Boolean))}extraShortening(e){return e.flatMap(r=>" "==r?[]:r.charAt(100)?this.splitWithReplacement(r,","):[r])}naiveSentences(e){let r=e.split("\n").filter(Boolean);for(const c of[".","!","?"])r=r.flatMap(_=>this.splitWithReplacement(_,c));return this.extraShortening(r)}convertHtmlToPlainText(e){const r=document.createElement("div");return r.innerHTML=e,r.textContent||r.innerText||""}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var ht=n(9549),gt=n(4385),kt=n(3238);function It(i,g){if(1&i&&(t.TgZ(0,"mat-option",3),t._uU(1),t.qZA()),2&i){const e=g.$implicit,r=t.oxw();t.s9C("gender",e.gender),t.Q6J("value",e),t.xp6(1),t.hij(" ",e.note+e.name+" ("+r.ts.message(e.dialect)+") "," ")}}let Ot=(()=>{class i{constructor(e){this.ts=e,this.voices=rt.be,this.selected=this.voices[0],this.selectVoice=new t.vpe}ngOnInit(){this.selectVoice.emit(this.selected)}color(e){return e.startsWith("f")?"rgba(255, 191, 194)":"rgba(194, 218, 255)"}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(v.D))},i.\u0275cmp=t.Xpm({type:i,selectors:[["synth-voice-select"]],outputs:{selectVoice:"selectVoice"},decls:5,vars:3,consts:[["appearance","fill"],[3,"value","valueChange","selectionChange"],["matNativeControl","","required","",3,"gender","value",4,"ngFor","ngForOf"],["matNativeControl","","required","",3,"gender","value"]],template:function(e,r){1&e&&(t.TgZ(0,"mat-form-field",0)(1,"mat-label"),t._uU(2),t.qZA(),t.TgZ(3,"mat-select",1),t.NdJ("valueChange",function(_){return r.selected=_})("selectionChange",function(_){return r.selectVoice.emit(_.value)}),t.YNc(4,It,2,3,"mat-option",2),t.qZA()()),2&e&&(t.xp6(2),t.Oqu(r.ts.message("voice")),t.xp6(1),t.Q6J("value",r.selected),t.xp6(1),t.Q6J("ngForOf",r.voices))},dependencies:[s.sg,ht.KE,ht.hX,gt.gD,kt.ey],encapsulation:2}),i})();const Mt=["voiceSelect"];function Et(i,g){1&i&&t._UZ(0,"div",11)}function Zt(i,g){1&i&&t._UZ(0,"div",11)}function Ut(i,g){if(1&i&&t._UZ(0,"app-synth-item",12),2&i){const e=g.$implicit,r=g.index,c=t.oxw();t.Q6J("synthItem",e)("i",r)("storyId",c.storyId)}}let P=(()=>{class i{constructor(e,r,c,_,I){this.router=e,this.textProcessor=r,this.cdref=c,this.synth=_,this.ts=I,this.hideEntireSynthesisPlayer=!0,this.synthItems=[],this.allAudioSources=[]}ngOnInit(){this.refresh()}refresh(e){e&&(this.selected=e),this.synthItems.map(r=>{r.audioUrl=void 0,r.dispose()}),this.text&&setTimeout(()=>{this.synthItems=this.textProcessor.sentences(this.text).map(r=>this.getSynthItem(r)),this.cdref.detectChanges(),this.audio=null},50)}getSynthItem(e){return new St.e(e,this.selected,this.synth)}audioLoaded(){return this.synthItems.every(e=>null!=e.audioUrl||e.exceptions.length>0)}combineAndPlayAudio(){var e=this;return(0,u.Z)(function*(){e.audio||(yield e.combineAudioSources()),e.playAllAudio()})()}combineAudioSources(){var e=this;return(0,u.Z)(function*(){e.allAudioSources=e.synthItems.map(c=>c.audioUrl);let r=e.allAudioSources.map(c=>fetch(c).then(_=>_.blob()));yield Promise.all(r).then(c=>{let _=new Blob(c);e.blobUrl=URL.createObjectURL(_),e.audio=new Audio(e.blobUrl)})})()}playAllAudio(){this.audio.paused?this.audio.play():(this.audio.pause(),this.audio.currentTime=0)}downloadAudio(){var e=this;return(0,u.Z)(function*(){e.audio||(yield e.combineAudioSources());const r=document.createElement("a");r.style.display="none",r.href=e.blobUrl,r.download=e.storyTitle+".mp3",document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(e.blobUrl)})()}goToFastSynthesiser(){this.router.navigateByUrl("/student/synthesis/"+this.storyId)}stopSynthesis(){this.synthItems.map(e=>{e.audioUrl=void 0,e.dispose()})}toggleHidden(){this.hideEntireSynthesisPlayer=!this.hideEntireSynthesisPlayer,this.refresh()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(o.F0),t.Y36(At),t.Y36(t.sBO),t.Y36(rt.cf),t.Y36(v.D))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-synthesis-player"]],viewQuery:function(e,r){if(1&e&&t.Gf(Mt,5),2&e){let c;t.iGM(c=t.CRH())&&(r.voiceSelect=c.first)}},inputs:{storyId:"storyId",text:"text",storyTitle:"storyTitle"},decls:22,vars:11,consts:[[1,"synth",3,"hidden"],[1,"synthHeader"],[1,"reload",3,"click"],[3,"selectVoice"],[1,"fast-synth",3,"click"],[1,"btnContainer",2,"justify-content","space-between"],[1,"playAllButton",2,"text-align","center","width","100px",3,"disabled","click"],["class","spinner-grow","style","width: 1rem; height: 1rem;",4,"ngIf"],[1,"playAllButton",2,"text-align","center","width","150px",3,"disabled","click"],[1,"items"],[3,"synthItem","i","storyId",4,"ngFor","ngForOf"],[1,"spinner-grow",2,"width","1rem","height","1rem"],[3,"synthItem","i","storyId"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0)(1,"div")(2,"h1"),t._uU(3),t.qZA(),t.TgZ(4,"p"),t._uU(5),t.qZA()(),t.TgZ(6,"div",1)(7,"div",2),t.NdJ("click",function(){return r.refresh()}),t._uU(8,"\u21bb"),t.qZA(),t.TgZ(9,"synth-voice-select",3),t.NdJ("selectVoice",function(_){return r.refresh(_)}),t.qZA(),t.TgZ(10,"div",4),t.NdJ("click",function(){return r.goToFastSynthesiser()}),t._uU(11),t.qZA()(),t.TgZ(12,"div",5)(13,"button",6),t.NdJ("click",function(){return r.combineAndPlayAudio()}),t.YNc(14,Et,1,0,"div",7),t._uU(15),t.qZA(),t.TgZ(16,"button",8),t.NdJ("click",function(){return r.downloadAudio()}),t.YNc(17,Zt,1,0,"div",7),t._uU(18),t.qZA()(),t._UZ(19,"hr"),t.TgZ(20,"div",9),t.YNc(21,Ut,1,3,"app-synth-item",10),t.qZA()()),2&e&&(t.Q6J("hidden",r.hideEntireSynthesisPlayer),t.xp6(3),t.Oqu(r.ts.l.listen_back_to_your_story?r.ts.l.listen_back_to_your_story:"listen_back_to_your_story"),t.xp6(2),t.hij("(",r.ts.l.dnn_synthesiser?r.ts.l.dnn_synthesiser:"dnn_synthesiser",")"),t.xp6(6),t.hij(" ",r.ts.l.go_to_fast_synthesiser?r.ts.l.go_to_fast_synthesiser:"go_to_fast_synthesiser"," "),t.xp6(2),t.Q6J("disabled",!r.audioLoaded()),t.xp6(1),t.Q6J("ngIf",!r.audioLoaded()),t.xp6(1),t.hij(" ",r.ts.l.play," "),t.xp6(1),t.Q6J("disabled",!r.audioLoaded()),t.xp6(1),t.Q6J("ngIf",!r.audioLoaded()),t.xp6(1),t.hij(" ",r.ts.l.download," "),t.xp6(3),t.Q6J("ngForOf",r.synthItems))},dependencies:[s.sg,s.O5,Ot],styles:[".synth[_ngcontent-%COMP%]{display:grid;padding:20px;border-radius:15px;margin:30px;background-color:#ffffff80;border:2px}.synthHeader[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.synth[_ngcontent-%COMP%]   .reload[_ngcontent-%COMP%]{font-family:Lucida Sans Unicode;font-size:20px;width:2rem;height:2rem;border-radius:.5em;padding:0;margin:0;color:gray;cursor:pointer}.synth[_ngcontent-%COMP%]   .reload[_ngcontent-%COMP%]:hover{color:#000;font-weight:700}.synth[_ngcontent-%COMP%]   .fast-synth[_ngcontent-%COMP%]{padding:3px;color:gray;cursor:pointer}.synth[_ngcontent-%COMP%]   .fast-synth[_ngcontent-%COMP%]:hover{color:#000;border-radius:2px;font-weight:700}.items[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:3px;padding-left:1rem;padding-top:1rem;border-radius:3px;text-align:left;flex-wrap:wrap;justify-content:left}.playAllButton[_ngcontent-%COMP%]{padding:5px;border-radius:5px;border:none;width:100px;text-align:center;background-color:#95cdcd}.playAllButton[_ngcontent-%COMP%]:hover:enabled{color:#fff}"]}),i})();var st=n(1094),U=n.n(st),Y=n(4186),tt=n(5592);function J(i){return Object.assign({},i)}class ct{constructor(g,e,r){this.errorsWithSentences=[],this.http=e,this.auth=r,this.grammarCheckers=g,this.cacheMap=new Map;for(const c of g)this.cacheMap.set(c.name,{})}check$(g){const e=new dt.x;return this.check(g,e),e}check(g,e){var r=this;return(0,u.Z)(function*(){const _=function W(i,g){const e=[];let r=0;for(let c of i)if(c){const I=r+g.slice(r).indexOf(c);e.push({sentence:c,offset:I}),r=I+c.length}return e}(yield(0,B.z)(r.http.post(Y.Z.baseurl+"nlp/sentenceTokenize",{text:g})),g);r.errorsWithSentences=[];const I=(yield Promise.all(r.grammarCheckers.map(function(){var M=(0,u.Z)(function*(Z){return yield Promise.all(_.map(function(){var F=(0,u.Z)(function*(Q,G){const R=Q.sentence,vt=Q.offset;function Rt(et){return et.fromX+=vt,et.toX+=vt,e.next(et),et}if(R in r.cacheMap.get(Z.name)){let et=r.cacheMap.get(Z.name)[R].map(J).map(Rt);return r.errorsWithSentences[G]=r.errorsWithSentences[G]?[r.errorsWithSentences[G][0].concat(et),R,G]:[et,R,G],et}const xt=yield Z.check(R,r.auth.getToken());r.cacheMap.get(Z.name)[R]=xt;const an=xt.map(J).map(Rt);return r.errorsWithSentences[G]=r.errorsWithSentences[G]?[r.errorsWithSentences[G][0].concat(xt),R,G]:[xt,R,G],an});return function(Q,G){return F.apply(this,arguments)}}()))});return function(Z){return M.apply(this,arguments)}}()))).flat().filter(M=>M.length);return e.complete(),r.countNewErrors(I.flat()),I})()}countNewErrors(g){var e=this;return(0,u.Z)(function*(){e.previousErrorTags=g,e.countNewErrors=e._countNewErrorsAfterFirstTime})()}_countNewErrorsAfterFirstTime(g){return(0,u.Z)(function*(){const r=function Pt(i,g){return function I(M,Z){return Z.filter(F=>!M.includes(F)||(M[M.indexOf(F)]=null,!1)).map(F=>JSON.parse(F)[1])}(_(i),_(g));function _(M){return M.map(Z=>JSON.stringify([Z.errorText,Z.type]))}}(e.previousErrorTags,g),_={countsByType:(i=r,i.reduce(function e(r,c){return r[c]||(r[c]=0),r[c]+=1,r},{}))};var i;e.http.post(Y.Z.baseurl+"gramadoir/userGrammarCounts/",_).subscribe(),e.previousErrorTags=g})()}saveErrorsWithSentences(g){var e=this;return(0,u.Z)(function*(){if(!e.errorsWithSentences)return;const r={Authorization:"Bearer "+e.auth.getToken()};e.http.post(Y.Z.baseurl+"gramadoir/insert/",{storyId:g,sentences:e.errorsWithSentences},{headers:r}).subscribe()})()}}const $=ot().import("parchment"),jt=ot().import("ui/tooltip");ot().register(new $.Attributor.Attribute("highlight-tag","highlight-tag",{scope:$.Scope.INLINE})),ot().register(new $.Attributor.Attribute("highlight-tag-type","highlight-tag-type",{scope:$.Scope.INLINE}));class ft{constructor(g,e,r){this.mostRecentHoveredMessage="",this.quillEditor=g,this.ts=e,this.engagement=r}show(g){g&&(g.forEach(r=>{this.quillEditor.formatText(r.fromX,r.toX-r.fromX,{"highlight-tag":JSON.stringify(r),"highlight-tag-type":r.type,"background-color":r.color},"api")}),document.querySelectorAll("[highlight-tag]").forEach(r=>{const c=r.getAttribute("highlight-tag");if(!c)return;const _=JSON.parse(c),I=new jt(this.quillEditor);I.root.classList.add("custom-tooltip"),r.addEventListener("mouseover",()=>{this.mouseOverTagElem(_,r,I)}),r.addEventListener("mouseout",()=>{r.removeAttribute("data-selected"),I.hide()})}))}hide(g){g.forEach(e=>{this.quillEditor.formatText(e.fromX,e.toX-e.fromX,{"highlight-tag":null,"highlight-tag-type":null,"background-color":"","data-selected":null})}),document.querySelectorAll(".custom-tooltip").forEach(e=>e.remove())}hideAll(){document.querySelectorAll("[data-selected]").forEach(e=>e.removeAttribute("data-selected")),this.quillEditor.formatText(0,this.quillEditor.getLength(),{"highlight-tag":null,"highlight-tag-type":null,"background-color":"","data-selected":null}),document.querySelectorAll(".custom-tooltip").forEach(e=>e.remove())}mouseOverTagElem(g,e,r){e.setAttribute("data-selected","");const c=this.quillEditor.root.scrollTop;this.quillEditor.root.scroll({top:+c+1}),this.quillEditor.root.scroll({top:+c}),r.root.innerHTML="en"==this.ts.l.iso_code?g.messageEN:g.messageGA,this.mostRecentHoveredMessage="en"==this.ts.l.iso_code?g.messageEN:g.messageGA,r.show(),r.position(this.quillEditor.getBounds(g.fromX,g.toX-g.fromX));let _=r.root.getAttribute("style")||"";_+="font-size: medium; z-index: 10000001;",r.root.setAttribute("style",_);const I=r.root.offsetLeft+r.root.offsetWidth-this.quillEditor.root.offsetWidth;r.root.style.left=I>0?r.root.offsetLeft-I-5+"px":r.root.style.left,r.root.style.left=r.root.offsetLeft<0?r.root.offsetLeft-r.root.offsetLeft+5+"px":r.root.style.left,this.engagement.mouseOverGrammarSuggestionEvent(g)}getGrammarMessage(g){return g?this.mostRecentHoveredMessage?this.mostRecentHoveredMessage:this.ts.message("hover_over_a_highlighted_word_for_a_grammar_suggestion"):this.ts.message("checking_grammar")}}var D=n(8043);const mt={name:"Leathan_Caol",check:function X(i){return Bt.apply(this,arguments)}},it=["a","o","u","\xe1","\xf3","\xfa","A","O","U","\xc1","\xd3","\xda"],lt=["e","i","\xe9","\xed","E","I","\xc9","\xcd"],yt=["b","c","d","f","g","h","l","m","n","p","r","s","t","v","z","B","C","D","F","G","H","L","M","N","P","R","S","T","V","Z"],V=["aniar","an\xedos","ar\xe9ir","ar\xeds","ar\xedst","anseo","ansin","ansi\xfad","c\xe9n","den","faoina","ina","inar","insa","lena","lenar"];function Bt(){return(Bt=(0,u.Z)(function*(i){return new Promise((g,e)=>{const r=qt(i);let c=[];for(const _ of r)c.push({errorText:i,messageGA:D.U["LEATHAN-CAOL"].messageGA,messageEN:D.U["LEATHAN-CAOL"].messageEN,context:i,nameEN:D.U["LEATHAN-CAOL"].nameEN,nameGA:D.U["LEATHAN-CAOL"].nameGA,color:D.U["LEATHAN-CAOL"].color,fromX:_.first,toX:_.first+1,type:"LEATHAN-CAOL"}),c.push({errorText:i,messageGA:D.U["LEATHAN-CAOL"].messageGA,messageEN:D.U["LEATHAN-CAOL"].messageEN,context:i,nameEN:D.U["LEATHAN-CAOL"].nameEN,nameGA:D.U["LEATHAN-CAOL"].nameGA,color:D.U["LEATHAN-CAOL"].color,fromX:_.second,toX:_.second+1,type:"LEATHAN-CAOL"});g(c)})})).apply(this,arguments)}function qt(i){const g=function Qt(i){let g=[];for(let e of V){let c=zt(i.toLowerCase(),e);for(let _ of c)g[_]=e.length}return g}(i),e=[];for(let r=0;r<i.length-1;r++)if(g[r]>0&&(r+=g[r]),Ht(i[r])&&Jt(i[r+1])){let c=r++;for(;Jt(i[r]);)r++;if(Ht(i[r])&&!Vt(i[c],i[r])){const _=Wt(i[c]);e.push({broadFirst:_,first:c,second:r})}}return e}function zt(i,g){var e=[];let r=new RegExp("[\\s.!?\\-]"+g+"[\\s.!?\\-]","g"),c=r.exec(i);for(;c;){r=new RegExp(g);let _=r.exec(c[0]);e.push(c.index+_.index),i=Kt(i,c.index,"#".repeat(5)),r=new RegExp("[\\s.!?\\-]"+g+"[\\s.!?\\-]","g"),c=r.exec(i)}return e}function Kt(i,g,e){return i.substr(0,g)+e+i.substr(g+e.length)}function Ht(i){return it.includes(i)||lt.includes(i)}function Wt(i){return it.includes(i)}function Jt(i){return yt.includes(i)}function Vt(i,g){return it.includes(i)&&it.includes(g)||lt.includes(i)&&lt.includes(g)}const $t={name:"AnGramadoir",check:function Xt(i,g){return Lt.apply(this,arguments)}};function Lt(){return Lt=(0,u.Z)(function*(i,g){return new Promise(function(){var e=(0,u.Z)(function*(r,c){let _=[];try{_=yield Gt(`${Y.Z.baseurl}gramadoir/callAnGramadoir/${encodeURIComponent(i)}`,g)}catch{try{_=yield Gt(`https://cadhan.com/api/gramadoir/1.0/en/${i}`)}catch{c()}}r(_.map(M=>{const Z=te(M.ruleId),F=D.U[Z];return{errorText:M.errortext,messageGA:F.messageGA.replace("#",M.errortext),messageEN:F.messageEN.replace("#",M.errortext),context:M.context,nameEN:F.nameEN,nameGA:F.nameGA,color:F.color,fromX:+M.fromx,toX:+M.tox+1,type:Z}}))});return function(r,c){return e.apply(this,arguments)}}())}),Lt.apply(this,arguments)}function Gt(i,g){return Nt.apply(this,arguments)}function Nt(){return(Nt=(0,u.Z)(function*(i,g){let e={};g&&(e={Authorization:"Bearer "+g});const r=yield fetch(i,{headers:e,method:"POST"});if(r.ok)return yield r.json();throw new Error(r.statusText)})).apply(this,arguments)}function te(i){if(!i)return"";const g=i.replace(/[A-Za-z:]+\//,"");if(!g)return"";const e=/[A-Z]+/.exec(g);return e&&e[0]?e[0]:""}const ee={name:"RelativeClause",check:function oe(i){return Dt.apply(this,arguments)}},ne="https://phoneticsrv3.lcs.tcd.ie/gramsrv/api/grammar";function Dt(){return Dt=(0,u.Z)(function*(i){return new Promise(function(){var g=(0,u.Z)(function*(e,r){e((yield re(i)).map(I=>({errorText:i.slice(I.fromx,I.tox),messageGA:I.msg,messageEN:I.msg,context:I.context,nameEN:D.U["RELATIVE-CLAUSE"].nameEN,nameGA:D.U["RELATIVE-CLAUSE"].nameGA,color:D.U["RELATIVE-CLAUSE"].color,fromX:I.fromx,toX:I.tox,type:"RELATIVE-CLAUSE"})))});return function(e,r){return g.apply(this,arguments)}}())}),Dt.apply(this,arguments)}function re(i){return Ft.apply(this,arguments)}function Ft(){return(Ft=(0,u.Z)(function*(i){const g=yield fetch(ne,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:ie(i.replace(/\n/g," "))});return g.ok?yield g.json():[]})).apply(this,arguments)}function ie(i){return`text=${encodeURIComponent(i)}&check=relclause`}var se=n(5439),ae=n.n(se),ce=n(529),le=n(1481),Yt=n(5802);const de=["mySynthesisPlayer"];function ue(i,g){if(1&i&&(t.TgZ(0,"div",27),t._uU(1),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.errorText," ")}}function pe(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div",23)(1,"div",24),t._uU(2),t.TgZ(3,"b"),t._uU(4),t.qZA(),t._uU(5,"? "),t.qZA(),t.YNc(6,ue,2,1,"div",25),t.TgZ(7,"div")(8,"button",26),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.hideModal())}),t._uU(9),t.qZA(),t.TgZ(10,"button",26),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.saveModal())}),t._uU(11),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(2),t.hij(" ",e.ts.l.save_changes_made_to," "),t.xp6(2),t.Oqu(null==e.story?null:e.story.title),t.xp6(2),t.Q6J("ngIf",e.registrationError),t.xp6(3),t.hij(" ",e.ts.l.cancel," "),t.xp6(2),t.hij(" ",e.ts.l.save," ")}}function he(i,g){1&i&&(t.TgZ(0,"span"),t._uU(1,"*"),t.qZA())}function ge(i,g){if(1&i&&(t.TgZ(0,"span",28),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Oqu(e.ts.l.made_using_prompts)}}function fe(i,g){if(1&i&&(t.TgZ(0,"div",29),t._uU(1),t._UZ(2,"i",30),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.ts.l.saved," ")}}function me(i,g){if(1&i&&(t.TgZ(0,"div",29),t._uU(1),t._UZ(2,"i",31),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.ts.l.saving," ")}}function ye(i,g){1&i&&t._UZ(0,"i",32)}function ve(i,g){1&i&&t._UZ(0,"i",33)}function xe(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div",34),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return c.dontToggle=!0,t.KtG(c.editStoryTitle())}),t._uU(1),t._UZ(2,"i",35),t.qZA()}if(2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.ts.l.edit_title_or_dialect," ")}}function be(i,g){1&i&&(t.TgZ(0,"span",39),t._uU(1,"speech_to_text"),t.qZA())}function _e(i,g){1&i&&(t.TgZ(0,"button",40),t._UZ(1,"i",41),t.qZA())}function Te(i,g){1&i&&(t.TgZ(0,"div"),t._UZ(1,"div",42),t.qZA())}const Ce=function(i){return{disableDiv:i}};function we(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div",36),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return c.dontToggle=!0,t.KtG(c.speakStory())}),t._uU(1),t.YNc(2,be,2,0,"span",37),t.YNc(3,_e,2,0,"button",38),t.YNc(4,Te,2,0,"div",6),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("ngClass",t.VKq(5,Ce,e.isTranscribing)),t.xp6(1),t.hij(" ",e.ts.l.speak," "),t.xp6(1),t.Q6J("ngIf",!e.isRecording),t.xp6(1),t.Q6J("ngIf",e.isRecording&&!e.isTranscribing),t.xp6(1),t.Q6J("ngIf",e.isTranscribing)}}function Se(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div",43),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.dontToggle=!0)}),t.TgZ(1,"button",44),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.downloadStory())}),t._uU(2),t._UZ(3,"i",45),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.s9C("href",e.downloadStoryUrl()),t.xp6(1),t.hij(" ",e.ts.l.download," ")}}function Ae(i,g){1&i&&(t.TgZ(0,"span",48),t._uU(1,"1"),t.qZA())}function ke(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div",34),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return c.dontToggle=!0,t.KtG(c.getFeedback())}),t._uU(1),t._UZ(2,"i",46),t.YNc(3,Ae,2,0,"span",47),t.qZA()}if(2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.ts.l.feedback," "),t.xp6(2),t.Q6J("ngIf",e.hasNewFeedback())}}function Ie(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div",34),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return c.dontToggle=!0,t.KtG(c.dictionaryVisible=!c.dictionaryVisible)}),t._uU(1),t._UZ(2,"i",49),t.qZA()}if(2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.ts.l.dictionary," ")}}function Oe(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div",34),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return c.dontToggle=!0,t.KtG(c.goToSynthesis())}),t._uU(1),t._UZ(2,"i",50),t.qZA()}if(2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.ts.l.audio_check," ")}}function Me(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div",34),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return c.dontToggle=!0,t.KtG(c.toggleGrammarTags())}),t._uU(1),t._UZ(2,"i",51),t.qZA()}if(2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.toggleGrammarButton()," ")}}function Ee(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div",52),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return c.dontToggle=!0,t.KtG(c.goToRecording())}),t._uU(1),t._UZ(2,"i",53),t.qZA()}if(2&i){const e=t.oxw();t.Q6J("hidden",e.story.text&&0===e.story.text.length),t.xp6(1),t.hij(" ",e.ts.l.recordings," ")}}function Ze(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div",71)(1,"div"),t._uU(2),t.qZA(),t.TgZ(3,"div",72),t.NdJ("click",function(){t.CHM(e);const c=t.oxw(2);return t.KtG(c.closeFeedback())}),t._UZ(4,"i",73),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.ts.l.feedback," ")}}function Ue(i,g){if(1&i&&t._UZ(0,"audio",78,79),2&i){const e=t.oxw(3);t.Q6J("src",e.audioSource,t.LSH)}}function Pe(i,g){if(1&i&&t._UZ(0,"div",80),2&i){const e=t.oxw(3);t.Q6J("innerHTML",e.sanitizer.bypassSecurityTrustHtml(e.story.feedback.feedbackMarkup),t.oJD)}}function je(i,g){if(1&i&&(t.TgZ(0,"div",74)(1,"textarea",75),t._uU(2,"        "),t.qZA(),t.YNc(3,Ue,2,1,"audio",76),t._UZ(4,"hr"),t.YNc(5,Pe,1,1,"div",77),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.s9C("placeholder",e.ts.l.no_feedback_provided),t.s9C("value",null==e.story?null:e.story.feedback.text),t.xp6(2),t.Q6J("ngIf",e.audioSource&&e.feedbackVisible&&e.story.feedback.audioId),t.xp6(2),t.Q6J("ngIf",e.story.feedback.feedbackMarkup)}}const Be=function(i){return{"background-color":i}};function Le(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div",81),t.NdJ("click",function(){const _=t.CHM(e).$implicit,I=t.oxw(2);return t.KtG(I.setCheckBox(_.key,_.value))}),t._UZ(1,"div",82),t._uU(2),t.ALo(3,"titlecase"),t.ALo(4,"titlecase"),t._uU(5),t.qZA()}if(2&i){const e=g.$implicit,r=t.oxw(2);t.uIk("id",e.key),t.xp6(1),t.Q6J("ngStyle",t.VKq(8,Be,e.value[0].color)),t.xp6(1),t.hij(" ","en"==r.ts.l.iso_code?t.lcZ(3,4,e.value[0].nameEN):t.lcZ(4,6,e.value[0].nameGA)," "),t.xp6(3),t.hij(" (","Broad/Slender"==e.value[0].nameEN?e.value.length/2:e.value.length,") ")}}function Ne(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div",54)(1,"div",55),t.YNc(2,Ze,5,1,"div",56),t.YNc(3,je,6,4,"div",57),t.TgZ(4,"div",58,59)(6,"quill-editor",60),t.NdJ("ngModelChange",function(c){t.CHM(e);const _=t.oxw();return t.KtG(_.story.htmlText=c)})("onContentChanged",function(c){t.CHM(e);const _=t.oxw();return t.KtG(_.onContentChanged(c))})("onEditorCreated",function(c){t.CHM(e);const _=t.oxw();return t.KtG(_.onEditorCreated(c))}),t.qZA()()(),t.TgZ(7,"div",61)(8,"span"),t._uU(9),t.qZA()(),t.TgZ(10,"div",62),t._UZ(11,"div",63),t.TgZ(12,"div",64)(13,"i",65),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.grammarSettingsHidden=!c.grammarSettingsHidden)}),t.qZA(),t.TgZ(14,"i",66),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return c.dontToggle=!0,t.KtG(c.toggleGrammarTags())}),t.qZA()()(),t.TgZ(15,"div",67)(16,"span",68)(17,"div",69)(18,"h5"),t._uU(19),t.qZA()()(),t.YNc(20,Le,6,10,"div",70),t.ALo(21,"keyvalue"),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.feedbackVisible),t.xp6(1),t.Q6J("ngIf",e.feedbackVisible),t.xp6(1),t.Q6J("ngStyle",e.quillEditorStyle),t.xp6(2),t.Q6J("modules",e.quillToolbar)("preserveWhitespace",!0)("debounceTime",1500)("ngModel",e.story.htmlText),t.xp6(3),t.AsE(" ",e.ts.l.word_count,": ",e.wordCount," "),t.xp6(1),t.Q6J("hidden",!e.showErrorTags),t.xp6(1),t.Q6J("innerHTML",e.selectedGrammarSuggestion(),t.oJD),t.xp6(2),t.Q6J("ngClass",e.grammarSettingsHidden?"fas fa-chevron-right":"fas fa-chevron-down"),t.xp6(2),t.Q6J("hidden",e.grammarSettingsHidden||!e.showErrorTags),t.xp6(4),t.hij(" ",e.ts.message("grammar_errors")," "),t.xp6(1),t.Q6J("ngForOf",t.lcZ(21,15,e.grammarErrorsTypeDict))}}function De(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div",90)(1,"label",91),t._uU(2),t.qZA(),t.TgZ(3,"input",92),t.NdJ("ngModelChange",function(c){t.CHM(e);const _=t.oxw(2);return t.KtG(_.wordLookedUp=c)})("keyup.enter",function(){t.CHM(e);const c=t.oxw(2);return t.KtG(c.lookupWord())})("click",function(){t.CHM(e);const c=t.oxw(2);return t.KtG(c.clearDictInput())}),t.qZA(),t.TgZ(4,"button",93),t.NdJ("click",function(){t.CHM(e);const c=t.oxw(2);return t.KtG(c.lookupWord())}),t._UZ(5,"i",94),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(2),t.hij("",e.ts.l.search,":"),t.xp6(1),t.Q6J("ngModel",e.wordLookedUp)}}function Fe(i,g){if(1&i&&t._UZ(0,"iframe",95),2&i){const e=t.oxw(2);t.Q6J("src",e.defaultDictIframeText,t.uOi)}}function He(i,g){1&i&&(t.TgZ(0,"div",96)(1,"ul")(2,"li")(3,"a",97),t._uU(4,"potafocal.com"),t.qZA()(),t.TgZ(5,"li")(6,"a",98),t._uU(7,"focloir.ie"),t.qZA()()()())}function Je(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div",83)(1,"div",69)(2,"h5"),t._uU(3),t.qZA(),t.TgZ(4,"div",84),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.dictionaryVisible=!1)}),t._UZ(5,"i",73),t.qZA()(),t.TgZ(6,"div",85)(7,"div",86),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return c.selectTeanglann=!0,c.selectExternalLinks=!1,t.KtG(c.selectedDictionary=!0)}),t._uU(8," Teanglann "),t.qZA(),t._uU(9," | "),t.TgZ(10,"div",86),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return c.selectExternalLinks=!0,t.KtG(c.selectTeanglann=!1)}),t._uU(11),t.qZA()(),t.YNc(12,De,6,2,"div",87),t.YNc(13,Fe,1,1,"iframe",88),t.YNc(14,He,8,0,"div",89),t.qZA()}if(2&i){const e=t.oxw();t.xp6(3),t.hij(" ",e.ts.l.dictionary," "),t.xp6(8),t.hij(" ",e.ts.l.external_links," "),t.xp6(1),t.Q6J("ngIf",e.selectTeanglann),t.xp6(1),t.Q6J("ngIf",e.selectTeanglann),t.xp6(1),t.Q6J("ngIf",e.selectExternalLinks)}}function Ge(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div",99),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return c.dontToggle=!0,t.KtG(c.goToSynthesis())}),t._UZ(1,"i",73),t.qZA()}}ot().register("modules/imageCompress",ae());let Ye=(()=>{class i{constructor(e,r,c,_,I,M,Z,F,Q,G,R,vt){this.http=e,this.sanitizer=r,this.storyService=c,this.route=_,this.auth=I,this.notificationService=M,this.router=Z,this.engagement=F,this.ts=Q,this.dialog=G,this.recordAudioService=R,this.classroomService=vt,this.story=new f.o,this.mostRecentAttemptToSaveStory=new Date,this.saveStoryDebounceId=0,this.storySaved=!0,this.downloadStoryFormat=".pdf",this.grammarLoaded=!1,this.grammarErrors=[],this.grammarErrorsTypeDict={},this.showErrorTags=!1,this.checkBoxes={showAll:!0},this.grammarCheckerOptions={anGramadoir:$t,relativeClause:ee,broadSlender:mt},this.showOptions=!0,this.dontToggle=!1,this.selectTeanglann=!0,this.modalClass="hidden",this.modalChoice=new dt.x,this.words=[],this.wordCount=0,this.textUpdated=new dt.x,this.quillToolbar={toolbar:[["bold","italic","underline","strike"],["blockquote"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{align:[]}],["clean"],["image"]],imageCompress:{quality:.7,maxWidth:500,maxHeight:500,imageType:"image/png",debug:!1,suppressErrorLogging:!1,insertIntoEditor:void 0}},this.wordLookedUp="",this.defaultDictIframeText=this.sanitizer.bypassSecurityTrustResourceUrl("data:text/html;charset=utf-8,"+this.ts.l.search_for_words_in_dictionary),this.isRecording=!1,this.isTranscribing=!1,this.setUpGrammarChecking()}ngOnInit(){var e=this;return(0,u.Z)(function*(){e.storySaved=!0,e.auth.getUserDetails()&&(e.story=yield(0,B.z)(e.storyService.getStory(e.route.snapshot.params.id)),e.story&&(console.log(e.story),e.textUpdated.next(),e.getWordCount(e.story.text),null==e.story.htmlText&&(e.story.htmlText=e.story.text)))})()}setUpGrammarChecking(){var e=this;return(0,u.Z)(function*(){const r=e.auth.getUserDetails();if(!r)return;let c=yield(0,B.z)(e.classroomService.getClassroomOfStudent(r._id)),_=[];c&&c.grammarCheckers&&c.grammarCheckers.length>0?c.grammarCheckers.forEach(I=>{e.grammarCheckerOptions[I]&&_.push(e.grammarCheckerOptions[I])}):_=Object.values(e.grammarCheckerOptions),e.grammarEngine=new ct(_,e.http,e.auth),e.textUpdated.pipe((0,Ct.x)()).subscribe((0,u.Z)(function*(){if(e.grammarLoaded=!1,e.story.text.replace(/\n/g," "))try{e.grammarErrors=[],e.grammarEngine.check$(e.story.text).subscribe({next:M=>{e.grammarErrors.push(M),e.showErrorTags&&e.quillHighlighter.show([M])},error:function(){},complete:()=>{if(e.quillHighlighter){e.quillHighlighter.hideAll(),e.showErrorTags&&e.quillHighlighter.show(e.grammarErrors.filter(M=>e.checkBoxes[M.type]||e.checkBoxes.showAll)),e.grammarErrors&&e.grammarEngine.saveErrorsWithSentences(e.story._id).then(console.log,console.error),e.grammarErrorsTypeDict=e.grammarErrors.reduce(function(M,Z){return M[Z.type]||(M[Z.type]=[]),M[Z.type].push(Z),M},{});for(const M of Object.keys(e.grammarErrorsTypeDict))e.checkBoxes[M]=!0;e.grammarLoaded=!0}}})}catch(M){e.grammarErrors||window.alert("There was an error while trying to fetch grammar suggestions from the Gramad\xf3ir server:\n"+M.message+"\nSee the browser console for more information"),console.dir(M)}}))})()}onContentChanged(e){"user"===(this.story.text=e.text,this.getWordCount(e.text),e.source)&&(this.storySaved=!1,this.textUpdated.next(e.text),this.debounceSaveStory())}debounceSaveStory(){this.saveStoryDebounceId++;const e=this.saveStoryDebounceId,r=new Date;setTimeout(()=>{e===this.saveStoryDebounceId&&this.saveStory(e,r)},1e3)}saveStory(e,r){var c=this;return(0,u.Z)(function*(){const _=new Date;if(c.mostRecentAttemptToSaveStory=_,!c.story._id)return window.alert("Cannot save story. The id is not known");const I=c.stripGramadoirAttributesFromHtml(U()(c.story.htmlText)),M={title:c.story.title,dialect:c.story.dialect,text:c.story.text,htmlText:I,lastUpdated:r};c.engagement.addEventForLoggedInUser(b.tw["SAVE-STORY"],c.story);try{yield(0,B.z)(c.storyService.updateStory(M,c.story._id)),(e===c.saveStoryDebounceId||"modal"===e)&&(c.storySaved=!0)}catch(Z){throw window.alert("Error while trying to save story: "+Z.message),Z}try{_===c.mostRecentAttemptToSaveStory&&(c.storySaved=!0)}catch(Z){throw window.alert("Error setting storySaved to true: "+Z.message),Z}})()}onEditorCreated(e){console.log(e),e.history.options.userOnly=!0,this.quillEditor=e,this.quillEditor.root.setAttribute("spellcheck","false"),this.quillHighlighter=new ft(this.quillEditor,this.ts,this.engagement)}titleStyle(){return{"font-style":this.storySaved?"normal":"italic"}}setCheckBox(e,r){this.checkBoxes[e]=!this.checkBoxes[e],this.checkBoxes.showAll&&(this.checkBoxes.showAll=!1),this.checkBoxes[e]?(this.quillHighlighter.show(r),document.getElementById(e).classList.remove("hideLegendItem")):(this.quillHighlighter.hide(r),document.getElementById(e).classList.add("hideLegendItem"))}setAllCheckBoxes(){this.checkBoxes.showAll?this.quillHighlighter.show(this.grammarErrors):this.quillHighlighter.hideAll(),Object.keys(this.checkBoxes).forEach(e=>{this.checkBoxes[e]=this.checkBoxes.showAll})}selectedGrammarSuggestion(){return this.quillHighlighter?this.quillHighlighter.getGrammarMessage(this.grammarLoaded):""}toggleGrammarButton(){return this.ts.message(this.showErrorTags?"hide_grammar_suggestions":"show_grammar_suggestions")}toggleGrammarTags(){var e=this;return(0,u.Z)(function*(){e.showErrorTags?e.quillHighlighter.hideAll():e.quillHighlighter.show(e.grammarErrors.filter(r=>e.checkBoxes[r.type]||e.checkBoxes.showAll)),e.showErrorTags=!e.showErrorTags})()}stripGramadoirAttributesFromHtml(e){return e&&e.replace?e.replace(/\s*style="([^"])+"/g,"").replace(/\s*highlight-tag-type="([^"])+"/g,"").replace(/\s*highlight-tag="([^"])+"/g,""):""}lookupWord(){var e=this;return(0,u.Z)(function*(){if(e.wordLookedUp){const r=e.http.post(Y.Z.baseurl+"proxy/",{url:`https://www.teanglann.ie/en/fgb/${e.wordLookedUp}`}),c=yield(0,B.z)(r),_=(new DOMParser).parseFromString(c,"text/html");_.querySelectorAll(".ex > .head > a").forEach(Q=>Q.href=`https://www.teanglann.ie${Q.href.slice(Q.href.lastIndexOf("/en/"))}`),_.querySelector(".moar")?.remove();const Z=_.querySelector(".listings");Z.style.cssText+="margin-right: 0px; padding: 10px;",document.getElementById("dictiframe").src='data:text/html;charset=utf-8,<link type="text/css" rel="stylesheet" href="https://www.teanglann.ie/furniture/template.css"><link type="text/css" rel="stylesheet" href="https://www.teanglann.ie/furniture/fgb.css">'+Z.outerHTML,e.engagement.addEventForLoggedInUser(b.tw["USE-DICTIONARY"],null,e.wordLookedUp)}else alert(e.ts.l.enter_a_word_to_lookup)})()}clearDictInput(){this.wordLookedUp&&(this.wordLookedUp="")}getFeedback(){this.feedbackVisible=!this.feedbackVisible,this.getFeedbackAudio(),""!==this.story.feedback.text&&(this.story.feedback.seenByStudent=!0),this.storyService.viewFeedback(this.story._id).subscribe(()=>{this.engagement.addEventForLoggedInUser(b.tw["VIEW-FEEDBACK"],this.story),this.notificationService.getStudentNotifications()})}getFeedbackAudio(){this.storyService.getFeedbackAudio(this.story._id).subscribe(e=>{this.audioSource=this.sanitizer.bypassSecurityTrustUrl(URL.createObjectURL(e))})}downloadStory(){this.dialogRef=this.dialog.open(j.p,{data:{title:this.ts.l.download,type:"select",data:[this.story.title,[".pdf",".docx",".txt",".odt"]],confirmText:this.ts.l.download,cancelText:this.ts.l.cancel},width:"50vh"}),this.dialogRef.afterClosed().subscribe(e=>{this.dialogRef=void 0,e&&(this.downloadStoryFormat=e[1]?e[1]:".pdf",this.http.get(this.downloadStoryUrl(),{responseType:"blob"}).subscribe(r=>{const c=window.document.createElement("a");c.href=window.URL.createObjectURL(r),c.download=e[0]?e[0]:this.story.title,document.body.appendChild(c),c.click(),document.body.removeChild(c)}))})}downloadStoryUrl(){return Y.Z.baseurl+"story/downloadStory/"+this.story._id+"/"+this.downloadStoryFormat}getWordCount(e){if(!e)return 0;const r=e.replace(/[\t\n\r\.\?\!]/gm," ").split(" ");this.words=[],r.map(c=>{const _=c.trim();_.length>0&&this.words.push(_)}),this.wordCount=this.words.length}closeFeedback(){this.feedbackVisible=!1}hasNewFeedback(){return!(!this.story||!this.story.feedback||!1!==this.story.feedback.seenByStudent)}goToSynthesis(){this.synthesisPlayer.toggleHidden()}goToRecording(){this.router.navigateByUrl("/record-story/"+this.story._id)}showModal(){this.modalClass="visibleFade"}hideModal(){this.modalClass="hiddenFade",this.modalChoice.next(!1)}saveModal(){var e=this;return(0,u.Z)(function*(){try{yield e.saveStory("modal",new Date),e.modalChoice.next(!0)}catch{window.alert("Your story was not saved. You should copy your story to another program to save it. Otherwise it may be lost."),e.hideModal()}})()}toggleOptions(){this.dontToggle||(this.showOptions=!this.showOptions),this.dontToggle=!1}editStoryTitle(){var e=this;this.dialogRef=this.dialog.open(j.p,{data:{title:this.ts.l.story_details,type:"select",data:[this.story.title,[this.ts.l.connacht,this.ts.l.munster,this.ts.l.ulster]],confirmText:this.ts.l.save_details,cancelText:this.ts.l.cancel},width:"50vh"}),this.dialogRef.afterClosed().subscribe(function(){var r=(0,u.Z)(function*(c){e.dialogRef=void 0,c&&e.storyService.updateStoryTitleAndDialect(e.story,c[0],c[1]).subscribe({complete:()=>{e.ngOnInit()}})});return function(c){return r.apply(this,arguments)}}())}speakStory(){var e=this;return(0,u.Z)(function*(){if(e.isRecording){e.isTranscribing=!0,e.recordAudioService.stopRecording();let r=yield e.recordAudioService.getAudioTranscription();if(e.isTranscribing=!1,r){let c=e.quillEditor.getSelection(!0);e.quillEditor.insertText(c.index,r+"."),e.story.text=e.quillEditor.getText(),e.story.htmlText=e.quillEditor.root.innerHTML,e.getWordCount(r),e.storySaved=!1,e.textUpdated.next(),e.debounceSaveStory()}}else e.recordAudioService.recordAudio();e.isRecording=!e.isRecording})()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(ce.eN),t.Y36(le.H7),t.Y36(T.N),t.Y36(o.gz),t.Y36(y.$),t.Y36(k.g),t.Y36(o.F0),t.Y36(x.M),t.Y36(v.D),t.Y36(H.uw),t.Y36(tt.r),t.Y36(S.u))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-dashboard"]],viewQuery:function(e,r){if(1&e&&t.Gf(de,5),2&e){let c;t.iGM(c=t.CRH())&&(r.synthesisPlayer=c.first)}},decls:31,vars:27,consts:[[1,"dashboardContainer"],["class","modalContent",4,"ngIf"],[1,"bookHeader"],["routerLink","../../contents",1,"myStoriesBtn",3,"click"],[1,"fa","fa-chevron-left","backArrow"],["data-cy","title",2,"margin-right","3em","margin-left","3em","overflow","auto","font-size","20px",3,"ngStyle"],[4,"ngIf"],["style","color: rgba(0, 0, 0, 0.4);",4,"ngIf"],[1,"saveIcon"],["class","savedIcon",4,"ngIf"],[1,"optionsBtnContainer",3,"click"],[1,"optionsBtn"],["class","fas fa-chevron-down",4,"ngIf"],["class","fas fa-chevron-right",4,"ngIf"],["class","optionsBtn optionsPopupBtn",3,"click",4,"ngIf"],["class","optionsBtn optionsPopupBtn",3,"ngClass","click",4,"ngIf"],["style","display: flex",3,"click",4,"ngIf"],["class","optionsBtn optionsPopupBtn",3,"hidden","click",4,"ngIf"],["class","storyContainer",4,"ngIf"],["class","dictionaryContainer dictionaryHeight",4,"ngIf"],["class","closeSynthesisBtn",3,"click",4,"ngIf"],[3,"text","storyId","storyTitle"],["mySynthesisPlayer",""],[1,"modalContent"],[1,"modalText"],["class","errorMessage",4,"ngIf"],[1,"modalBtn",3,"click"],[1,"errorMessage"],[2,"color","rgba(0, 0, 0, 0.4)"],[1,"savedIcon"],[1,"fas","fa-check"],[1,"fas","fa-save"],[1,"fas","fa-chevron-down"],[1,"fas","fa-chevron-right"],[1,"optionsBtn","optionsPopupBtn",3,"click"],[1,"fas","fa-pencil-alt","optionsBtnIcon"],[1,"optionsBtn","optionsPopupBtn",3,"ngClass","click"],["class","material-symbols-outlined optionsBtnIcon",4,"ngIf"],["class","notRecordingBtn blink",4,"ngIf"],[1,"material-symbols-outlined","optionsBtnIcon"],[1,"notRecordingBtn","blink"],[1,"fas","fa-stop-circle"],[1,"dot-flashing"],[2,"display","flex",3,"click"],["target","_blank",1,"optionsBtn","optionsPopupBtn",2,"text-decoration","none",3,"href","click"],[1,"fas","fa-download","optionsBtnIcon"],[1,"fas","fa-comment-dots","optionsBtnIcon"],["class","notificationBtn",4,"ngIf"],[1,"notificationBtn"],[1,"fas","fa-book","optionsBtnIcon"],[1,"fas","fa-volume-up","optionsBtnIcon"],[1,"fas","fa-spell-check","optionsBtnIcon"],[1,"optionsBtn","optionsPopupBtn",3,"hidden","click"],[1,"fas","fa-microphone","optionsBtnIcon"],[1,"storyContainer"],[1,"writingContainer"],["class","feedbackHeader",4,"ngIf"],["class","textFieldContainer",4,"ngIf"],[1,"ql-container",3,"ngStyle"],["quillHeightSpan",""],["placeholder","",3,"modules","preserveWhitespace","debounceTime","ngModel","ngModelChange","onContentChanged","onEditorCreated"],[1,"wordCountContainer"],[1,"grammarMessageBanner",3,"hidden"],[1,"grammarMessage",3,"innerHTML"],[1,"displayGrammarTagsIcon"],[3,"ngClass","click"],[1,"fa","fa-times",2,"padding-left","20px",3,"click"],[1,"selectErrorCheckbox",3,"hidden"],[1,"dictionaryContainer"],[1,"dictionaryHeader"],["class","errorContainer",3,"click",4,"ngFor","ngForOf"],[1,"feedbackHeader"],[1,"closeFeedbackBtn",3,"click"],[1,"fa","fa-times"],[1,"textFieldContainer"],["readonly","",1,"textField",3,"placeholder","value"],["id","audio","controls","","class","audioPlayer",3,"src",4,"ngIf"],["class","textField","style","text-align: left; padding-left:25%; padding-right:25%;",3,"innerHTML",4,"ngIf"],["id","audio","controls","",1,"audioPlayer",3,"src"],["audioTag",""],[1,"textField",2,"text-align","left","padding-left","25%","padding-right","25%",3,"innerHTML"],[1,"errorContainer",3,"click"],[1,"errorColorBox",3,"ngStyle"],[1,"dictionaryContainer","dictionaryHeight"],[1,"closeDictionaryBtn",3,"click"],[1,"dictionarySubHeader"],[1,"dictionaryName",3,"click"],["class","dictionaryInput",4,"ngIf"],["class","dictionaryIframe","id","dictiframe",3,"src",4,"ngIf"],["class","dictionaryIframe","style","text-align: left",4,"ngIf"],[1,"dictionaryInput"],["for","dictlookup"],["type","text","id","dictlookup","name","dictlookup","autofocus","",3,"ngModel","ngModelChange","keyup.enter","click"],[1,"searchDictionaryBtn",3,"click"],["aria-hidden","true",1,"fa","fa-search"],["id","dictiframe",1,"dictionaryIframe",3,"src"],[1,"dictionaryIframe",2,"text-align","left"],["href","http://www.potafocal.com/beo/","target","_blank"],["href","https://www.focloir.ie","target","_blank"],[1,"closeSynthesisBtn",3,"click"]],template:function(e,r){if(1&e&&(t.TgZ(0,"div",0)(1,"div"),t.YNc(2,pe,12,5,"div",1),t.qZA(),t.TgZ(3,"div",2)(4,"div",3),t.NdJ("click",function(){return r.synthesisPlayer.stopSynthesis()}),t._UZ(5,"i",4),t._uU(6),t.qZA(),t.TgZ(7,"p",5),t._uU(8),t.YNc(9,he,2,0,"span",6),t.YNc(10,ge,2,1,"span",7),t.qZA(),t.TgZ(11,"div",8),t.YNc(12,fe,3,1,"div",9),t.YNc(13,me,3,1,"div",9),t.qZA()(),t.TgZ(14,"div",10),t.NdJ("click",function(){return r.toggleOptions()}),t.TgZ(15,"div",11),t.YNc(16,ye,1,0,"i",12),t.YNc(17,ve,1,0,"i",13),t.qZA(),t.YNc(18,xe,3,1,"div",14),t.YNc(19,we,5,7,"div",15),t.YNc(20,Se,4,2,"div",16),t.YNc(21,ke,4,2,"div",14),t.YNc(22,Ie,3,1,"div",14),t.YNc(23,Oe,3,1,"div",14),t.YNc(24,Me,3,1,"div",14),t.YNc(25,Ee,3,2,"div",17),t.qZA(),t.YNc(26,Ne,22,17,"div",18),t.YNc(27,Je,15,5,"div",19),t.YNc(28,Ge,2,0,"div",20),t._UZ(29,"app-synthesis-player",21,22),t.qZA()),2&e){let c;t.xp6(1),t.Gre("",r.modalClass," modalContainer"),t.xp6(1),t.Q6J("ngIf",r.story),t.xp6(4),t.hij(" ",r.ts.l.contents," "),t.xp6(1),t.Q6J("ngStyle",r.titleStyle()),t.xp6(1),t.hij(" ",null!==(c=null==r.story?null:r.story.title)&&void 0!==c?c:"..."," "),t.xp6(1),t.Q6J("ngIf",!r.storySaved),t.xp6(1),t.Q6J("ngIf",r.story.createdWithPrompts),t.xp6(2),t.Q6J("ngIf",r.storySaved),t.xp6(1),t.Q6J("ngIf",!r.storySaved),t.xp6(3),t.Q6J("ngIf",!r.showOptions),t.xp6(1),t.Q6J("ngIf",r.showOptions),t.xp6(1),t.Q6J("ngIf",r.showOptions),t.xp6(1),t.Q6J("ngIf",r.showOptions),t.xp6(1),t.Q6J("ngIf",r.showOptions),t.xp6(1),t.Q6J("ngIf",r.showOptions),t.xp6(1),t.Q6J("ngIf",r.showOptions),t.xp6(1),t.Q6J("ngIf",r.showOptions),t.xp6(1),t.Q6J("ngIf",r.showOptions),t.xp6(1),t.Q6J("ngIf",r.showOptions),t.xp6(1),t.Q6J("ngIf",r.story),t.xp6(1),t.Q6J("ngIf",r.dictionaryVisible),t.xp6(1),t.Q6J("ngIf",!(null!=r.synthesisPlayer&&r.synthesisPlayer.hideEntireSynthesisPlayer)),t.xp6(1),t.Q6J("text",r.story.text)("storyId",r.story._id)("storyTitle",r.story.title)}},dependencies:[s.mk,s.sg,s.O5,s.PC,o.rH,L.Fj,L.JJ,L.On,Yt.g6,P,s.rS,s.Nd],styles:['@charset "UTF-8";.dashboardContainer{--bookContainerHeight: 95vh;--bookContainerWidth: 100%;--textfieldHeight: calc(var(--bookContainerHeight) / 3);--dictionaryHeight: 60vh;width:var(--bookContainerWidth);height:95vh;margin-top:-55px}.modalContainer{top:0;left:0;height:100vh;width:100%;display:flex;justify-content:center;align-items:center}.bookHeader{display:flex;flex-direction:row;justify-content:space-between;padding:15px 15px 5px}.myStoriesBtn{white-space:nowrap;border-style:none;color:var(--dark-text);font-size:11pt;padding:5px}.myStoriesBtn:hover{color:var(--scealai-orange);text-decoration:none;cursor:pointer}.notRecordingBtn{background-color:red;color:#fff;border-radius:4px;border:none;margin-left:4px;font-size:10pt;padding:4px 8px}.blink{animation:blinker 2s linear infinite}@keyframes blinker{0%{background-color:red}50%{background-color:#700}to{background-color:red}}.saveIcon{white-space:nowrap;color:var(--dark-text);border-style:none;font-size:11pt;padding:5px}.savedIcon{color:var(--scealai-light-brown)}.optionsBtnContainer>*{height:2rem}.optionsBtnContainer{display:flex;justify-content:space-between;flex-wrap:wrap;--options-btn-background-color-hover: lightgray;margin-left:2%;margin-right:2%}.optionsBtn{background-color:var(--scealai-yellow);border-style:none;color:#464444;margin:0;border-radius:2px;display:flex;align-items:center;padding:5px;background:rgba(223,217,200,0)}.optionsBtn:hover{background-color:var(--options-btn-background-color-hover);color:#35322f;cursor:pointer;border-radius:2}.optionsPopupBtn{margin-right:4px}.optionsBtnIcon{margin-left:5px}.grammarMessageBanner{background-color:#8fcaff;display:flex;align-items:center}.grammarMessage{display:block;flex:1}.grammarMessage+.displayGrammarTagsIcon{flex:0 0 auto}.displayGrammarTagsIcon{margin-right:20px}.displayGrammarTagsIcon:hover{cursor:pointer}.disableDiv{pointer-events:none;opacity:2}.storyContainer{z-index:1;--feedbackHeight: 120px;--grammarMessageHeight: 80px;--dictionaryWidth: 100%}.feedbackHeader{width:100%;padding-left:20px;padding-right:20px;height:30px;background-color:var(--scealai-green);color:#fff;display:flex;align-items:center}.closeFeedbackBtn{margin-left:auto}.closeFeedbackBtn:hover{cursor:pointer}.textFieldContainer{width:100%;resize:none;z-index:1;color:var(--dark-text);background:white;padding-left:20px;padding-right:20px;padding-top:10px}.textField{width:100%;resize:none;z-index:1;color:var(--dark-text);background:white;padding-left:20px;padding-right:20px;padding-top:10px;border:none}.audioPlayer{height:30px;width:90%;background-color:#f1f3f4;border:1px solid rgba(140,128,110,.5254901961)}.selectErrorCheckbox{flex-wrap:wrap;justify-content:space-around;text-align:left;background-color:var(--scealai-green);display:flex;color:#fff}.checkAllBox{text-align:left;padding:5px 10px 10px;font-weight:700}.errorContainer{margin:2px}.errorContainer:hover{cursor:pointer}.hideLegendItem{text-decoration:line-through;opacity:.5}.errorColorBox{display:inline-flex;width:30px;height:15px}.dictionaryContainer{border-top:solid grey 1px;width:100%;display:flex;flex-direction:column}.dictionaryHeader{padding:5px;background-color:var(--scealai-green);color:#fff;display:flex;align-items:column}.closeDictionaryBtn{margin-left:auto}.closeDictionaryBtn:hover{cursor:pointer}.closeSynthesisBtn{float:right;padding-top:10px;padding-right:30px}.closeSynthesisBtn:hover{cursor:pointer}.dictionaryHeight{height:var(--dictionaryHeight)}.dictionarySubHeader{padding:5px;background-color:var(--scealai-green);color:#fff;display:flex}.dictionaryName{background-color:var(--scealai-green);font-size:12px;color:#fff;padding-right:5px;padding-top:5px}.dictionaryName:hover{color:var(--scealai-light-green);text-decoration:none;cursor:pointer}.dictionaryInput{background-color:var(--scealai-green);color:#fff;display:flex;align-items:center;justify-content:center;padding-bottom:10px;gap:1rem}.searchDictionaryBtn{background-color:var(--scealai-yellow);border-style:none;color:#fff;font-size:12pt;margin:0;border-radius:5px}.searchDictionaryBtn:hover{background-color:var(--scealai-yellow-hover);color:#fff}.dictionaryIframe{height:var(--dictionaryHeight);width:100%;border-radius:0 0 5px 5px;background:white}.ql-container{height:auto;background-color:#f8f9fa}.ql-editor{background-color:#fff;z-index:1;padding:10px 20px;font-size:14pt;font-family:Times New Roman,Times,serif;min-height:60vh!important;max-height:60vh!important}.\\2699 {font-size:xx-large;color:#a9a9a9;cursor:pointer;align-items:center}.\\2699:hover{color:#000;background-color:#aeffc486}.wordCountContainer{display:flex;align-items:center;padding-left:8px;padding-top:0;border-bottom:1px solid #ccc}.quill-editor-dict{height:calc(var(--textfieldHeight) - 44px)}.text-input-highlight-container .text-highlight-element{background:var(--scealai-cream-2)}.bg-blue{background-color:#add8e6}.tickIcon{margin-left:5px}.refreshGrammar:hover{cursor:pointer}@media only screen and (max-width: 750px){.dictionaryModeContainer{flex-direction:column-reverse}.dictionaryContainer,.textField{width:100%}}\n',".custom-tooltip:before{content:none!important}[data-selected]{margin:.3em}[highlight-tag-type]{border-radius:3px}span[highlight-tag-type]:hover{cursor:pointer}span:not[highlight-tag-type]{border-radius:0;padding-left:0;padding-right:0}[highlight-tag-type=LEATHAN-CAOL]{border:1px solid gray;border-radius:0!important;padding-left:0!important;padding-right:0!important}\n",'.ql-editor{overflow-y:auto}.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=times-new-roman]:before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=times-new-roman]:before{content:"Times New Roman";font-family:Times New Roman}.ql-font-times-new-roman{font-family:times new roman}.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=arial]:before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=arial]:before{content:"Arial";font-family:arial}.ql-font-arial{font-family:arial}.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=sans-serif]:before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=sans-serif]:before{content:"Sans Serif";font-family:"sans serif"}.ql-font-sans-serif{font-family:"sans serif"}.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=monospace]:before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=monospace]:before{content:"Monospace";font-family:"monospace"}.ql-font-monospace{font-family:"monospace"}\n'],encapsulation:2}),i})();var Re=n(8092),qe=n(1656);function Qe(i,g){if(1&i&&(t.TgZ(0,"div",14)(1,"b"),t._uU(2),t.qZA(),t._UZ(3,"grid-spinner"),t.qZA()),2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.ts.l.synthesising)}}function ze(i,g){1&i&&(t._UZ(0,"span",18),t.ALo(1,"safeHtml")),2&i&&t.Q6J("innerHTML",t.lcZ(1,1,g.$implicit.outerHTML),t.oJD)}function Ke(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(e);const c=t.oxw().$implicit,_=t.oxw(2);return t.KtG(_.stopSection(c))}),t._UZ(1,"i",20),t.qZA()}}function We(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"button",19),t.NdJ("click",function(){t.CHM(e);const c=t.oxw().$implicit,_=t.oxw(2);return t.KtG(_.playSection(c))}),t._UZ(1,"i",21),t.qZA()}}function Ve(i,g){if(1&i&&(t.TgZ(0,"div",2),t.YNc(1,ze,2,3,"span",16),t.YNc(2,Ke,2,0,"button",17),t.YNc(3,We,2,0,"button",17),t.qZA()),2&i){const e=g.$implicit;t.xp6(1),t.Q6J("ngForOf",e.spans),t.xp6(1),t.Q6J("ngIf",!e.audio.paused),t.xp6(1),t.Q6J("ngIf",e.audio.paused)}}function $e(i,g){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,Ve,4,3,"div",15),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.chosenSections)}}function Xe(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"button",24),t._uU(2),t.qZA(),t.TgZ(3,"button",25),t.NdJ("click",function(){t.CHM(e);const c=t.oxw(2);return t.KtG(c.changeSections(c.sentences))}),t._uU(4),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(2),t.Oqu(e.ts.l.paragraph),t.xp6(2),t.Oqu(e.ts.l.sentence)}}function tn(i,g){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"button",25),t.NdJ("click",function(){t.CHM(e);const c=t.oxw(2);return t.KtG(c.changeSections(c.paragraphs))}),t._uU(2),t.qZA(),t.TgZ(3,"button",24),t._uU(4),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(2),t.Oqu(e.ts.l.paragraph),t.xp6(2),t.Oqu(e.ts.l.sentence)}}function en(i,g){if(1&i&&(t.TgZ(0,"div",22)(1,"div",23),t._uU(2),t.qZA(),t.YNc(3,Xe,5,2,"div",11),t.YNc(4,tn,5,2,"div",11),t.qZA()),2&i){const e=t.oxw();t.xp6(2),t.hij(" ",e.ts.l.listen_by," "),t.xp6(1),t.Q6J("ngIf",e.isParagraphMode()),t.xp6(1),t.Q6J("ngIf",e.isSentenceMode())}}const on=[{path:"",pathMatch:"full",redirectTo:"contents"},{path:"contents",component:pt,canActivate:[a.P]},{path:"dashboard/:id",component:Ye,canActivate:[a.P],canDeactivate:[d.d]},{path:"synthesis/:id",component:(()=>{class i{constructor(e,r,c,_,I){this.storyService=e,this.route=r,this.router=c,this.ts=_,this.synthesis=I,this.paragraphs=[],this.sentences=[],this.audioFinishedLoading=!1}ngOnInit(){var e=this;return(0,u.Z)(function*(){e.storyId=e.route.snapshot.paramMap.get("id");let r=yield(0,B.z)(e.storyService.getStory(e.storyId));e.synthesis.synthesiseStory(r).then(([c,_])=>{e.paragraphs=c,e.sentences=_,e.chosenSections=e.paragraphs,e.audioFinishedLoading=!0})})()}isSentenceMode(){return this.chosenSections[0]instanceof rt.cj}isParagraphMode(){return this.chosenSections[0]instanceof rt.nv}changeSections(e){this.chosenSections=e,this.paragraphs.concat(this.sentences).forEach(c=>this.stopSection(c))}playSection(e){e.play(),e.highlight()}stopSection(e){e.stop(),e.removeHighlight()}goToDashboard(){this.router.navigateByUrl("/dashboard/"+this.storyId)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(T.N),t.Y36(o.gz),t.Y36(o.F0),t.Y36(v.D),t.Y36(rt.cf))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-synthesis"]],decls:18,vars:5,consts:[["src","assets/img/book.png",1,"bookImg"],[1,"page"],[1,"paragraphContainer"],[1,"bookContainerSynth"],[1,"bookHeader"],[1,"myStoriesBtn",3,"click"],[1,"fa","fa-chevron-left"],[1,"storyContainer"],[1,"storyHeader"],[1,"textContainerSynth"],["class","loaderContainer",4,"ngIf"],[4,"ngIf"],[1,"footer"],["class","btnContainer",4,"ngIf"],[1,"loaderContainer"],["class","paragraphContainer",4,"ngFor","ngForOf"],[3,"innerHTML",4,"ngFor","ngForOf"],["class","playAudioBtn",3,"click",4,"ngIf"],[3,"innerHTML"],[1,"playAudioBtn",3,"click"],[1,"fas","fa-pause"],[1,"fa","fa-play"],[1,"btnContainer"],[1,"footerText"],[1,"changeSplitBtn","selectedBtn"],[1,"changeSplitBtn",3,"click"]],template:function(e,r){1&e&&(t._UZ(0,"img",0),t.TgZ(1,"div",1),t._UZ(2,"div",2),t.TgZ(3,"div",3)(4,"div",4)(5,"div",5),t.NdJ("click",function(){return r.goToDashboard()}),t._UZ(6,"i",6),t._uU(7),t.qZA(),t._UZ(8,"div"),t.qZA(),t.TgZ(9,"div",7)(10,"div",8),t._uU(11),t.qZA(),t.TgZ(12,"div")(13,"div",9),t.YNc(14,Qe,4,1,"div",10),t.YNc(15,$e,2,1,"div",11),t.qZA(),t.TgZ(16,"div",12),t.YNc(17,en,5,3,"div",13),t.qZA()()()()()),2&e&&(t.xp6(7),t.hij(" ",r.ts.l.story,""),t.xp6(4),t.hij(" ",r.ts.l.listen_and_correct," "),t.xp6(3),t.Q6J("ngIf",!r.audioFinishedLoading),t.xp6(1),t.Q6J("ngIf",r.audioFinishedLoading),t.xp6(2),t.Q6J("ngIf",r.audioFinishedLoading))},dependencies:[Re.P,s.sg,s.O5,qe.z],styles:['.bookHeader[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.myStoriesBtn[_ngcontent-%COMP%]{display:inline;border-style:none;color:var(--dark-text);width:100px;font-size:12pt;padding-top:10px;padding-left:5%}.myStoriesBtn[_ngcontent-%COMP%]:hover{color:var(--scealai-orange);cursor:pointer;transition:color .5s}.storyContainer[_ngcontent-%COMP%]{margin-top:10px}.storyHeader[_ngcontent-%COMP%]{background-color:var(--scealai-green);color:#fff;border-radius:4px 4px 0 0;width:90%;margin-left:5%}.playAudioBtn[_ngcontent-%COMP%]{background-color:var(--scealai-green);color:#fff;border-radius:4px;border:none;margin-left:4px;font-size:10pt;padding:4px 8px}.playAudioBtn[_ngcontent-%COMP%]:hover{background-color:var(--scealai-med-green);transition:.5s}.footerText[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:12pt;margin-right:5px}.changeSplitBtn[_ngcontent-%COMP%]:hover, .selectedBtn[_ngcontent-%COMP%]{background-color:var(--scealai-med-green)}@media only screen and (max-width: 350px){.footerText[_ngcontent-%COMP%], .changeSplitBtn[_ngcontent-%COMP%]{font-size:10pt}}@media only screen and (max-width: 300px){.footerText[_ngcontent-%COMP%], .changeSplitBtn[_ngcontent-%COMP%]{font-size:8pt}}@media only screen and (max-width: 700px){.bookImg[_ngcontent-%COMP%]{display:none}.bookContainerSynth[_ngcontent-%COMP%]{width:90%;margin-left:5%}}@media only screen and (min-width: 700px){.bookImg[_ngcontent-%COMP%]{z-index:-10;width:630px;left:50%;margin-left:-315px}.bookContainerSynth[_ngcontent-%COMP%]{width:490px;position:fixed;left:50%;margin-left:-245px;margin-top:20px}}@media only screen and (min-width: 1000px) and (min-height: 750px){.bookImg[_ngcontent-%COMP%]{z-index:-10;width:800px;height:600px;left:50%;margin-left:-400px}.bookContainerSynth[_ngcontent-%COMP%]{width:620px;height:510px;position:fixed;left:50%;margin-left:-310px;margin-top:20px}.textContainerSynth[_ngcontent-%COMP%]{height:390px}}@media only screen and (min-width: 1400px) and (min-height: 900px){.bookImg[_ngcontent-%COMP%]{z-index:-10;width:1000px;height:740px;left:50%;margin-left:-500px}.bookContainerSynth[_ngcontent-%COMP%]{width:800px;height:600px;position:fixed;left:50%;margin-left:-400px;margin-top:30px}.textContainerSynth[_ngcontent-%COMP%]{height:480px}}@media only screen and (min-width: 1900px) and (min-height: 1000px){.bookImg[_ngcontent-%COMP%]{z-index:-10;width:1200px;height:850px;left:50%;margin-left:-600px}.bookContainerSynth[_ngcontent-%COMP%]{width:980px;height:730px;position:fixed;left:50%;margin-left:-490px;margin-top:30px}.textContainerSynth[_ngcontent-%COMP%]{height:610px}.myStoriesBtn[_ngcontent-%COMP%]{width:120px}}.paragraphContainer[_ngcontent-%COMP%]     .highlightable{position:relative}.paragraphContainer[_ngcontent-%COMP%]     .highlightable:before{content:"";height:22px;width:0%;background:var(--scealai-light-blue);position:absolute;transition:var(--trans)}.paragraphContainer[_ngcontent-%COMP%]     .highlight:before{width:100%}.paragraphContainer[_ngcontent-%COMP%]     .noHighlight:before{right:0;width:0%}.paragraphContainer[_ngcontent-%COMP%]     .wordBtn:hover{background:var(--scealai-light-blue-hover);cursor:pointer}']}),i})(),canActivate:[a.P],canDeactivate:[m]}];let rn=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[o.Bz.forChild(on),o.Bz]}),i})(),sn=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[s.ez,rn,gt.LD,L.u5,Yt.fi.forRoot({customOptions:[{import:"formats/font",whitelist:["sans-serif","serif","monospace","arial","times-new-roman"]}]})]}),i})()},7244:(l,h,n)=>{var a=n(3436)(n(2119),"DataView");l.exports=a},4994:(l,h,n)=>{var s=n(4312),o=n(6421),a=n(13),d=n(8685),t=n(6676);function m(u){var f=-1,T=null==u?0:u.length;for(this.clear();++f<T;){var y=u[f];this.set(y[0],y[1])}}m.prototype.clear=s,m.prototype.delete=o,m.prototype.get=a,m.prototype.has=d,m.prototype.set=t,l.exports=m},9215:(l,h,n)=>{var s=n(1840),o=n(4378),a=n(4981),d=n(7343),t=n(8895);function m(u){var f=-1,T=null==u?0:u.length;for(this.clear();++f<T;){var y=u[f];this.set(y[0],y[1])}}m.prototype.clear=s,m.prototype.delete=o,m.prototype.get=a,m.prototype.has=d,m.prototype.set=t,l.exports=m},1501:(l,h,n)=>{var a=n(3436)(n(2119),"Map");l.exports=a},9850:(l,h,n)=>{var s=n(638),o=n(1184),a=n(866),d=n(3771),t=n(1772);function m(u){var f=-1,T=null==u?0:u.length;for(this.clear();++f<T;){var y=u[f];this.set(y[0],y[1])}}m.prototype.clear=s,m.prototype.delete=o,m.prototype.get=a,m.prototype.has=d,m.prototype.set=t,l.exports=m},4267:(l,h,n)=>{var a=n(3436)(n(2119),"Promise");l.exports=a},6323:(l,h,n)=>{var a=n(3436)(n(2119),"Set");l.exports=a},2858:(l,h,n)=>{var s=n(9215),o=n(3720),a=n(4410),d=n(5576),t=n(2247),m=n(1585);function u(f){var T=this.__data__=new s(f);this.size=T.size}u.prototype.clear=o,u.prototype.delete=a,u.prototype.get=d,u.prototype.has=t,u.prototype.set=m,l.exports=u},443:(l,h,n)=>{var s=n(2119);l.exports=s.Symbol},3457:(l,h,n)=>{var s=n(2119);l.exports=s.Uint8Array},4243:(l,h,n)=>{var a=n(3436)(n(2119),"WeakMap");l.exports=a},6837:l=>{l.exports=function h(n,s){for(var o=-1,a=null==n?0:n.length;++o<a&&!1!==s(n[o],o,n););return n}},9779:l=>{l.exports=function h(n,s){for(var o=-1,a=null==n?0:n.length,d=0,t=[];++o<a;){var m=n[o];s(m,o,n)&&(t[d++]=m)}return t}},2271:(l,h,n)=>{var s=n(5334),o=n(7151),a=n(1503),d=n(891),t=n(8442),m=n(8159),f=Object.prototype.hasOwnProperty;l.exports=function T(y,b){var x=a(y),v=!x&&o(y),p=!x&&!v&&d(y),w=!x&&!v&&!p&&m(y),S=x||v||p||w,k=S?s(y.length,String):[],O=k.length;for(var C in y)(b||f.call(y,C))&&(!S||!("length"==C||p&&("offset"==C||"parent"==C)||w&&("buffer"==C||"byteLength"==C||"byteOffset"==C)||t(C,O)))&&k.push(C);return k}},5059:l=>{l.exports=function h(n,s){for(var o=-1,a=s.length,d=n.length;++o<a;)n[d+o]=s[o];return n}},9719:(l,h,n)=>{var s=n(5683),o=n(217),d=Object.prototype.hasOwnProperty;l.exports=function t(m,u,f){var T=m[u];(!d.call(m,u)||!o(T,f)||void 0===f&&!(u in m))&&s(m,u,f)}},3503:(l,h,n)=>{var s=n(217);l.exports=function o(a,d){for(var t=a.length;t--;)if(s(a[t][0],d))return t;return-1}},4121:(l,h,n)=>{var s=n(1989),o=n(118);l.exports=function a(d,t){return d&&s(t,o(t),d)}},9287:(l,h,n)=>{var s=n(1989),o=n(6555);l.exports=function a(d,t){return d&&s(t,o(t),d)}},5683:(l,h,n)=>{var s=n(6713);l.exports=function o(a,d,t){"__proto__"==d&&s?s(a,d,{configurable:!0,enumerable:!0,value:t,writable:!0}):a[d]=t}},4462:(l,h,n)=>{var s=n(2858),o=n(6837),a=n(9719),d=n(4121),t=n(9287),m=n(9292),u=n(9454),f=n(4444),T=n(9905),y=n(7597),b=n(6967),x=n(8794),v=n(6782),p=n(7878),w=n(4264),S=n(1503),k=n(891),O=n(3222),C=n(5940),A=n(799),j=n(118),B=n(6555),N="[object Arguments]",ut="[object Function]",pt="[object Object]",P={};P[N]=P["[object Array]"]=P["[object ArrayBuffer]"]=P["[object DataView]"]=P["[object Boolean]"]=P["[object Date]"]=P["[object Float32Array]"]=P["[object Float64Array]"]=P["[object Int8Array]"]=P["[object Int16Array]"]=P["[object Int32Array]"]=P["[object Map]"]=P["[object Number]"]=P[pt]=P["[object RegExp]"]=P["[object Set]"]=P["[object String]"]=P["[object Symbol]"]=P["[object Uint8Array]"]=P["[object Uint8ClampedArray]"]=P["[object Uint16Array]"]=P["[object Uint32Array]"]=!0,P["[object Error]"]=P[ut]=P["[object WeakMap]"]=!1,l.exports=function st(U,Y,tt,Pt,at,W){var J,ct=1&Y,$=2&Y,jt=4&Y;if(tt&&(J=at?tt(U,Pt,at,W):tt(U)),void 0!==J)return J;if(!C(U))return U;var ft=S(U);if(ft){if(J=v(U),!ct)return u(U,J)}else{var D=x(U),mt=D==ut||"[object GeneratorFunction]"==D;if(k(U))return m(U,ct);if(D==pt||D==N||mt&&!at){if(J=$||mt?{}:w(U),!ct)return $?T(U,t(J,U)):f(U,d(J,U))}else{if(!P[D])return at?U:{};J=p(U,D,ct)}}W||(W=new s);var it=W.get(U);if(it)return it;W.set(U,J),A(U)?U.forEach(function(V){J.add(st(V,Y,tt,V,U,W))}):O(U)&&U.forEach(function(V,X){J.set(X,st(V,Y,tt,X,U,W))});var yt=ft?void 0:(jt?$?b:y:$?B:j)(U);return o(yt||U,function(V,X){yt&&(V=U[X=V]),a(J,X,st(V,Y,tt,X,U,W))}),J}},8858:(l,h,n)=>{var s=n(5940),o=Object.create,a=function(){function d(){}return function(t){if(!s(t))return{};if(o)return o(t);d.prototype=t;var m=new d;return d.prototype=void 0,m}}();l.exports=a},8247:(l,h,n)=>{var s=n(5059),o=n(1503);l.exports=function a(d,t,m){var u=t(d);return o(d)?u:s(u,m(d))}},3337:(l,h,n)=>{var s=n(443),o=n(1318),a=n(2902),m=s?s.toStringTag:void 0;l.exports=function u(f){return null==f?void 0===f?"[object Undefined]":"[object Null]":m&&m in Object(f)?o(f):a(f)}},186:(l,h,n)=>{var s=n(3337),o=n(2671);l.exports=function d(t){return o(t)&&"[object Arguments]"==s(t)}},7021:(l,h,n)=>{var s=n(8794),o=n(2671);l.exports=function d(t){return o(t)&&"[object Map]"==s(t)}},7304:(l,h,n)=>{var s=n(5946),o=n(1943),a=n(5940),d=n(2827),m=/^\[object .+?Constructor\]$/,b=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");l.exports=function x(v){return!(!a(v)||o(v))&&(s(v)?b:m).test(d(v))}},771:(l,h,n)=>{var s=n(8794),o=n(2671);l.exports=function d(t){return o(t)&&"[object Set]"==s(t)}},1083:(l,h,n)=>{var s=n(3337),o=n(6231),a=n(2671),E={};E["[object Float32Array]"]=E["[object Float64Array]"]=E["[object Int8Array]"]=E["[object Int16Array]"]=E["[object Int32Array]"]=E["[object Uint8Array]"]=E["[object Uint8ClampedArray]"]=E["[object Uint16Array]"]=E["[object Uint32Array]"]=!0,E["[object Arguments]"]=E["[object Array]"]=E["[object ArrayBuffer]"]=E["[object Boolean]"]=E["[object DataView]"]=E["[object Date]"]=E["[object Error]"]=E["[object Function]"]=E["[object Map]"]=E["[object Number]"]=E["[object Object]"]=E["[object RegExp]"]=E["[object Set]"]=E["[object String]"]=E["[object WeakMap]"]=!1,l.exports=function K(nt){return a(nt)&&o(nt.length)&&!!E[s(nt)]}},1172:(l,h,n)=>{var s=n(5488),o=n(5491),d=Object.prototype.hasOwnProperty;l.exports=function t(m){if(!s(m))return o(m);var u=[];for(var f in Object(m))d.call(m,f)&&"constructor"!=f&&u.push(f);return u}},2809:(l,h,n)=>{var s=n(5940),o=n(5488),a=n(2158),t=Object.prototype.hasOwnProperty;l.exports=function m(u){if(!s(u))return a(u);var f=o(u),T=[];for(var y in u)"constructor"==y&&(f||!t.call(u,y))||T.push(y);return T}},5334:l=>{l.exports=function h(n,s){for(var o=-1,a=Array(n);++o<n;)a[o]=s(o);return a}},5647:l=>{l.exports=function h(n){return function(s){return n(s)}}},3362:(l,h,n)=>{var s=n(3457);l.exports=function o(a){var d=new a.constructor(a.byteLength);return new s(d).set(new s(a)),d}},9292:(l,h,n)=>{l=n.nmd(l);var s=n(2119),o=h&&!h.nodeType&&h,a=o&&l&&!l.nodeType&&l,t=a&&a.exports===o?s.Buffer:void 0,m=t?t.allocUnsafe:void 0;l.exports=function u(f,T){if(T)return f.slice();var y=f.length,b=m?m(y):new f.constructor(y);return f.copy(b),b}},7e3:(l,h,n)=>{var s=n(3362);l.exports=function o(a,d){var t=d?s(a.buffer):a.buffer;return new a.constructor(t,a.byteOffset,a.byteLength)}},4098:l=>{var h=/\w*$/;l.exports=function n(s){var o=new s.constructor(s.source,h.exec(s));return o.lastIndex=s.lastIndex,o}},2533:(l,h,n)=>{var s=n(443),o=s?s.prototype:void 0,a=o?o.valueOf:void 0;l.exports=function d(t){return a?Object(a.call(t)):{}}},5208:(l,h,n)=>{var s=n(3362);l.exports=function o(a,d){var t=d?s(a.buffer):a.buffer;return new a.constructor(t,a.byteOffset,a.length)}},9454:l=>{l.exports=function h(n,s){var o=-1,a=n.length;for(s||(s=Array(a));++o<a;)s[o]=n[o];return s}},1989:(l,h,n)=>{var s=n(9719),o=n(5683);l.exports=function a(d,t,m,u){var f=!m;m||(m={});for(var T=-1,y=t.length;++T<y;){var b=t[T],x=u?u(m[b],d[b],b,m,d):void 0;void 0===x&&(x=d[b]),f?o(m,b,x):s(m,b,x)}return m}},4444:(l,h,n)=>{var s=n(1989),o=n(9383);l.exports=function a(d,t){return s(d,o(d),t)}},9905:(l,h,n)=>{var s=n(1989),o=n(3051);l.exports=function a(d,t){return s(d,o(d),t)}},4610:(l,h,n)=>{var s=n(2119);l.exports=s["__core-js_shared__"]},6713:(l,h,n)=>{var s=n(3436),o=function(){try{var a=s(Object,"defineProperty");return a({},"",{}),a}catch{}}();l.exports=o},9122:l=>{var h="object"==typeof global&&global&&global.Object===Object&&global;l.exports=h},7597:(l,h,n)=>{var s=n(8247),o=n(9383),a=n(118);l.exports=function d(t){return s(t,a,o)}},6967:(l,h,n)=>{var s=n(8247),o=n(3051),a=n(6555);l.exports=function d(t){return s(t,a,o)}},4537:(l,h,n)=>{var s=n(3819);l.exports=function o(a,d){var t=a.__data__;return s(d)?t["string"==typeof d?"string":"hash"]:t.map}},3436:(l,h,n)=>{var s=n(7304),o=n(1990);l.exports=function a(d,t){var m=o(d,t);return s(m)?m:void 0}},9519:(l,h,n)=>{var o=n(9385)(Object.getPrototypeOf,Object);l.exports=o},1318:(l,h,n)=>{var s=n(443),o=Object.prototype,a=o.hasOwnProperty,d=o.toString,t=s?s.toStringTag:void 0;l.exports=function m(u){var f=a.call(u,t),T=u[t];try{u[t]=void 0;var y=!0}catch{}var b=d.call(u);return y&&(f?u[t]=T:delete u[t]),b}},9383:(l,h,n)=>{var s=n(9779),o=n(9975),d=Object.prototype.propertyIsEnumerable,t=Object.getOwnPropertySymbols;l.exports=t?function(u){return null==u?[]:(u=Object(u),s(t(u),function(f){return d.call(u,f)}))}:o},3051:(l,h,n)=>{var s=n(5059),o=n(9519),a=n(9383),d=n(9975);l.exports=Object.getOwnPropertySymbols?function(u){for(var f=[];u;)s(f,a(u)),u=o(u);return f}:d},8794:(l,h,n)=>{var s=n(7244),o=n(1501),a=n(4267),d=n(6323),t=n(4243),m=n(3337),u=n(2827),f="[object Map]",y="[object Promise]",b="[object Set]",x="[object WeakMap]",v="[object DataView]",p=u(s),w=u(o),S=u(a),k=u(d),O=u(t),C=m;(s&&C(new s(new ArrayBuffer(1)))!=v||o&&C(new o)!=f||a&&C(a.resolve())!=y||d&&C(new d)!=b||t&&C(new t)!=x)&&(C=function(A){var j=m(A),B="[object Object]"==j?A.constructor:void 0,H=B?u(B):"";if(H)switch(H){case p:return v;case w:return f;case S:return y;case k:return b;case O:return x}return j}),l.exports=C},1990:l=>{l.exports=function h(n,s){return n?.[s]}},4312:(l,h,n)=>{var s=n(862);l.exports=function o(){this.__data__=s?s(null):{},this.size=0}},6421:l=>{l.exports=function h(n){var s=this.has(n)&&delete this.__data__[n];return this.size-=s?1:0,s}},13:(l,h,n)=>{var s=n(862),d=Object.prototype.hasOwnProperty;l.exports=function t(m){var u=this.__data__;if(s){var f=u[m];return"__lodash_hash_undefined__"===f?void 0:f}return d.call(u,m)?u[m]:void 0}},8685:(l,h,n)=>{var s=n(862),a=Object.prototype.hasOwnProperty;l.exports=function d(t){var m=this.__data__;return s?void 0!==m[t]:a.call(m,t)}},6676:(l,h,n)=>{var s=n(862);l.exports=function a(d,t){var m=this.__data__;return this.size+=this.has(d)?0:1,m[d]=s&&void 0===t?"__lodash_hash_undefined__":t,this}},6782:l=>{var n=Object.prototype.hasOwnProperty;l.exports=function s(o){var a=o.length,d=new o.constructor(a);return a&&"string"==typeof o[0]&&n.call(o,"index")&&(d.index=o.index,d.input=o.input),d}},7878:(l,h,n)=>{var s=n(3362),o=n(7e3),a=n(4098),d=n(2533),t=n(5208);l.exports=function q(N,z,E){var K=N.constructor;switch(z){case"[object ArrayBuffer]":return s(N);case"[object Boolean]":case"[object Date]":return new K(+N);case"[object DataView]":return o(N,E);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return t(N,E);case"[object Map]":case"[object Set]":return new K;case"[object Number]":case"[object String]":return new K(N);case"[object RegExp]":return a(N);case"[object Symbol]":return d(N)}}},4264:(l,h,n)=>{var s=n(8858),o=n(9519),a=n(5488);l.exports=function d(t){return"function"!=typeof t.constructor||a(t)?{}:s(o(t))}},8442:l=>{var n=/^(?:0|[1-9]\d*)$/;l.exports=function s(o,a){var d=typeof o;return!!(a=a??9007199254740991)&&("number"==d||"symbol"!=d&&n.test(o))&&o>-1&&o%1==0&&o<a}},3819:l=>{l.exports=function h(n){var s=typeof n;return"string"==s||"number"==s||"symbol"==s||"boolean"==s?"__proto__"!==n:null===n}},1943:(l,h,n)=>{var d,s=n(4610),o=(d=/[^.]+$/.exec(s&&s.keys&&s.keys.IE_PROTO||""))?"Symbol(src)_1."+d:"";l.exports=function a(d){return!!o&&o in d}},5488:l=>{var h=Object.prototype;l.exports=function n(s){var o=s&&s.constructor;return s===("function"==typeof o&&o.prototype||h)}},1840:l=>{l.exports=function h(){this.__data__=[],this.size=0}},4378:(l,h,n)=>{var s=n(3503),a=Array.prototype.splice;l.exports=function d(t){var m=this.__data__,u=s(m,t);return!(u<0||(u==m.length-1?m.pop():a.call(m,u,1),--this.size,0))}},4981:(l,h,n)=>{var s=n(3503);l.exports=function o(a){var d=this.__data__,t=s(d,a);return t<0?void 0:d[t][1]}},7343:(l,h,n)=>{var s=n(3503);l.exports=function o(a){return s(this.__data__,a)>-1}},8895:(l,h,n)=>{var s=n(3503);l.exports=function o(a,d){var t=this.__data__,m=s(t,a);return m<0?(++this.size,t.push([a,d])):t[m][1]=d,this}},638:(l,h,n)=>{var s=n(4994),o=n(9215),a=n(1501);l.exports=function d(){this.size=0,this.__data__={hash:new s,map:new(a||o),string:new s}}},1184:(l,h,n)=>{var s=n(4537);l.exports=function o(a){var d=s(this,a).delete(a);return this.size-=d?1:0,d}},866:(l,h,n)=>{var s=n(4537);l.exports=function o(a){return s(this,a).get(a)}},3771:(l,h,n)=>{var s=n(4537);l.exports=function o(a){return s(this,a).has(a)}},1772:(l,h,n)=>{var s=n(4537);l.exports=function o(a,d){var t=s(this,a),m=t.size;return t.set(a,d),this.size+=t.size==m?0:1,this}},862:(l,h,n)=>{var o=n(3436)(Object,"create");l.exports=o},5491:(l,h,n)=>{var o=n(9385)(Object.keys,Object);l.exports=o},2158:l=>{l.exports=function h(n){var s=[];if(null!=n)for(var o in Object(n))s.push(o);return s}},3597:(l,h,n)=>{l=n.nmd(l);var s=n(9122),o=h&&!h.nodeType&&h,a=o&&l&&!l.nodeType&&l,t=a&&a.exports===o&&s.process,m=function(){try{return a&&a.require&&a.require("util").types||t&&t.binding&&t.binding("util")}catch{}}();l.exports=m},2902:l=>{var n=Object.prototype.toString;l.exports=function s(o){return n.call(o)}},9385:l=>{l.exports=function h(n,s){return function(o){return n(s(o))}}},2119:(l,h,n)=>{var s=n(9122),o="object"==typeof self&&self&&self.Object===Object&&self,a=s||o||Function("return this")();l.exports=a},3720:(l,h,n)=>{var s=n(9215);l.exports=function o(){this.__data__=new s,this.size=0}},4410:l=>{l.exports=function h(n){var s=this.__data__,o=s.delete(n);return this.size=s.size,o}},5576:l=>{l.exports=function h(n){return this.__data__.get(n)}},2247:l=>{l.exports=function h(n){return this.__data__.has(n)}},1585:(l,h,n)=>{var s=n(9215),o=n(1501),a=n(9850);l.exports=function t(m,u){var f=this.__data__;if(f instanceof s){var T=f.__data__;if(!o||T.length<199)return T.push([m,u]),this.size=++f.size,this;f=this.__data__=new a(T)}return f.set(m,u),this.size=f.size,this}},2827:l=>{var n=Function.prototype.toString;l.exports=function s(o){if(null!=o){try{return n.call(o)}catch{}try{return o+""}catch{}}return""}},1094:(l,h,n)=>{var s=n(4462);l.exports=function a(d){return s(d,4)}},217:l=>{l.exports=function h(n,s){return n===s||n!=n&&s!=s}},7151:(l,h,n)=>{var s=n(186),o=n(2671),a=Object.prototype,d=a.hasOwnProperty,t=a.propertyIsEnumerable,m=s(function(){return arguments}())?s:function(u){return o(u)&&d.call(u,"callee")&&!t.call(u,"callee")};l.exports=m},1503:l=>{l.exports=Array.isArray},6507:(l,h,n)=>{var s=n(5946),o=n(6231);l.exports=function a(d){return null!=d&&o(d.length)&&!s(d)}},891:(l,h,n)=>{l=n.nmd(l);var s=n(2119),o=n(3580),a=h&&!h.nodeType&&h,d=a&&l&&!l.nodeType&&l,m=d&&d.exports===a?s.Buffer:void 0;l.exports=(m?m.isBuffer:void 0)||o},5946:(l,h,n)=>{var s=n(3337),o=n(5940);l.exports=function u(f){if(!o(f))return!1;var T=s(f);return"[object Function]"==T||"[object GeneratorFunction]"==T||"[object AsyncFunction]"==T||"[object Proxy]"==T}},6231:l=>{l.exports=function n(s){return"number"==typeof s&&s>-1&&s%1==0&&s<=9007199254740991}},3222:(l,h,n)=>{var s=n(7021),o=n(5647),a=n(3597),d=a&&a.isMap,t=d?o(d):s;l.exports=t},5940:l=>{l.exports=function h(n){var s=typeof n;return null!=n&&("object"==s||"function"==s)}},2671:l=>{l.exports=function h(n){return null!=n&&"object"==typeof n}},799:(l,h,n)=>{var s=n(771),o=n(5647),a=n(3597),d=a&&a.isSet,t=d?o(d):s;l.exports=t},8159:(l,h,n)=>{var s=n(1083),o=n(5647),a=n(3597),d=a&&a.isTypedArray,t=d?o(d):s;l.exports=t},118:(l,h,n)=>{var s=n(2271),o=n(1172),a=n(6507);l.exports=function d(t){return a(t)?s(t):o(t)}},6555:(l,h,n)=>{var s=n(2271),o=n(2809),a=n(6507);l.exports=function d(t){return a(t)?s(t,!0):o(t)}},9975:l=>{l.exports=function h(){return[]}},3580:l=>{l.exports=function h(){return!1}},5439:l=>{window,l.exports=function(h){var n={};function s(o){if(n[o])return n[o].exports;var a=n[o]={i:o,l:!1,exports:{}};return h[o].call(a.exports,a,a.exports,s),a.l=!0,a.exports}return s.m=h,s.c=n,s.d=function(o,a,d){s.o(o,a)||Object.defineProperty(o,a,{enumerable:!0,get:d})},s.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},s.t=function(o,a){if(1&a&&(o=s(o)),8&a||4&a&&"object"==typeof o&&o&&o.__esModule)return o;var d=Object.create(null);if(s.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:o}),2&a&&"string"!=typeof o)for(var t in o)s.d(d,t,function(m){return o[m]}.bind(null,t));return d},s.n=function(o){var a=o&&o.__esModule?function(){return o.default}:function(){return o};return s.d(a,"a",a),a},s.o=function(o,a){return Object.prototype.hasOwnProperty.call(o,a)},s.p="/dist/",s(s.s=1)}([function(h,n,s){"use strict";var o=this&&this.__awaiter||function(d,t,m,u){return new(m||(m=Promise))(function(f,T){function y(v){try{x(u.next(v))}catch(p){T(p)}}function b(v){try{x(u.throw(v))}catch(p){T(p)}}function x(v){var p;v.done?f(v.value):(p=v.value,p instanceof m?p:new m(function(w){w(p)})).then(y,b)}x((u=u.apply(d,t||[])).next())})},a=this&&this.__generator||function(d,t){var m,u,f,T,y={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return T={next:b(0),throw:b(1),return:b(2)},"function"==typeof Symbol&&(T[Symbol.iterator]=function(){return this}),T;function b(x){return function(v){return function(p){if(m)throw new TypeError("Generator is already executing.");for(;T&&(T=0,p[0]&&(y=0)),y;)try{if(m=1,u&&(f=2&p[0]?u.return:p[0]?u.throw||((f=u.return)&&f.call(u),0):u.next)&&!(f=f.call(u,p[1])).done)return f;switch(u=0,f&&(p=[2&p[0],f.value]),p[0]){case 0:case 1:f=p;break;case 4:return y.label++,{value:p[1],done:!1};case 5:y.label++,u=p[1],p=[0];continue;case 7:p=y.ops.pop(),y.trys.pop();continue;default:if(!((f=(f=y.trys).length>0&&f[f.length-1])||6!==p[0]&&2!==p[0])){y=0;continue}if(3===p[0]&&(!f||p[1]>f[0]&&p[1]<f[3])){y.label=p[1];break}if(6===p[0]&&y.label<f[1]){y.label=f[1],f=p;break}if(f&&y.label<f[2]){y.label=f[2],y.ops.push(p);break}f[2]&&y.ops.pop(),y.trys.pop();continue}p=t.call(d,y)}catch(w){p=[6,w],u=0}finally{m=f=0}if(5&p[0])throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}([x,v])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.file2b64=void 0,n.file2b64=function(d){return o(this,void 0,void 0,function(){var t,m;return a(this,function(u){return t=new FileReader,m=new Promise(function(f,T){t.addEventListener("load",function(){var y,b=null===(y=t.result)||void 0===y?void 0:y.toString();b?f(b):T("could not convert file to base64")},!1)}),t.readAsDataURL(d),[2,m]})})}},function(h,n,s){"use strict";var o=this&&this.__awaiter||function(y,b,x,v){return new(x||(x=Promise))(function(p,w){function S(C){try{O(v.next(C))}catch(A){w(A)}}function k(C){try{O(v.throw(C))}catch(A){w(A)}}function O(C){var A;C.done?p(C.value):(A=C.value,A instanceof x?A:new x(function(j){j(A)})).then(S,k)}O((v=v.apply(y,b||[])).next())})},a=this&&this.__generator||function(y,b){var x,v,p,w,S={label:0,sent:function(){if(1&p[0])throw p[1];return p[1]},trys:[],ops:[]};return w={next:k(0),throw:k(1),return:k(2)},"function"==typeof Symbol&&(w[Symbol.iterator]=function(){return this}),w;function k(O){return function(C){return function(A){if(x)throw new TypeError("Generator is already executing.");for(;w&&(w=0,A[0]&&(S=0)),S;)try{if(x=1,v&&(p=2&A[0]?v.return:A[0]?v.throw||((p=v.return)&&p.call(v),0):v.next)&&!(p=p.call(v,A[1])).done)return p;switch(v=0,p&&(A=[2&A[0],p.value]),A[0]){case 0:case 1:p=A;break;case 4:return S.label++,{value:A[1],done:!1};case 5:S.label++,v=A[1],A=[0];continue;case 7:A=S.ops.pop(),S.trys.pop();continue;default:if(!((p=(p=S.trys).length>0&&p[p.length-1])||6!==A[0]&&2!==A[0])){S=0;continue}if(3===A[0]&&(!p||A[1]>p[0]&&A[1]<p[3])){S.label=A[1];break}if(6===A[0]&&S.label<p[1]){S.label=p[1],p=A;break}if(p&&S.label<p[2]){S.label=p[2],S.ops.push(A);break}p[2]&&S.ops.pop(),S.trys.pop();continue}A=b.call(y,S)}catch(j){A=[6,j],v=0}finally{x=p=0}if(5&A[0])throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}([O,C])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.imageCompressor=void 0;var d=s(2),t=s(3),m=s(0),u=s(4),f=s(5),T=function(){function y(b,x){var v=this;this.quill=b,this.options=x||{};var p=!!x.debug;this.Logger=new f.ConsoleLogger(p,!!x.suppressErrorLogging),(0,t.warnAboutOptions)(x,this.Logger),this.imageDrop=new d.ImageDrop(b,function(k){return o(v,void 0,void 0,function(){var O;return a(this,function(C){switch(C.label){case 0:return this.Logger.log("onImageDrop",{dataUrl:k}),[4,this.downscaleImageFromUrl(k)];case 1:return O=C.sent(),this.insertToEditor(O,y.b64toBlob(O)),[2]}})})},this.Logger),this.Logger.log("fileChanged",{options:x,quill:b,debug:p});var S=this.quill.getModule("toolbar");S?S.addHandler("image",function(){return v.selectLocalImage()}):this.Logger.error("Quill toolbar module not found! need { toolbar: // options } in Quill.modules for image icon to sit in")}return y.b64toBlob=function(b){for(var x=atob(b.split(",")[1]),v=b.slice(5).split(";")[0],p=new ArrayBuffer(x.length),w=new Uint8Array(p),S=0;S<x.length;S++)w[S]=x.charCodeAt(S);return new Blob([p],{type:v})},y.prototype.selectLocalImage=function(b){var x=this;this.range=this.quill.getSelection(),this.fileHolder=document.createElement("input"),this.fileHolder.setAttribute("type","file"),this.fileHolder.setAttribute("accept","image/*"),this.fileHolder.setAttribute("style","visibility:hidden"),this.fileHolder.onchange=function(){return x.fileChanged().then(function(){return b&&b()})},document.body.appendChild(this.fileHolder),this.fileHolder.click(),window.requestAnimationFrame(function(){x.fileHolder&&document.body.removeChild(x.fileHolder)})},y.prototype.fileChanged=function(b){var x;return o(this,void 0,void 0,function(){var v,p,w,S;return a(this,function(k){switch(k.label){case 0:return(v=b||(null===(x=this.fileHolder)||void 0===x?void 0:x.files))&&v.length?(this.Logger.log("fileChanged",{file:p=v[0]}),p?[4,(0,m.file2b64)(p)]:[2]):[2];case 1:return w=k.sent(),[4,this.downscaleImageFromUrl(w)];case 2:return S=k.sent(),this.insertToEditor(S,y.b64toBlob(S)),[2]}})})},y.prototype.downscaleImageFromUrl=function(b){return o(this,void 0,void 0,function(){var x;return a(this,function(v){switch(v.label){case 0:return[4,(0,u.downscaleImage)(this.Logger,b,this.options.maxWidth,this.options.maxHeight,this.options.imageType,this.options.keepImageTypes,this.options.ignoreImageTypes,this.options.quality)];case 1:return x=v.sent(),this.Logger.log("downscaleImageFromUrl",{dataUrl:b,dataUrlCompressed:x}),[2,x]}})})},y.prototype.insertToEditor=function(b,x){if(this.options.insertIntoEditor)this.options.insertIntoEditor(b,x);else{this.Logger.log("insertToEditor",{url:b}),this.range=this.quill.getSelection();var v=this.range;if(!v)return;this.logFileSize(b),this.quill.insertEmbed(v.index,"image","".concat(b),"user"),v.index++,this.quill.setSelection(v,"api")}},y.prototype.logFileSize=function(b){var x=(Math.round(3*(b.length-22)/4)/1024).toFixed(0);this.Logger.log("estimated img size: "+x+" kb")},y}();n.imageCompressor=T,window.imageCompressor=T,n.default=T},function(h,n,s){"use strict";var o=this&&this.__awaiter||function(T,y,b,x){return new(b||(b=Promise))(function(v,p){function w(O){try{k(x.next(O))}catch(C){p(C)}}function S(O){try{k(x.throw(O))}catch(C){p(C)}}function k(O){var C;O.done?v(O.value):(C=O.value,C instanceof b?C:new b(function(A){A(C)})).then(w,S)}k((x=x.apply(T,y||[])).next())})},a=this&&this.__generator||function(T,y){var b,x,v,p,w={label:0,sent:function(){if(1&v[0])throw v[1];return v[1]},trys:[],ops:[]};return p={next:S(0),throw:S(1),return:S(2)},"function"==typeof Symbol&&(p[Symbol.iterator]=function(){return this}),p;function S(k){return function(O){return function(C){if(b)throw new TypeError("Generator is already executing.");for(;p&&(p=0,C[0]&&(w=0)),w;)try{if(b=1,x&&(v=2&C[0]?x.return:C[0]?x.throw||((v=x.return)&&v.call(x),0):x.next)&&!(v=v.call(x,C[1])).done)return v;switch(x=0,v&&(C=[2&C[0],v.value]),C[0]){case 0:case 1:v=C;break;case 4:return w.label++,{value:C[1],done:!1};case 5:w.label++,x=C[1],C=[0];continue;case 7:C=w.ops.pop(),w.trys.pop();continue;default:if(!((v=(v=w.trys).length>0&&v[v.length-1])||6!==C[0]&&2!==C[0])){w=0;continue}if(3===C[0]&&(!v||C[1]>v[0]&&C[1]<v[3])){w.label=C[1];break}if(6===C[0]&&w.label<v[1]){w.label=v[1],v=C;break}if(v&&w.label<v[2]){w.label=v[2],w.ops.push(C);break}v[2]&&w.ops.pop(),w.trys.pop();continue}C=y.call(T,w)}catch(A){C=[6,A],x=0}finally{b=v=0}if(5&C[0])throw C[1];return{value:C[0]?C[1]:void 0,done:!0}}([k,O])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.ImageDrop=void 0;var d=s(0),t=function(){function T(y,b,x){var v=this;this.quill=y,this.onNewDataUrl=b,this.logger=x,this.quill.root.addEventListener("drop",function(p){return v.handleDrop(p)},!1),this.quill.root.addEventListener("paste",function(p){return v.handlePaste(p)},!1)}return T.prototype.handleDrop=function(y){return o(this,void 0,void 0,function(){var b,x,v,p,w,S,k;return a(this,function(O){switch(O.label){case 0:return y.preventDefault(),document.caretRangeFromPoint&&(b=document.getSelection(),x=document.caretRangeFromPoint(y.clientX,y.clientY),b&&x&&b.setBaseAndExtent(x.startContainer,x.startOffset,x.startContainer,x.startOffset)),[4,u(y)];case 1:return v=O.sent(),p=Array.from(v||[]).filter(function(C){return f(C.type)}),(w=p?.[0])?[4,(0,d.file2b64)(w)]:[3,3];case 2:return k=O.sent(),this.logger.log("handleNewImageFiles",{evt:y,files:v,filesFiltered:p,firstImage:w,base64ImageSrc:k}),this.onNewDataUrl(k),[2];case 3:return[4,m(y)];case 4:return(S=O.sent())?[4,(0,d.file2b64)(S)]:[3,6];case 5:return k=O.sent(),this.logger.log("handleNewImageFiles",{evt:y,blob:S,base64ImageSrc:k}),this.onNewDataUrl(k),[2];case 6:return[2]}})})},T.prototype.handlePaste=function(y){var b,x;return o(this,void 0,void 0,function(){var v,p,w,S;return a(this,function(k){switch(k.label){case 0:return v=Array.from((null===(b=y?.clipboardData)||void 0===b?void 0:b.items)||[]),this.logger.log("handlePaste",{files:v,evt:y}),p=v.filter(function(O){return f(O.type)}),this.logger.log("handlePaste",{images:p,evt:y}),p.length?p.filter(function(O){return"text/html"!==O.type}).length?(y.preventDefault(),(w=null===(x=p.pop())||void 0===x?void 0:x.getAsFile())?[4,(0,d.file2b64)(w)]:[2]):(this.logger.log("handlePaste also detected html"),[2]):[2];case 1:return S=k.sent(),this.logger.log("handleNewImageFiles",{base64ImageSrc:S}),this.onNewDataUrl(S),[2]}})})},T}();function m(T){var y;return o(this,void 0,void 0,function(){var b;return a(this,function(x){switch(x.label){case 0:return(b=null===(y=T.dataTransfer)||void 0===y?void 0:y.getData("URL"))?[4,fetch(b)]:[3,3];case 1:return[4,x.sent().blob()];case 2:return[2,x.sent()];case 3:return[2]}})})}function u(T){var y;return o(this,void 0,void 0,function(){return a(this,function(b){return[2,null===(y=T?.dataTransfer)||void 0===y?void 0:y.files]})})}function f(T){return!!T.match(/^image\/(gif|jpe?g|a?png|svg|webp|bmp)/i)}n.ImageDrop=t},function(h,n,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.warnAboutOptions=void 0,n.warnAboutOptions=function(o,a){o.maxWidth=o.maxWidth||1e3,o.maxHeight=o.maxHeight||1e3,o.maxWidth&&"number"!=typeof o.maxWidth&&(a.warn("[config error] 'maxWidth' is required to be a \"number\" (in pixels), \nreceived: ".concat(o.maxWidth,"\n-> using default 1000")),o.maxWidth=1e3),o.maxHeight&&"number"!=typeof o.maxHeight&&(a.warn("[config error] 'maxHeight' is required to be a \"number\" (in pixels), \nreceived: ".concat(o.maxHeight,"\n-> using default 1000")),o.maxHeight=1e3),o.quality&&"number"!=typeof o.quality&&(a.warn("quill.imageCompressor: [config error] 'quality' is required to be a \"number\", \nreceived: ".concat(o.quality,"\n-> using default 0.7")),o.quality=.7),!o.imageType||"string"==typeof o.imageType&&o.imageType.startsWith("image/")||(a.warn('quill.imageCompressor: [config error] \'imageType\' is required be in the form of "image/png" or "image/jpeg" etc ..., \nreceived: '.concat(o.imageType,"\n-> using default image/jpeg")),o.imageType="image/jpeg"),o.keepImageTypes||(o.keepImageTypes=[]),o.keepImageTypes&&!Array.isArray(o.keepImageTypes)&&(a.warn("quill.imageCompressor: [config error] 'keepImageTypes' is required to be a \"array\", received: ".concat(o.keepImageTypes," -> using default []")),o.keepImageTypes=[]),o.ignoreImageTypes||(o.ignoreImageTypes=[]),o.ignoreImageTypes&&!Array.isArray(o.ignoreImageTypes)&&(a.warn("quill.imageCompressor: [config error] 'ignoreImageTypes' is required to be a \"array\", received: ".concat(o.ignoreImageTypes," -> using default []")),o.ignoreImageTypes=[]),o.insertIntoEditor&&"function"!=typeof o.insertIntoEditor&&(a.warn("quill.imageCompressor: [config error] 'insertIntoEditor' is required to be a \"function\", received: ".concat(o.insertIntoEditor," -> using default undefined")),o.insertIntoEditor=void 0)}},function(h,n,s){"use strict";var o=this&&this.__awaiter||function(d,t,m,u){return new(m||(m=Promise))(function(f,T){function y(v){try{x(u.next(v))}catch(p){T(p)}}function b(v){try{x(u.throw(v))}catch(p){T(p)}}function x(v){var p;v.done?f(v.value):(p=v.value,p instanceof m?p:new m(function(w){w(p)})).then(y,b)}x((u=u.apply(d,t||[])).next())})},a=this&&this.__generator||function(d,t){var m,u,f,T,y={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return T={next:b(0),throw:b(1),return:b(2)},"function"==typeof Symbol&&(T[Symbol.iterator]=function(){return this}),T;function b(x){return function(v){return function(p){if(m)throw new TypeError("Generator is already executing.");for(;T&&(T=0,p[0]&&(y=0)),y;)try{if(m=1,u&&(f=2&p[0]?u.return:p[0]?u.throw||((f=u.return)&&f.call(u),0):u.next)&&!(f=f.call(u,p[1])).done)return f;switch(u=0,f&&(p=[2&p[0],f.value]),p[0]){case 0:case 1:f=p;break;case 4:return y.label++,{value:p[1],done:!1};case 5:y.label++,u=p[1],p=[0];continue;case 7:p=y.ops.pop(),y.trys.pop();continue;default:if(!((f=(f=y.trys).length>0&&f[f.length-1])||6!==p[0]&&2!==p[0])){y=0;continue}if(3===p[0]&&(!f||p[1]>f[0]&&p[1]<f[3])){y.label=p[1];break}if(6===p[0]&&y.label<f[1]){y.label=f[1],f=p;break}if(f&&y.label<f[2]){y.label=f[2],y.ops.push(p);break}f[2]&&y.ops.pop(),y.trys.pop();continue}p=t.call(d,y)}catch(w){p=[6,w],u=0}finally{m=f=0}if(5&p[0])throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}([x,v])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.downscaleImage=void 0,n.downscaleImage=function(d,t,m,u,f,T,y,b){return o(this,void 0,void 0,function(){var x,v,p,w,S,k,O,C;return a(this,function(A){switch(A.label){case 0:return x=t.split(";")[0].split(":")[1],f=f||"image/jpeg",b=b||.7,(v=new Image).src=t,[4,new Promise(function(j){v.onload=function(){j()}})];case 1:return A.sent(),p=function(j,B,H,L){if(H&&L&&j<=H&&B<=L)return[j,B];if(H&&j>H){var q=H,N=Math.floor(B/j*q);if(L&&N>L){var z=L;return[Math.floor(j/B*z),z]}return[q,N]}return L&&B>L?(N=L,[q=Math.floor(j/B*N),N]):[B,j]}(v.width,v.height,m,u),w=p[0],S=p[1],(k=document.createElement("canvas")).width=w,k.height=S,O=k.getContext("2d"),"image/jpeg"===f&&(O.fillStyle="#FFFFFF",O.fillRect(0,0,v.width,v.height)),y?.includes(x)?[2,t]:(T?.includes(x)&&(f=x),O.drawImage(v,0,0,w,S),C=k.toDataURL(f,b),d.log("downscaling image...",{args:{dataUrl:t,maxWidth:m,maxHeight:u,imageType:f,ignoreImageTypes:y,keepImageTypes:T,imageQuality:b},newHeight:S,newWidth:w}),[2,C])}})})}},function(h,n,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ConsoleLogger=void 0;var o=function(){function a(d,t){this.debug=d,this.suppressErrorLogging=t}return a.prototype.prefixString=function(){return"</> quill-image-compress: "},Object.defineProperty(a.prototype,"log",{get:function(){return this.debug?console.log.bind(console,this.prefixString()):function(){}},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"error",{get:function(){return this.suppressErrorLogging?function(){}:console.error.bind(console,this.prefixString())},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"warn",{get:function(){return this.suppressErrorLogging?function(){}:console.warn.bind(console,this.prefixString())},enumerable:!1,configurable:!0}),a}();n.ConsoleLogger=o}])}}]);