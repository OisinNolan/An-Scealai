(self.webpackChunkan_scealai=self.webpackChunkan_scealai||[]).push([[979],{1979:(p,v,n)=>{"use strict";n.r(v),n.d(v,{StudentModule:()=>lr});var l=n(6895),s=n(1390),a=n(970),u=n(4633),g=n(8977),e=n(4650),i=n(5412);let d=(()=>{class o{canDeactivate(t,r,c){return!!t.storySaved||(t.showModal(),t.modalChoice)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),w=(()=>{class o{constructor(t,r){this.dialog=t,this.ts=r}canDeactivate(t){if(t.recordingSaved)return!0;let r;return r=this.dialog.open(u.p,{data:{title:this.ts.l.save_changes_made_to_this_recording,type:"",confirmText:this.ts.l.save,cancelText:this.ts.l.cancel},width:"30vh"}),r.afterClosed().subscribe(c=>{if(r=void 0,c)return t.saveRecordings(),!0}),!1}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(i.uw),e.LFG(g.D))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),m=(()=>{class o{canDeactivate(t,r,c){if(t.chosenSections)for(const x of t.chosenSections)x.stop();return!0}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var h=n(5861),y=n(4412);class b extends y.i{constructor(){super(...arguments),this.createdWithPrompts=!1}}var _=n(1765),C=n(1745),T=n(1512),A=n(6469),P=n(4687),S=n(1245),k=n(25),N=n(5042),H=n(530),G=n(8443);let L=(()=>{class o{transform(t,r){return t?r?(r=r.toLocaleLowerCase(),t.filter(c=>c instanceof G.n?c.username.toLocaleLowerCase().includes(r):c instanceof b?c.title.toLocaleLowerCase().includes(r)||c.text.toLocaleLowerCase().includes(r):void 0)):t:[]}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.Yjl({name:"appFilter",type:o,pure:!0}),o})();var B=n(3905),Z=n(4006),W=n(9121);function F(o,f){1&o&&(e.TgZ(0,"div",17),e._UZ(1,"grid-spinner"),e.qZA())}function K(o,f){if(1&o&&(e.TgZ(0,"div",17),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.ts.l.click_new_story," ")}}function le(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"input",23),e.NdJ("click",function(){e.CHM(t);const c=e.oxw().$implicit,x=e.oxw();return e.KtG(x.toggleDelete(c._id))}),e.qZA()}}function xe(o,f){if(1&o&&(e.TgZ(0,"div",24),e._uU(1),e.ALo(2,"date"),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,t.lastUpdated,"M/d/yy, h:mm a"))}}function Ae(o,f){if(1&o&&(e.TgZ(0,"div",24),e._uU(1),e.ALo(2,"date"),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,t.lastUpdated,"d/M/yy, h:mm a"))}}const Oe=function(o){return["../dashboard",o]};function Pe(o,f){if(1&o&&(e.TgZ(0,"div")(1,"div",18)(2,"div",19),e.YNc(3,le,1,0,"input",20),e.TgZ(4,"div",21),e._uU(5),e.qZA()(),e.YNc(6,xe,3,4,"div",22),e.YNc(7,Ae,3,4,"div",22),e.qZA(),e._UZ(8,"hr"),e.qZA()),2&o){const t=f.$implicit,r=e.oxw();e.xp6(3),e.Q6J("ngIf",r.deleteMode),e.xp6(1),e.Q6J("searchedWord",r.searchText)("content",t.title)("classToApply","font-weight-bold")("setTitle","true")("routerLink",e.VKq(9,Oe,t._id)),e.xp6(1),e.hij(" ",t.title," "),e.xp6(1),e.Q6J("ngIf",r.isFromAmerica),e.xp6(1),e.Q6J("ngIf",!r.isFromAmerica)}}function we(o,f){if(1&o&&(e.TgZ(0,"span",27),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.unreadMessages," ")}}function Ee(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.goToMessages())}),e._uU(1),e.YNc(2,we,2,1,"span",26),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.ts.l.messages," "),e.xp6(1),e.Q6J("ngIf",t.unreadMessages>0)}}function Ie(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.goToStats())}),e._uU(1),e.qZA()}if(2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.ts.l.stats," ")}}let De=(()=>{class o{constructor(t,r,c,x,M,O,E,U,I,j,z){this.storyService=t,this.auth=r,this.engagement=c,this.ts=x,this.router=M,this.messageService=O,this.profileService=E,this.classroomService=U,this.notificationService=I,this.recordingService=j,this.dialog=z,this.stories=[],this.toBeDeleted=[],this.userId="",this.messagesForNotifications=[],this.unreadMessages=0,this.isFromAmerica=!1,this.isEnrolled=!1,this.searchText="",this.storiesLoaded=!1}ngOnInit(){var t=this;return(0,h.Z)(function*(){const r=t.auth.getUserDetails();r?(t.stories=(yield(0,B.z)(t.storyService.getStoriesForLoggedInUser())).map(c=>(new b).fromJSON(c)),t.stories.sort((c,x)=>c.date>x.date?-1:1),t.storiesLoaded=!0,t.userId=r._id,t.deleteMode=!1,t.toBeDeleted=[],t.notificationService.getStudentNotifications(),t.classroomService.getClassroomOfStudent(t.userId).subscribe(c=>{t.isEnrolled=null!=c}),t.messageService.getMessagesForLoggedInUser().subscribe(c=>{t.messagesForNotifications=c,t.unreadMessages=t.messageService.getNumberOfUnreadMessages(t.messagesForNotifications)}),t.profileService.getForUser(t.userId).subscribe(c=>{let M=c.profile.country;t.isFromAmerica="United States of America"==M||"America"==M||"USA"==M||"United States"==M},c=>{t.router.navigateByUrl("/register-profile")})):t.auth.logout()})()}toggleDeleteMode(){if(this.deleteMode&&this.toBeDeleted.length>0)for(let t of this.toBeDeleted)this.engagement.addEventForLoggedInUser(T.tw["DELETE-STORY"],{_id:t}),this.recordingService.deleteStoryRecordingAudio(t).subscribe(r=>{}),this.recordingService.deleteStoryRecording(t).subscribe(r=>{}),this.storyService.deleteStory(t).subscribe(r=>{this.ngOnInit()});else this.deleteMode=!this.deleteMode||0!==this.toBeDeleted.length}toggleEditMode(){this.editMode=!this.editMode}toggleDelete(t){if(this.toBeDeleted.includes(t)){var r=this.toBeDeleted.indexOf(t);this.toBeDeleted.splice(r,1)}else this.toBeDeleted.push(t)}goToMessages(){this.router.navigateByUrl("/messages/"+this.userId)}goToStats(){this.router.navigateByUrl("/stats-dashboard/"+this.userId)}createNewStory(){var t=this;this.dialogRef=this.dialog.open(u.p,{data:{title:this.ts.l.story_details,type:"select",data:[this.ts.l.enter_title,[this.ts.l.connacht,this.ts.l.munster,this.ts.l.ulster],[this.ts.l.title,this.ts.l.dialect]],confirmText:this.ts.l.save_details,cancelText:this.ts.l.cancel},width:"50vh"}),this.dialogRef.afterClosed().subscribe(function(){var r=(0,h.Z)(function*(c){if(t.dialogRef=void 0,c)if(c[0]){let x="connemara";c[1]==t.ts.l.munster&&(x="kerry"),c[1]==t.ts.l.ulster&&(x="donegal"),t.storyService.saveStory(t.auth.getUserDetails()._id,c[0],new Date,x,"",t.auth.getUserDetails().username,!1)}else alert(t.ts.l.title_required)});return function(c){return r.apply(this,arguments)}}())}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(_.N),e.Y36(C.$),e.Y36(A.M),e.Y36(g.D),e.Y36(s.F0),e.Y36(S.e),e.Y36(P.H),e.Y36(k.u),e.Y36(N.g),e.Y36(H.s),e.Y36(i.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-book-contents"]],features:[e._Bn([L])],decls:27,vars:17,consts:[[1,"bookContainer"],[1,"contentsContainer"],[1,"bookContentsTitle"],[1,"contentsTitleContainer"],[1,"contentsLinkTitle"],[1,"contentsDateTitle"],["role","main"],[1,"form-group"],["type","text","id","search-text","aria-describedby","search-text",1,"form-control",3,"ngModel","placeholder","ngModelChange"],[1,"contentsLinkContainer"],["class","newStoryMessage",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"contentsBtnsContainer"],[1,"btn","deleteBtn",3,"click"],["src","assets/img/trash.ico",1,"trashImg"],["class","btn messagesBtn",3,"click",4,"ngIf"],["data-cy","create-story",1,"btn","newStoryBtn",3,"click"],[1,"newStoryMessage"],[1,"contentSection"],[1,"contentsLink"],["type","checkbox","class","deleteCheckbox",3,"click",4,"ngIf"],["appHighlight","",3,"searchedWord","content","classToApply","setTitle","routerLink"],["class","contentsDate",4,"ngIf"],["type","checkbox",1,"deleteCheckbox",3,"click"],[1,"contentsDate"],[1,"btn","messagesBtn",3,"click"],["class","notificationBtn",4,"ngIf"],[1,"notificationBtn"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._uU(3),e.qZA(),e.TgZ(4,"div",3)(5,"div",4),e._uU(6),e.qZA(),e.TgZ(7,"div",5),e._uU(8),e.qZA()(),e.TgZ(9,"div",6)(10,"div")(11,"div",7)(12,"input",8),e.NdJ("ngModelChange",function(x){return r.searchText=x}),e.qZA()()()(),e.TgZ(13,"div",9)(14,"div"),e._uU(15),e.qZA(),e.YNc(16,F,2,0,"div",10),e.YNc(17,K,2,1,"div",10),e.YNc(18,Pe,9,11,"div",11),e.ALo(19,"appFilter"),e.qZA(),e.TgZ(20,"div",12)(21,"button",13),e.NdJ("click",function(){return r.toggleDeleteMode()}),e._UZ(22,"img",14),e.qZA(),e.YNc(23,Ee,3,2,"button",15),e.YNc(24,Ie,2,1,"button",15),e.TgZ(25,"button",16),e.NdJ("click",function(){return r.createNewStory()}),e._uU(26),e.qZA()()()()),2&t&&(e.xp6(3),e.Oqu(r.ts.l.my_stories),e.xp6(3),e.Oqu(r.ts.l.title),e.xp6(2),e.Oqu(r.ts.l.last_updated),e.xp6(4),e.s9C("placeholder",r.ts.l.search_story_title_or_content),e.Q6J("ngModel",r.searchText),e.xp6(3),e.hij(" ",r.ts.l.loading," "),e.xp6(1),e.Q6J("ngIf",!r.storiesLoaded),e.xp6(1),e.Q6J("ngIf",0===r.stories.length&&r.storiesLoaded),e.xp6(1),e.Q6J("ngForOf",e.xi3(19,14,r.stories,r.searchText)),e.xp6(3),e.ekj("deleteModeBtn",r.deleteMode),e.xp6(2),e.Q6J("ngIf",r.isEnrolled),e.xp6(1),e.Q6J("ngIf",r.stories.length>0),e.xp6(2),e.hij("",r.ts.l.new_story," "))},dependencies:[l.sg,l.O5,s.rH,Z.Fj,Z.JJ,Z.On,W.P,l.uU,L],styles:[".bookContainer[_ngcontent-%COMP%]{height:auto;width:80%;background:url(https://www.abair.ie/scealai/assets/img/paperBg.jpg) no-repeat center fixed;margin-left:10%;box-shadow:0 0 11px 2px #0006;border-radius:5px;border:solid 2px rgba(130,118,98,.7215686275)}.contentsContainer[_ngcontent-%COMP%]{padding:20px}.bookContentsTitle[_ngcontent-%COMP%]{color:var(--dark-text);padding-left:5%;padding-right:5%;display:inline-block;font-size:18pt}.contentsLinkContainer[_ngcontent-%COMP%]{height:500px;overflow:auto;padding:10px;background-color:#f7f2e7;box-shadow:inset 0 0 12px #00000080;border-radius:5px}.contentsLink[_ngcontent-%COMP%]{color:var(--dark-text);text-align:left;width:50%;text-decoration:none}.contentsLink[_ngcontent-%COMP%]:hover{text-decoration:underline;cursor:pointer}.contentsDate[_ngcontent-%COMP%]{color:var(--dark-text)}.contentsBtnsContainer[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:space-between;flex-wrap:wrap;gap:1rem}.deleteBtn[_ngcontent-%COMP%]{background-color:var(--scealai-yellow);border-style:none;color:#fff;margin:0 4px 0 0;padding:2px 7px 7px;height:38px;border-radius:5px}.deleteBtn[_ngcontent-%COMP%]:hover{background-color:var(--scealai-yellow-hover)}.deleteModeBtn[_ngcontent-%COMP%]{background-color:var(--delete-red)}.deleteModeBtn[_ngcontent-%COMP%]:hover{background-color:var(--delete-red-hover)}.trashImg[_ngcontent-%COMP%]{width:24px}.messagesBtn[_ngcontent-%COMP%]{background-color:var(--scealai-yellow);border-style:none;color:#fff;font-size:12pt;border-radius:5px;display:flex}.messagesBtn[_ngcontent-%COMP%]:hover{background-color:var(--scealai-yellow-hover);color:#fff}.newStoryBtn[_ngcontent-%COMP%]{background-color:var(--scealai-yellow);border-style:none;color:#fff;font-size:12pt;margin:0;border-radius:5px}.newStoryBtn[_ngcontent-%COMP%]:hover{background-color:var(--scealai-yellow-hover);color:#fff}@media only screen and (max-width: 700px){.contentsContainer[_ngcontent-%COMP%]{width:90%;margin-left:5%}.contentsLinkContainer[_ngcontent-%COMP%]{height:270px;padding-top:10px}.contentsLinkTitle[_ngcontent-%COMP%], .contentsDateTitle[_ngcontent-%COMP%]{font-size:12pt}.optionsPopupBtn[_ngcontent-%COMP%]{padding:2px 5px 5px;margin:0 4px 0 0;height:30px;font-size:12pt}.deleteBtn[_ngcontent-%COMP%]{background-color:var(--scealai-yellow);border-style:none;color:#fff;margin:0 4px 0 0;float:left;padding:0 3px 3px;height:30px;border-radius:5px}.deleteBtn[_ngcontent-%COMP%]:hover{background-color:var(--scealai-yellow-hover)}.deleteModeBtn[_ngcontent-%COMP%]{background-color:var(--delete-red)}.deleteModeBtn[_ngcontent-%COMP%]:hover{background-color:var(--delete-red-hover)}.trashImg[_ngcontent-%COMP%]{width:20px}}.newStoryMessage[_ngcontent-%COMP%]{color:#a79d88;width:80%;margin-left:10%;margin-top:30px}@media only screen and (min-width: 700px){.optionsPopup[_ngcontent-%COMP%]{margin-left:55px}}@media only screen and (min-width: 1400px) and (min-height: 800px){.optionsPopup[_ngcontent-%COMP%]{margin-left:55px}}"]}),o})();var V=n(7579),Ce=n(1884),Fe=n(9971),ue=n.n(Fe),Be=n(5439),Ze=n.n(Be),Re=n(1094),Ne=n.n(Re),te=n(4186),Le=n(5592);function R(o){return Object.assign({},o)}class ge{constructor(f,t,r){this.errorsWithSentences=[],this.http=t,this.auth=r,this.grammarCheckers=f,this.cacheMap=new Map;for(const c of f)this.cacheMap.set(c.name,{})}check$(f){const t=new V.x;return this.check(f,t),t}check(f,t){var r=this;return(0,h.Z)(function*(){const x=function He(o,f){const t=[];let r=0;for(let c of o)if(c){const M=r+f.slice(r).indexOf(c);t.push({sentence:c,offset:M}),r=M+c.length}return t}(yield(0,B.z)(r.http.post(te.Z.baseurl+"nlp/sentenceTokenize",{text:f})),f);r.errorsWithSentences=[];const M=(yield Promise.all(r.grammarCheckers.map(function(){var O=(0,h.Z)(function*(E){return yield Promise.all(x.map(function(){var U=(0,h.Z)(function*(I,j){const z=I.sentence,q=I.offset;function se(de){return de.fromX+=q,de.toX+=q,t.next(de),de}if(z in r.cacheMap.get(E.name)){let de=r.cacheMap.get(E.name)[z].map(R).map(se);return r.errorsWithSentences[j]=r.errorsWithSentences[j]?[r.errorsWithSentences[j][0].concat(de),z,j]:[de,z,j],de}const ce=yield E.check(z,r.auth.getToken());r.cacheMap.get(E.name)[z]=ce;const ur=ce.map(R).map(se);return r.errorsWithSentences[j]=r.errorsWithSentences[j]?[r.errorsWithSentences[j][0].concat(ce),z,j]:[ce,z,j],ur});return function(I,j){return U.apply(this,arguments)}}()))});return function(E){return O.apply(this,arguments)}}()))).flat().filter(O=>O.length);return t.complete(),r.countNewErrors(M.flat()),M})()}countNewErrors(f){var t=this;return(0,h.Z)(function*(){t.previousErrorTags=f,t.countNewErrors=t._countNewErrorsAfterFirstTime})()}_countNewErrorsAfterFirstTime(f){return(0,h.Z)(function*(){const r=function Ue(o,f){return function M(O,E){return E.filter(U=>!O.includes(U)||(O[O.indexOf(U)]=null,!1)).map(U=>JSON.parse(U)[1])}(x(o),x(f));function x(O){return O.map(E=>JSON.stringify([E.errorText,E.type]))}}(t.previousErrorTags,f),x={countsByType:(o=r,o.reduce(function t(r,c){return r[c]||(r[c]=0),r[c]+=1,r},{}))};var o;t.http.post(te.Z.baseurl+"gramadoir/userGrammarCounts/",x).subscribe(),t.previousErrorTags=f})()}saveErrorsWithSentences(f){var t=this;return(0,h.Z)(function*(){if(!t.errorsWithSentences||!f)return;const r={Authorization:"Bearer "+t.auth.getToken()};t.http.post(te.Z.baseurl+"gramadoir/insert/",{storyId:f,sentences:t.errorsWithSentences},{headers:r}).subscribe()})()}}const D=ue().import("parchment"),ne=ue().import("ui/tooltip");ue().register(new D.Attributor.Attribute("highlight-tag","highlight-tag",{scope:D.Scope.INLINE})),ue().register(new D.Attributor.Attribute("highlight-tag-type","highlight-tag-type",{scope:D.Scope.INLINE}));class re{constructor(f,t,r){this.mostRecentHoveredMessage="",this.quillEditor=f,this.ts=t,this.engagement=r}show(f){f&&(f.forEach(r=>{this.quillEditor.formatText(r.fromX,r.toX-r.fromX,{"highlight-tag":JSON.stringify(r),"highlight-tag-type":r.type,"background-color":r.color},"api")}),document.querySelectorAll("[highlight-tag]").forEach(r=>{const c=r.getAttribute("highlight-tag");if(!c)return;const x=JSON.parse(c),M=new ne(this.quillEditor);M.root.classList.add("custom-tooltip"),r.addEventListener("mouseover",()=>{this.mouseOverTagElem(x,r,M)}),r.addEventListener("mouseout",()=>{r.removeAttribute("data-selected"),M.hide()})}))}hide(f){f.forEach(t=>{this.quillEditor.formatText(t.fromX,t.toX-t.fromX,{"highlight-tag":null,"highlight-tag-type":null,"background-color":"","data-selected":null})}),document.querySelectorAll(".custom-tooltip").forEach(t=>t.remove())}hideAll(){document.querySelectorAll("[data-selected]").forEach(t=>t.removeAttribute("data-selected")),this.quillEditor.formatText(0,this.quillEditor.getLength(),{"highlight-tag":null,"highlight-tag-type":null,"background-color":"","data-selected":null}),document.querySelectorAll(".custom-tooltip").forEach(t=>t.remove())}mouseOverTagElem(f,t,r){t.setAttribute("data-selected","");const c=this.quillEditor.root.scrollTop;this.quillEditor.root.scroll({top:+c+1}),this.quillEditor.root.scroll({top:+c}),r.root.innerHTML="en"==this.ts.l.iso_code?f.messageEN:f.messageGA,this.mostRecentHoveredMessage="en"==this.ts.l.iso_code?f.messageEN:f.messageGA,r.show(),r.position(this.quillEditor.getBounds(f.fromX,f.toX-f.fromX));let x=r.root.getAttribute("style")||"";x+="font-size: medium; z-index: 10000001;",r.root.setAttribute("style",x);const M=r.root.offsetLeft+r.root.offsetWidth-this.quillEditor.root.offsetWidth;r.root.style.left=M>0?r.root.offsetLeft-M-5+"px":r.root.style.left,r.root.style.left=r.root.offsetLeft<0?r.root.offsetLeft-r.root.offsetLeft+5+"px":r.root.style.left,this.engagement.mouseOverGrammarSuggestionEvent(f)}getGrammarMessage(f){return f?this.mostRecentHoveredMessage?this.mostRecentHoveredMessage:this.ts.message("hover_over_a_highlighted_word_for_a_grammar_suggestion"):this.ts.message("checking_grammar")}}var Y=n(8043);const fe={name:"Leathan_Caol",check:function Ge(o){return ve.apply(this,arguments)}},Q=["a","o","u","\xe1","\xf3","\xfa","A","O","U","\xc1","\xd3","\xda"],J=["e","i","\xe9","\xed","E","I","\xc9","\xcd"],he=["b","c","d","f","g","h","l","m","n","p","r","s","t","v","z","B","C","D","F","G","H","L","M","N","P","R","S","T","V","Z"],me=["aniar","an\xedos","ar\xe9ir","ar\xeds","ar\xedst","anseo","ansin","ansi\xfad","c\xe9n","den","faoina","ina","inar","insa","lena","lenar"];function ve(){return(ve=(0,h.Z)(function*(o){return new Promise((f,t)=>{const r=oe(o);let c=[];for(const x of r)c.push({errorText:o,messageGA:Y.U["LEATHAN-CAOL"].messageGA,messageEN:Y.U["LEATHAN-CAOL"].messageEN,context:o,nameEN:Y.U["LEATHAN-CAOL"].nameEN,nameGA:Y.U["LEATHAN-CAOL"].nameGA,color:Y.U["LEATHAN-CAOL"].color,fromX:x.first,toX:x.first+1,type:"LEATHAN-CAOL"}),c.push({errorText:o,messageGA:Y.U["LEATHAN-CAOL"].messageGA,messageEN:Y.U["LEATHAN-CAOL"].messageEN,context:o,nameEN:Y.U["LEATHAN-CAOL"].nameEN,nameGA:Y.U["LEATHAN-CAOL"].nameGA,color:Y.U["LEATHAN-CAOL"].color,fromX:x.second,toX:x.second+1,type:"LEATHAN-CAOL"});f(c)})})).apply(this,arguments)}function oe(o){const f=function Se(o){let f=[];for(let t of me){let c=Te(o.toLowerCase(),t);for(let x of c)f[x]=t.length}return f}(o),t=[];for(let r=0;r<o.length-1;r++)if(f[r]>0&&(r+=f[r]),be(o[r])&&Xe(o[r+1])){let c=r++;for(;Xe(o[r]);)r++;if(be(o[r])&&!gt(o[c],o[r])){const x=$(o[c]);t.push({broadFirst:x,first:c,second:r})}}return t}function Te(o,f){var t=[];let r=new RegExp("[\\s.!?\\-]"+f+"[\\s.!?\\-]","g"),c=r.exec(o);for(;c;){r=new RegExp(f);let x=r.exec(c[0]);t.push(c.index+x.index),o=Je(o,c.index,"#".repeat(5)),r=new RegExp("[\\s.!?\\-]"+f+"[\\s.!?\\-]","g"),c=r.exec(o)}return t}function Je(o,f,t){return o.substr(0,f)+t+o.substr(f+t.length)}function be(o){return Q.includes(o)||J.includes(o)}function $(o){return Q.includes(o)}function Xe(o){return he.includes(o)}function gt(o,f){return Q.includes(o)&&Q.includes(f)||J.includes(o)&&J.includes(f)}const ft={name:"AnGramadoir",check:function ht(o,f){return Ye.apply(this,arguments)}};function Ye(){return Ye=(0,h.Z)(function*(o,f){return new Promise(function(){var t=(0,h.Z)(function*(r,c){let x=[];try{x=yield et(`${te.Z.baseurl}gramadoir/callAnGramadoir/${encodeURIComponent(o)}`,f)}catch{try{x=yield et(`https://cadhan.com/api/gramadoir/1.0/en/${o}`)}catch{c()}}r(x.map(O=>{const E=mt(O.ruleId),U=Y.U[E];return{errorText:O.errortext,messageGA:U.messageGA.replace("#",O.errortext),messageEN:U.messageEN.replace("#",O.errortext),context:O.context,nameEN:U.nameEN,nameGA:U.nameGA,color:U.color,fromX:+O.fromx,toX:+O.tox+1,type:E}}))});return function(r,c){return t.apply(this,arguments)}}())}),Ye.apply(this,arguments)}function et(o,f){return ze.apply(this,arguments)}function ze(){return(ze=(0,h.Z)(function*(o,f){let t={};f&&(t={Authorization:"Bearer "+f});const r=yield fetch(o,{headers:t,method:"POST"});if(r.ok)return yield r.json();throw new Error(r.statusText)})).apply(this,arguments)}function mt(o){if(!o)return"";const f=o.replace(/[A-Za-z:]+\//,"");if(!f)return"";const t=/[A-Z]+/.exec(f);return t&&t[0]?t[0]:""}const vt={name:"RelativeClause",check:function bt(o){return qe.apply(this,arguments)}},_t="https://phoneticsrv3.lcs.tcd.ie/gramsrv/api/grammar";function qe(){return qe=(0,h.Z)(function*(o){return new Promise(function(){var f=(0,h.Z)(function*(t,r){t((yield yt(o)).map(M=>({errorText:o.slice(M.fromx,M.tox),messageGA:M.msg,messageEN:M.msg,context:M.context,nameEN:Y.U["RELATIVE-CLAUSE"].nameEN,nameGA:Y.U["RELATIVE-CLAUSE"].nameGA,color:Y.U["RELATIVE-CLAUSE"].color,fromX:M.fromx,toX:M.tox,type:"RELATIVE-CLAUSE"})))});return function(t,r){return f.apply(this,arguments)}}())}),qe.apply(this,arguments)}function yt(o){return Qe.apply(this,arguments)}function Qe(){return(Qe=(0,h.Z)(function*(o){const f=yield fetch(_t,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:xt(o.replace(/\n/g," "))});return f.ok?yield f.json():[]})).apply(this,arguments)}function xt(o){return`text=${encodeURIComponent(o)}&check=relclause`}var tt=n(529),pe=n(8605),nt=n(3238),We=n(2687),wt=n(445),ye=n(1281),rt=n(9521),Ct=n(3353),St=n(4968),Tt=n(6451),_e=n(9300),ot=n(4004),it=n(9718),X=n(2722),at=n(5698),st=n(8675),Mt=n(8372),ee=n(7340);const ct=["*"],kt=["content"];function At(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div",2),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c._onBackdropClicked())}),e.qZA()}if(2&o){const t=e.oxw();e.ekj("mat-drawer-shown",t._isShowingBackdrop())}}function Ot(o,f){1&o&&(e.TgZ(0,"mat-drawer-content"),e.Hsn(1,2),e.qZA())}const Pt=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],Et=["mat-drawer","mat-drawer-content","*"],It={transformDrawer:(0,ee.X$)("transform",[(0,ee.SB)("open, open-instant",(0,ee.oB)({transform:"none",visibility:"visible"})),(0,ee.SB)("void",(0,ee.oB)({"box-shadow":"none",visibility:"hidden"})),(0,ee.eR)("void => open-instant",(0,ee.jt)("0ms")),(0,ee.eR)("void <=> open, open-instant => void",(0,ee.jt)("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},Dt=new e.OlP("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function Ft(){return!1}}),dt=new e.OlP("MAT_DRAWER_CONTAINER");let Ve=(()=>{class o extends pe.PQ{constructor(t,r,c,x,M){super(c,x,M),this._changeDetectorRef=t,this._container=r}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36((0,e.Gpc)(()=>$e)),e.Y36(e.SBq),e.Y36(pe.mF),e.Y36(e.R0b))},o.\u0275cmp=e.Xpm({type:o,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,r){2&t&&e.Udp("margin-left",r._container._contentMargins.left,"px")("margin-right",r._container._contentMargins.right,"px")},features:[e._Bn([{provide:pe.PQ,useExisting:o}]),e.qOj],ngContentSelectors:ct,decls:1,vars:0,template:function(t,r){1&t&&(e.F$t(),e.Hsn(0))},encapsulation:2,changeDetection:0}),o})(),Ke=(()=>{class o{constructor(t,r,c,x,M,O,E,U){this._elementRef=t,this._focusTrapFactory=r,this._focusMonitor=c,this._platform=x,this._ngZone=M,this._interactivityChecker=O,this._doc=E,this._container=U,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new V.x,this._animationEnd=new V.x,this._animationState="void",this.openedChange=new e.vpe(!0),this._openedStream=this.openedChange.pipe((0,_e.h)(I=>I),(0,ot.U)(()=>{})),this.openedStart=this._animationStarted.pipe((0,_e.h)(I=>I.fromState!==I.toState&&0===I.toState.indexOf("open")),(0,it.h)(void 0)),this._closedStream=this.openedChange.pipe((0,_e.h)(I=>!I),(0,ot.U)(()=>{})),this.closedStart=this._animationStarted.pipe((0,_e.h)(I=>I.fromState!==I.toState&&"void"===I.toState),(0,it.h)(void 0)),this._destroyed=new V.x,this.onPositionChanged=new e.vpe,this._modeChanged=new V.x,this.openedChange.subscribe(I=>{I?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{(0,St.R)(this._elementRef.nativeElement,"keydown").pipe((0,_e.h)(I=>I.keyCode===rt.hY&&!this.disableClose&&!(0,rt.Vb)(I)),(0,X.R)(this._destroyed)).subscribe(I=>this._ngZone.run(()=>{this.close(),I.stopPropagation(),I.preventDefault()}))}),this._animationEnd.pipe((0,Ce.x)((I,j)=>I.fromState===j.fromState&&I.toState===j.toState)).subscribe(I=>{const{fromState:j,toState:z}=I;(0===z.indexOf("open")&&"void"===j||"void"===z&&0===j.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(t){(t="end"===t?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(t),this._position=t,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=(0,ye.Ig)(t)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(t){("true"===t||"false"===t||null==t)&&(t=(0,ye.Ig)(t)),this._autoFocus=t}get opened(){return this._opened}set opened(t){this.toggle((0,ye.Ig)(t))}_forceFocus(t,r){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const c=()=>{t.removeEventListener("blur",c),t.removeEventListener("mousedown",c),t.removeAttribute("tabindex")};t.addEventListener("blur",c),t.addEventListener("mousedown",c)})),t.focus(r)}_focusByCssSelector(t,r){let c=this._elementRef.nativeElement.querySelector(t);c&&this._forceFocus(c,r)}_takeFocus(){if(!this._focusTrap)return;const t=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(r=>{!r&&"function"==typeof this._elementRef.nativeElement.focus&&t.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(t){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,t):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const t=this._doc.activeElement;return!!t&&this._elementRef.nativeElement.contains(t)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(t=!this.opened,r){t&&r&&(this._openedVia=r);const c=this._setOpen(t,!t&&this._isFocusWithinDrawer(),this._openedVia||"program");return t||(this._openedVia=null),c}_setOpen(t,r,c){return this._opened=t,t?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",r&&this._restoreFocus(c)),this._updateFocusTrapState(),new Promise(x=>{this.openedChange.pipe((0,at.q)(1)).subscribe(M=>x(M?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(t){const r=this._elementRef.nativeElement,c=r.parentNode;"end"===t?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),c.insertBefore(this._anchor,r)),c.appendChild(r)):this._anchor&&this._anchor.parentNode.insertBefore(r,this._anchor)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.SBq),e.Y36(We.qV),e.Y36(We.tE),e.Y36(Ct.t4),e.Y36(e.R0b),e.Y36(We.ic),e.Y36(l.K0,8),e.Y36(dt,8))},o.\u0275cmp=e.Xpm({type:o,selectors:[["mat-drawer"]],viewQuery:function(t,r){if(1&t&&e.Gf(kt,5),2&t){let c;e.iGM(c=e.CRH())&&(r._content=c.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(t,r){1&t&&e.WFA("@transform.start",function(x){return r._animationStarted.next(x)})("@transform.done",function(x){return r._animationEnd.next(x)}),2&t&&(e.uIk("align",null),e.d8E("@transform",r._animationState),e.ekj("mat-drawer-end","end"===r.position)("mat-drawer-over","over"===r.mode)("mat-drawer-push","push"===r.mode)("mat-drawer-side","side"===r.mode)("mat-drawer-opened",r.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:ct,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,r){1&t&&(e.F$t(),e.TgZ(0,"div",0,1),e.Hsn(2),e.qZA())},dependencies:[pe.PQ],encapsulation:2,data:{animation:[It.transformDrawer]},changeDetection:0}),o})(),$e=(()=>{class o{constructor(t,r,c,x,M,O=!1,E){this._dir=t,this._element=r,this._ngZone=c,this._changeDetectorRef=x,this._animationMode=E,this._drawers=new e.n_E,this.backdropClick=new e.vpe,this._destroyed=new V.x,this._doCheckSubject=new V.x,this._contentMargins={left:null,right:null},this._contentMarginChanges=new V.x,t&&t.change.pipe((0,X.R)(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),M.change().pipe((0,X.R)(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=O}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=(0,ye.Ig)(t)}get hasBackdrop(){return this._backdropOverride??(!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode)}set hasBackdrop(t){this._backdropOverride=null==t?null:(0,ye.Ig)(t)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe((0,st.O)(this._allDrawers),(0,X.R)(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(r=>!r._container||r._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe((0,st.O)(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe((0,Mt.b)(10),(0,X.R)(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,r=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._getWidth();else if("push"==this._left.mode){const c=this._left._getWidth();t+=c,r-=c}if(this._right&&this._right.opened)if("side"==this._right.mode)r+=this._right._getWidth();else if("push"==this._right.mode){const c=this._right._getWidth();r+=c,t-=c}t=t||null,r=r||null,(t!==this._contentMargins.left||r!==this._contentMargins.right)&&(this._contentMargins={left:t,right:r},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe((0,_e.h)(r=>r.fromState!==r.toState),(0,X.R)(this._drawers.changes)).subscribe(r=>{"open-instant"!==r.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe((0,X.R)(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){!t||t.onPositionChanged.pipe((0,X.R)(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe((0,at.q)(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(t){t&&t._modeChanged.pipe((0,X.R)((0,Tt.T)(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){const r=this._element.nativeElement.classList,c="mat-drawer-container-has-open";t?r.add(c):r.remove(c)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{"end"==t.position?this._end=t:this._start=t}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._canHaveBackdrop(t)).forEach(t=>t._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(t){return"side"!==t.mode||!!this._backdropOverride}_isDrawerOpen(t){return null!=t&&t.opened}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(wt.Is,8),e.Y36(e.SBq),e.Y36(e.R0b),e.Y36(e.sBO),e.Y36(pe.rL),e.Y36(Dt),e.Y36(e.QbO,8))},o.\u0275cmp=e.Xpm({type:o,selectors:[["mat-drawer-container"]],contentQueries:function(t,r,c){if(1&t&&(e.Suo(c,Ve,5),e.Suo(c,Ke,5)),2&t){let x;e.iGM(x=e.CRH())&&(r._content=x.first),e.iGM(x=e.CRH())&&(r._allDrawers=x)}},viewQuery:function(t,r){if(1&t&&e.Gf(Ve,5),2&t){let c;e.iGM(c=e.CRH())&&(r._userContent=c.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,r){2&t&&e.ekj("mat-drawer-container-explicit-backdrop",r._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[e._Bn([{provide:dt,useExisting:o}])],ngContentSelectors:Et,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,r){1&t&&(e.F$t(Pt),e.YNc(0,At,1,2,"div",0),e.Hsn(1),e.Hsn(2,1),e.YNc(3,Ot,2,0,"mat-drawer-content",1)),2&t&&(e.Q6J("ngIf",r.hasBackdrop),e.xp6(3),e.Q6J("ngIf",!r._content))},dependencies:[l.O5,Ve],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),o})(),Bt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[l.ez,nt.BQ,pe.ZD,pe.ZD,nt.BQ]}),o})();var Me=n(7392),lt=n(5802),ut=n(4859);function Zt(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div",3),e.NdJ("click",function(){const x=e.CHM(t).$implicit,M=e.oxw();return e.KtG(M.setStory(x))}),e.TgZ(1,"div",4)(2,"div",5)(3,"div"),e._uU(4),e.qZA()(),e.TgZ(5,"div",6),e._uU(6),e.ALo(7,"date"),e.qZA()(),e._UZ(8,"hr"),e.qZA()}if(2&o){const t=f.$implicit;e.xp6(1),e.uIk("id",t._id),e.xp6(3),e.Oqu(null==t?null:t.title),e.xp6(2),e.hij(" ",e.xi3(7,3,t.lastUpdated,"d/M/yy")," ")}}let Rt=(()=>{class o{constructor(t,r,c,x){this.ts=t,this.auth=r,this.storyService=c,this.dialog=x,this.stories=[],this.lastClickedStoryId="",this.storyEmitter=new e.vpe,this.hasFeedback=new e.vpe,this.storiesLoadedEmitter=new e.vpe}ngOnInit(){this.getStories()}getStories(){var t=this;return(0,h.Z)(function*(){t.stories=(yield(0,B.z)(t.storyService.getStoriesForLoggedInUser())).map(r=>(new b).fromJSON(r)),t.stories.length>0&&(t.stories.sort((r,c)=>r.date>c.date?-1:1),t.setStory(t.stories[0]),t.storiesLoadedEmitter.emit(!0))})()}setStory(t){null==t.htmlText&&(t.htmlText=t.text),this.storyEmitter.emit(t),this.hasFeedback.emit(!!(t.feedback.text||t.feedback.audioId||t.feedback.feedbackMarkup));let r=t._id,c=document.getElementById(r);c&&(this.lastClickedStoryId&&document.getElementById(this.lastClickedStoryId).classList.remove("clickedresultCard"),this.lastClickedStoryId=r,c.classList.add("clickedresultCard"))}createNewStory(){var t=this;this.dialogRef=this.dialog.open(u.p,{data:{title:this.ts.l.story_details,type:"select",data:[this.ts.l.enter_title,[this.ts.l.connacht,this.ts.l.munster,this.ts.l.ulster],[this.ts.l.title,this.ts.l.dialect]],confirmText:this.ts.l.save_details,cancelText:this.ts.l.cancel},width:"50vh"}),this.dialogRef.afterClosed().subscribe(function(){var r=(0,h.Z)(function*(c){if(t.dialogRef=void 0,c)if(c[0]){let x="connemara";c[1]==t.ts.l.munster&&(x="kerry"),c[1]==t.ts.l.ulster&&(x="donegal"),t.storyService.saveStory(t.auth.getUserDetails()._id,c[0],new Date,x,"",t.auth.getUserDetails().username,!1).subscribe({next:()=>{t.getStories()},error:()=>{alert("Not able to create a new story")}})}else alert(t.ts.l.title_required)});return function(c){return r.apply(this,arguments)}}())}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.D),e.Y36(C.$),e.Y36(_.N),e.Y36(i.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-story-drawer"]],outputs:{storyEmitter:"storyEmitter",hasFeedback:"hasFeedback",storiesLoadedEmitter:"storiesLoadedEmitter"},decls:5,vars:1,consts:[[1,"storyList"],[3,"click",4,"ngFor","ngForOf"],["mat-fab","",1,"newStoryButton",3,"click"],[3,"click"],[1,"contentSection"],[1,"contentsLink"],[1,"contentsDate"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Zt,9,6,"div",1),e.qZA(),e.TgZ(2,"button",2),e.NdJ("click",function(){return r.createNewStory()}),e.TgZ(3,"mat-icon"),e._uU(4,"add"),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("ngForOf",r.stories))},dependencies:[l.sg,ut.lW,Me.Hw,l.uU],styles:[".storyList[_ngcontent-%COMP%]{height:90%;overflow-y:scroll}.contentSection[_ngcontent-%COMP%]:hover{cursor:pointer}.contentsLink[_ngcontent-%COMP%]{color:var(--dark-text);text-align:left;text-decoration:none;padding-right:20px}.contentsLink[_ngcontent-%COMP%]:hover{text-decoration:underline;cursor:pointer}.contentsDate[_ngcontent-%COMP%]{padding-right:20px}.newStoryButton[_ngcontent-%COMP%]{float:right}.mat-fab.mat-accent[_ngcontent-%COMP%], .mat-mini-fab.mat-accent[_ngcontent-%COMP%]{background-color:var(--scealai-green)}.clickedresultCard[_ngcontent-%COMP%]{background-color:#eee;padding:2px;font-weight:bolder;border-radius:10px}"]}),o})();var ke=n(1481);function Nt(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div",10)(1,"label",11),e._uU(2),e.qZA(),e.TgZ(3,"input",12),e.NdJ("ngModelChange",function(c){e.CHM(t);const x=e.oxw();return e.KtG(x.wordLookedUp=c)})("keyup.enter",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.lookupWord())})("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.clearDictInput())}),e.qZA(),e.TgZ(4,"button",13),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.lookupWord())}),e._UZ(5,"i",14),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(2),e.hij("",t.ts.l.search,":"),e.xp6(1),e.Q6J("ngModel",t.wordLookedUp)}}function Lt(o,f){if(1&o&&e._UZ(0,"iframe",15),2&o){const t=e.oxw();e.Q6J("src",t.defaultDictIframeText,e.uOi)}}function Ut(o,f){1&o&&(e.TgZ(0,"div",16)(1,"ul")(2,"li")(3,"a",17),e._uU(4,"potafocal.com"),e.qZA()(),e.TgZ(5,"li")(6,"a",18),e._uU(7,"focloir.ie"),e.qZA()()()())}let jt=(()=>{class o{constructor(t,r,c,x){this.ts=t,this.sanitizer=r,this.http=c,this.engagement=x,this.wordLookedUp="",this.selectTeanglann=!0,this.defaultDictIframeText=this.sanitizer.bypassSecurityTrustResourceUrl("data:text/html;charset=utf-8,"+this.ts.l.search_for_words_in_dictionary),this.closeDictionaryEmitter=new e.vpe}ngOnInit(){}lookupWord(){var t=this;return(0,h.Z)(function*(){if(t.wordLookedUp){const r=t.http.post(te.Z.baseurl+"proxy/",{url:`https://www.teanglann.ie/en/fgb/${t.wordLookedUp}`}),c=yield(0,B.z)(r),x=(new DOMParser).parseFromString(c,"text/html");x.querySelectorAll(".ex > .head > a").forEach(I=>I.href=`https://www.teanglann.ie${I.href.slice(I.href.lastIndexOf("/en/"))}`),x.querySelector(".moar")?.remove();const E=x.querySelector(".listings");E.style.cssText+="margin-right: 0px; padding: 10px;",document.getElementById("dictiframe").src='data:text/html;charset=utf-8,<link type="text/css" rel="stylesheet" href="https://www.teanglann.ie/furniture/template.css"><link type="text/css" rel="stylesheet" href="https://www.teanglann.ie/furniture/fgb.css">'+E.outerHTML,t.engagement.addEventForLoggedInUser(T.tw["USE-DICTIONARY"],null,t.wordLookedUp)}else alert(t.ts.l.enter_a_word_to_lookup)})()}clearDictInput(){this.wordLookedUp&&(this.wordLookedUp="")}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.D),e.Y36(ke.H7),e.Y36(tt.eN),e.Y36(A.M))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-dictionary-drawer"]],outputs:{closeDictionaryEmitter:"closeDictionaryEmitter"},decls:16,vars:5,consts:[[1,"dictionaryContainer"],[1,"dictionaryHeader"],[1,"closeDictionaryBtn",3,"click"],[1,"fa","fa-times"],[1,"dictionarySubHeader"],[1,"dictionaryName",3,"click"],["class","dictionaryInput",4,"ngIf"],[2,"height","100%"],["class","dictionaryIframe","id","dictiframe",3,"src",4,"ngIf"],["class","dictionaryIframe","style","text-align: left",4,"ngIf"],[1,"dictionaryInput"],["for","dictlookup"],["type","text","id","dictlookup","name","dictlookup","autofocus","",3,"ngModel","ngModelChange","keyup.enter","click"],[1,"searchDictionaryBtn",3,"click"],["aria-hidden","true",1,"fa","fa-search"],["id","dictiframe",1,"dictionaryIframe",3,"src"],[1,"dictionaryIframe",2,"text-align","left"],["href","http://www.potafocal.com/beo/","target","_blank"],["href","https://www.focloir.ie","target","_blank"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h5"),e._uU(3),e.qZA(),e.TgZ(4,"div",2),e.NdJ("click",function(){return r.closeDictionaryEmitter.next(!0)}),e._UZ(5,"i",3),e.qZA()(),e.TgZ(6,"div",4)(7,"div",5),e.NdJ("click",function(){return r.selectTeanglann=!0}),e._uU(8," Teanglann "),e.qZA(),e._uU(9," | "),e.TgZ(10,"div",5),e.NdJ("click",function(){return r.selectTeanglann=!1}),e._uU(11),e.qZA()(),e.YNc(12,Nt,6,2,"div",6),e.TgZ(13,"div",7),e.YNc(14,Lt,1,1,"iframe",8),e.qZA(),e.YNc(15,Ut,8,0,"div",9),e.qZA()),2&t&&(e.xp6(3),e.hij(" ",r.ts.l.dictionary," "),e.xp6(8),e.hij(" ",r.ts.l.external_links," "),e.xp6(1),e.Q6J("ngIf",r.selectTeanglann),e.xp6(2),e.Q6J("ngIf",r.selectTeanglann),e.xp6(1),e.Q6J("ngIf",!r.selectTeanglann))},dependencies:[l.O5,Z.Fj,Z.JJ,Z.On],styles:[".dictionaryContainer[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;flex-wrap:wrap}.dictionaryHeader[_ngcontent-%COMP%]{padding:20px;background-color:var(--scealai-green);color:#fff;display:flex}.closeDictionaryBtn[_ngcontent-%COMP%]{margin-left:auto}.closeDictionaryBtn[_ngcontent-%COMP%]:hover{cursor:pointer}.dictionarySubHeader[_ngcontent-%COMP%]{padding-left:10px;padding-bottom:5px;background-color:var(--scealai-green);color:#fff;display:flex}.dictionaryName[_ngcontent-%COMP%]{background-color:var(--scealai-green);font-size:12px;color:#fff;padding-right:5px;padding-top:5px}.dictionaryName[_ngcontent-%COMP%]:hover{color:var(--scealai-light-green);text-decoration:none;cursor:pointer}.dictionaryInput[_ngcontent-%COMP%]{background-color:var(--scealai-green);color:#fff;display:flex;padding-bottom:10px;padding-left:10px;gap:1rem}.searchDictionaryBtn[_ngcontent-%COMP%]{background-color:var(--scealai-yellow);border-style:none;color:#fff;font-size:12pt;margin:0;border-radius:5px}.searchDictionaryBtn[_ngcontent-%COMP%]:hover{background-color:var(--scealai-yellow-hover);color:#fff}.dictionaryIframe[_ngcontent-%COMP%]{width:100%;border-radius:0 0 5px 5px}"]}),o})();const Ht=function(o){return{"background-color":o}};function Gt(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div",7),e.NdJ("click",function(){const x=e.CHM(t).$implicit,M=e.oxw();return e.KtG(M.toggleLegendTag(x.key,x.value))}),e._UZ(1,"div",8),e._uU(2),e.ALo(3,"titlecase"),e.ALo(4,"titlecase"),e._uU(5),e.qZA()}if(2&o){const t=f.$implicit,r=e.oxw();e.uIk("id",t.key),e.xp6(1),e.Q6J("ngStyle",e.VKq(8,Ht,t.value[0].color)),e.xp6(1),e.hij(" ","en"==r.ts.l.iso_code?e.lcZ(3,4,t.value[0].nameEN):e.lcZ(4,6,t.value[0].nameGA)," "),e.xp6(3),e.hij(" (","Broad/Slender"==t.value[0].nameEN?t.value.length/2:t.value.length,") ")}}let Jt=(()=>{class o{constructor(t){this.ts=t,this.closeGrammarEmitter=new e.vpe}ngOnInit(){console.log(this.grammarErrorsTypeDict)}selectedGrammarSuggestion(){return this.quillHighlighter?this.quillHighlighter.getGrammarMessage(this.grammarLoaded):""}toggleLegendTag(t,r){this.checkBoxes[t]=!this.checkBoxes[t],this.checkBoxes[t]?(this.quillHighlighter.show(r),document.getElementById(t).classList.remove("hideLegendItem")):(this.quillHighlighter.hide(r),document.getElementById(t).classList.add("hideLegendItem"))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.D))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-grammar-error-drawer"]],inputs:{quillHighlighter:"quillHighlighter",grammarLoaded:"grammarLoaded",grammarErrorsTypeDict:"grammarErrorsTypeDict",checkBoxes:"checkBoxes"},outputs:{closeGrammarEmitter:"closeGrammarEmitter"},decls:10,vars:5,consts:[[1,"dictionaryHeader"],[1,"closeDictionaryBtn",3,"click"],[1,"fa","fa-times"],[1,"grammarMessageBanner"],[1,"grammarMessage",3,"innerHTML"],[1,"selectErrorCheckbox"],["class","errorContainer",3,"click",4,"ngFor","ngForOf"],[1,"errorContainer",3,"click"],[1,"errorColorBox",3,"ngStyle"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"h5"),e._uU(2),e.qZA(),e.TgZ(3,"div",1),e.NdJ("click",function(){return r.closeGrammarEmitter.next(!0)}),e._UZ(4,"i",2),e.qZA()(),e.TgZ(5,"div",3),e._UZ(6,"div",4),e.qZA(),e.TgZ(7,"div",5),e.YNc(8,Gt,6,10,"div",6),e.ALo(9,"keyvalue"),e.qZA()),2&t&&(e.xp6(2),e.hij(" ",r.ts.message("grammar_errors")," "),e.xp6(4),e.Q6J("innerHTML",r.selectedGrammarSuggestion(),e.oJD),e.xp6(2),e.Q6J("ngForOf",e.lcZ(9,3,r.grammarErrorsTypeDict)))},dependencies:[l.sg,l.PC,l.rS,l.Nd],styles:[".grammarMessageBanner[_ngcontent-%COMP%]{padding-bottom:20px}.selectErrorCheckbox[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-wrap:wrap;justify-content:space-around;text-align:left;padding-left:10px;gap:1.5rem;-webkit-user-select:none;-moz-user-select:none;user-select:none}.errorContainer[_ngcontent-%COMP%]{margin:2px}.errorContainer[_ngcontent-%COMP%]:hover{cursor:pointer}.errorColorBox[_ngcontent-%COMP%]{display:inline-flex;width:30px;height:15px}.hideLegendItem[_ngcontent-%COMP%]{text-decoration:line-through;opacity:.5}.dictionaryContainer[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;flex-wrap:wrap}.dictionaryHeader[_ngcontent-%COMP%]{padding:20px;background-color:var(--scealai-green);color:#fff;display:flex}.closeDictionaryBtn[_ngcontent-%COMP%]{margin-left:auto}.closeDictionaryBtn[_ngcontent-%COMP%]:hover{cursor:pointer}"]}),o})();function Yt(o,f){if(1&o&&e._UZ(0,"audio",7,8),2&o){const t=e.oxw();e.Q6J("src",t.audioSource,e.LSH)}}function zt(o,f){if(1&o&&e._UZ(0,"div",9),2&o){const t=e.oxw();e.Q6J("innerHTML",t.sanitizer.bypassSecurityTrustHtml(null==t.story||null==t.story.feedback?null:t.story.feedback.feedbackMarkup),e.oJD)}}let qt=(()=>{class o{constructor(t,r,c,x,M){this.ts=t,this.sanitizer=r,this.storyService=c,this.engagement=x,this.notificationService=M,this.closeFeedbackEmitter=new e.vpe}ngOnInit(){}ngOnChanges(t){this.story&&(this.story.feedback.text||this.story.feedback.audioId||this.story.feedback.feedbackMarkup)&&this.getFeedback()}getFeedback(){this.story.feedback.audioId&&this.getFeedbackAudio(),""!==this.story.feedback.text&&(this.story.feedback.seenByStudent=!0),this.storyService.viewFeedback(this.story._id).subscribe(()=>{this.engagement.addEventForLoggedInUser(T.tw["VIEW-FEEDBACK"],this.story),this.notificationService.getStudentNotifications()})}getFeedbackAudio(){this.storyService.getFeedbackAudio(this.story._id).subscribe(t=>{this.audioSource=this.sanitizer.bypassSecurityTrustUrl(URL.createObjectURL(t)),console.log(this.audioSource)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.D),e.Y36(ke.H7),e.Y36(_.N),e.Y36(A.M),e.Y36(N.g))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-feedback-drawer"]],inputs:{story:"story"},outputs:{closeFeedbackEmitter:"closeFeedbackEmitter"},features:[e.TTD],decls:11,vars:5,consts:[[1,"feedbackHeader"],[1,"closeFeedbackBtn",3,"click"],[1,"fa","fa-times"],[1,"textFieldContainer"],["readonly","",1,"textField",3,"placeholder","value"],["id","audio","controls","","class","audioPlayer",3,"src",4,"ngIf"],["class","textField","style","text-align: left; padding-left:25%; padding-right:25%;",3,"innerHTML",4,"ngIf"],["id","audio","controls","",1,"audioPlayer",3,"src"],["audioTag",""],[1,"textField",2,"text-align","left","padding-left","25%","padding-right","25%",3,"innerHTML"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"div",1),e.NdJ("click",function(){return r.closeFeedbackEmitter.next(!0)}),e._UZ(4,"i",2),e.qZA()(),e.TgZ(5,"div",3)(6,"textarea",4),e._uU(7,"    "),e.qZA(),e.YNc(8,Yt,2,1,"audio",5),e._UZ(9,"hr"),e.YNc(10,zt,1,1,"div",6),e.qZA()),2&t&&(e.xp6(2),e.hij(" ",r.ts.l.feedback," "),e.xp6(4),e.s9C("placeholder",r.ts.l.no_feedback_provided),e.s9C("value",null==r.story||null==r.story.feedback?null:r.story.feedback.text),e.xp6(2),e.Q6J("ngIf",r.audioSource&&(null==r.story||null==r.story.feedback?null:r.story.feedback.audioId)),e.xp6(2),e.Q6J("ngIf",null==r.story||null==r.story.feedback?null:r.story.feedback.feedbackMarkup))},dependencies:[l.O5],styles:[".feedbackHeader[_ngcontent-%COMP%]{width:100%;padding-left:20px;padding-right:20px;height:30px;background-color:var(--scealai-green);color:#fff;display:flex;align-items:center}.closeFeedbackBtn[_ngcontent-%COMP%]{margin-left:auto}.closeFeedbackBtn[_ngcontent-%COMP%]:hover{cursor:pointer}.textFieldContainer[_ngcontent-%COMP%]{width:100%;resize:none;z-index:1;color:var(--dark-text);background:white;padding-left:20px;padding-right:20px;padding-top:10px}.textField[_ngcontent-%COMP%]{width:100%;resize:none;z-index:1;color:var(--dark-text);background:white;padding-left:20px;padding-right:20px;padding-top:10px;border:none}.audioPlayer[_ngcontent-%COMP%]{height:30px;width:90%;background-color:#f1f3f4;border:1px solid rgba(140,128,110,.5254901961)}"]}),o})();const Qt=["rightDrawer"];function Wt(o,f){1&o&&(e.TgZ(0,"span"),e._uU(1,"*"),e.qZA())}function Vt(o,f){if(1&o&&(e.TgZ(0,"span",20),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.ts.l.made_using_prompts," ")}}function Kt(o,f){if(1&o&&(e.TgZ(0,"div",21),e._uU(1),e._UZ(2,"i",22),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.ts.l.saved," ")}}function $t(o,f){if(1&o&&(e.TgZ(0,"div",21),e._uU(1),e._UZ(2,"i",23),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.ts.l.saving," ")}}function Xt(o,f){if(1&o&&(e.TgZ(0,"div",14)(1,"div",15),e._uU(2),e.YNc(3,Wt,2,0,"span",16),e.YNc(4,Vt,2,1,"span",17),e.qZA(),e.TgZ(5,"div",18),e.YNc(6,Kt,3,1,"div",19),e.YNc(7,$t,3,1,"div",19),e.qZA()()),2&o){const t=e.oxw();let r;e.xp6(1),e.Q6J("ngStyle",t.titleStyle()),e.xp6(1),e.hij(" ",null!==(r=null==t.story?null:t.story.title)&&void 0!==r?r:"..."," "),e.xp6(1),e.Q6J("ngIf",!t.storySaved),e.xp6(1),e.Q6J("ngIf",null==t.story?null:t.story.createdWithPrompts),e.xp6(2),e.Q6J("ngIf",t.storySaved),e.xp6(1),e.Q6J("ngIf",!t.storySaved)}}function en(o,f){1&o&&e._UZ(0,"i",31)}function tn(o,f){1&o&&e._UZ(0,"i",32)}function nn(o,f){1&o&&(e.TgZ(0,"span",36),e._uU(1,"speech_to_text"),e.qZA())}function rn(o,f){1&o&&(e.TgZ(0,"button",37),e._UZ(1,"i",38),e.qZA())}function on(o,f){1&o&&(e.TgZ(0,"div"),e._UZ(1,"div",39),e.qZA())}const an=function(o){return{disableDiv:o}};function sn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div",33),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return c.dontToggle=!0,e.KtG(c.speakStory())}),e._uU(1),e.YNc(2,nn,2,0,"span",34),e.YNc(3,rn,2,0,"button",35),e.YNc(4,on,2,0,"div",16),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("ngClass",e.VKq(5,an,t.isTranscribing)),e.xp6(1),e.hij(" ",t.ts.l.speak," "),e.xp6(1),e.Q6J("ngIf",!t.isRecording),e.xp6(1),e.Q6J("ngIf",t.isRecording&&!t.isTranscribing),e.xp6(1),e.Q6J("ngIf",t.isTranscribing)}}function cn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div",40),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.dontToggle=!0)}),e.TgZ(1,"button",41),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.downloadStory())}),e._uU(2),e._UZ(3,"i",42),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.s9C("href",t.downloadStoryUrl()),e.xp6(1),e.hij(" ",t.ts.l.download," ")}}function dn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div",43),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return c.dontToggle=!0,e.KtG(c.toggleRightDrawer("feedback"))}),e._uU(1),e._UZ(2,"i",44),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.ts.l.feedback," ")}}function ln(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div",43),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return c.dontToggle=!0,e.KtG(c.toggleRightDrawer("dictionary"))}),e._uU(1),e._UZ(2,"i",45),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.ts.l.dictionary," ")}}function un(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div",43),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return c.dontToggle=!0,c.goToSynthesis(),e.KtG(c.drawer2.toggle())}),e._uU(1),e._UZ(2,"i",46),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.ts.l.audio_check," ")}}function pn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div",43),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return c.dontToggle=!0,e.KtG(c.toggleRightDrawer("grammar"))}),e._uU(1),e._UZ(2,"i",47),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.ts.l.grammar_errors," ")}}function gn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div",43),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return c.dontToggle=!0,e.KtG(c.goToRecording())}),e._uU(1),e._UZ(2,"i",48),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.ts.l.recordings," ")}}function fn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div",24),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.toggleOptions())}),e.TgZ(1,"div",25),e.YNc(2,en,1,0,"i",26),e.YNc(3,tn,1,0,"i",27),e.qZA(),e.YNc(4,sn,5,7,"div",28),e.YNc(5,cn,4,2,"div",29),e.YNc(6,dn,3,1,"div",30),e.YNc(7,ln,3,1,"div",30),e.YNc(8,un,3,1,"div",30),e.YNc(9,pn,3,1,"div",30),e.YNc(10,gn,3,1,"div",30),e.qZA()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.showOptions),e.xp6(1),e.Q6J("ngIf",t.showOptions),e.xp6(1),e.Q6J("ngIf",t.showOptions),e.xp6(1),e.Q6J("ngIf",t.showOptions),e.xp6(1),e.Q6J("ngIf",t.showOptions&&t.hasFeedback),e.xp6(1),e.Q6J("ngIf",t.showOptions),e.xp6(1),e.Q6J("ngIf",t.showOptions),e.xp6(1),e.Q6J("ngIf",t.showOptions),e.xp6(1),e.Q6J("ngIf",t.showOptions)}}function hn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div",49,50)(2,"mat-icon",51),e.NdJ("click",function(){e.CHM(t),e.oxw();const c=e.MAs(4);return e.KtG(c.toggle())}),e._uU(3,"menu"),e.qZA(),e.TgZ(4,"quill-editor",52),e.NdJ("ngModelChange",function(c){e.CHM(t);const x=e.oxw();return e.KtG(x.story.htmlText=c)})("onContentChanged",function(c){e.CHM(t);const x=e.oxw();return e.KtG(x.onContentChanged(c))})("onEditorCreated",function(c){e.CHM(t);const x=e.oxw();return e.KtG(x.onEditorCreated(c))}),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("ngStyle",t.quillEditorStyle),e.xp6(4),e.Q6J("modules",t.quillToolbar)("preserveWhitespace",!0)("debounceTime",1500)("ngModel",t.story.htmlText)}}function mn(o,f){1&o&&(e.TgZ(0,"div",53),e._uU(1," Click on the '+' button to create your first story! "),e.qZA())}function vn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"app-feedback-drawer",54),e.NdJ("closeFeedbackEmitter",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.toggleRightDrawer("feedback"))}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("story",t.story)}}function _n(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"app-dictionary-drawer",55),e.NdJ("closeDictionaryEmitter",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.toggleRightDrawer("dictionary"))}),e.qZA()}}function bn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"app-grammar-error-drawer",56),e.NdJ("closeGrammarEmitter",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.toggleRightDrawer("grammar"))}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("quillHighlighter",t.quillHighlighter)("grammarLoaded",t.grammarLoaded)("grammarErrorsTypeDict",t.grammarErrorsTypeDict)("checkBoxes",t.checkBoxes)}}ue().register("modules/imageCompress",Ze());let yn=(()=>{class o{constructor(t,r,c,x,M,O,E,U,I){this.ts=t,this.auth=r,this.storyService=c,this.recordAudioService=x,this.engagement=M,this.classroomService=O,this.dialog=E,this.http=U,this.router=I,this.stories=[],this.saveStoryDebounceId=0,this.mostRecentAttemptToSaveStory=new Date,this.storySaved=!0,this.storiesLoaded=!1,this.downloadStoryFormat=".pdf",this.hasFeedback=!1,this.grammarLoaded=!1,this.grammarErrors=[],this.showErrorTags=!1,this.grammarCheckerOptions={anGramadoir:ft,relativeClause:vt,broadSlender:fe},this.checkBoxes={},this.grammarErrorsTypeDict={},this.showOptions=!0,this.dontToggle=!1,this.words=[],this.wordCount=0,this.textUpdated=new V.x,this.quillToolbar={toolbar:[["bold","italic","underline","strike"],["blockquote"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{align:[]}],["clean"],["image"]],imageCompress:{quality:.7,maxWidth:500,maxHeight:500,imageType:"image/png",debug:!1,suppressErrorLogging:!1,insertIntoEditor:void 0}},this.isRecording=!1,this.isTranscribing=!1,this.setUpGrammarChecking()}ngOnInit(){return(0,h.Z)(function*(){})()}setUpGrammarChecking(){var t=this;return(0,h.Z)(function*(){const r=t.auth.getUserDetails();if(!r)return;let c=yield(0,B.z)(t.classroomService.getClassroomOfStudent(r._id)),x=[];c&&c.grammarCheckers&&c.grammarCheckers.length>0?c.grammarCheckers.forEach(M=>{t.grammarCheckerOptions[M]&&x.push(t.grammarCheckerOptions[M])}):x=Object.values(t.grammarCheckerOptions),t.grammarEngine=new ge(x,t.http,t.auth),t.textUpdated.pipe((0,Ce.x)()).subscribe((0,h.Z)(function*(){if(t.grammarLoaded=!1,t.story.text.replace(/\n/g," "))try{t.grammarErrors=[],t.grammarEngine.check$(t.story.text).subscribe({next:O=>{t.grammarErrors.push(O),t.showErrorTags&&t.quillHighlighter.show([O])},error:function(){},complete:()=>{if(t.quillHighlighter){t.showErrorTags&&t.quillHighlighter.show(t.grammarErrors.filter(O=>t.checkBoxes[O.type])),t.grammarErrors&&t.grammarEngine.saveErrorsWithSentences(t.story._id).then(console.log,console.error),t.grammarErrorsTypeDict=t.grammarErrors.reduce(function(O,E){return O[E.type]||(O[E.type]=[]),O[E.type].push(E),O},{}),console.log(t.grammarErrorsTypeDict);for(const O of Object.keys(t.grammarErrorsTypeDict))t.checkBoxes[O]=!0;t.grammarLoaded=!0}}})}catch(O){t.grammarErrors||window.alert("There was an error while trying to fetch grammar suggestions from the Gramad\xf3ir server:\n"+O.message+"\nSee the browser console for more information"),console.dir(O)}}))})()}toggleRightDrawer(t){this.selectedDrawer=t,this.rightDrawer.opened?(this.rightDrawer.close(),this.showErrorTags&&(this.showErrorTags=!1,this.toggleGrammarTags())):(this.rightDrawer.open(),"grammar"==this.selectedDrawer&&(this.showErrorTags=!0,this.toggleGrammarTags()))}setCurrentStory(t){this.story=t,this.story&&(this.storySaved=!0,this.getWordCount(this.story.text),this.textUpdated.next(t.text))}onContentChanged(t){"user"===(this.story.text=t.text,this.getWordCount(t.text),t.source)&&(this.storySaved=!1,this.textUpdated.next(t.text),this.debounceSaveStory())}onEditorCreated(t){t.history.options.userOnly=!0,this.quillEditor=t,this.quillEditor.root.setAttribute("spellcheck","false"),t.focus(),this.quillHighlighter=new re(this.quillEditor,this.ts,this.engagement)}getWordCount(t){if(!t)return 0;const r=t.replace(/[\t\n\r\.\?\!]/gm," ").split(" ");this.words=[],r.map(c=>{const x=c.trim();x.length>0&&this.words.push(x)}),this.wordCount=this.words.length}debounceSaveStory(){this.saveStoryDebounceId++;const t=this.saveStoryDebounceId,r=new Date;setTimeout(()=>{t===this.saveStoryDebounceId&&this.saveStory(t,r)},1e3)}saveStory(t,r){var c=this;return(0,h.Z)(function*(){const x=new Date;if(c.mostRecentAttemptToSaveStory=x,!c.story._id)return window.alert("Cannot save story. The id is not known");const M=c.stripGramadoirAttributesFromHtml(Ne()(c.story.htmlText)),O={title:c.story.title,dialect:c.story.dialect,text:c.story.text,htmlText:M,lastUpdated:r};c.engagement.addEventForLoggedInUser(T.tw["SAVE-STORY"],c.story);try{yield(0,B.z)(c.storyService.updateStory(O,c.story._id)),(t===c.saveStoryDebounceId||"modal"===t)&&(c.storySaved=!0)}catch(E){throw window.alert("Error while trying to save story: "+E.message),E}try{x===c.mostRecentAttemptToSaveStory&&(c.storySaved=!0)}catch(E){throw window.alert("Error setting storySaved to true: "+E.message),E}})()}stripGramadoirAttributesFromHtml(t){return t&&t.replace?t.replace(/\s*style="([^"])+"/g,"").replace(/\s*highlight-tag-type="([^"])+"/g,"").replace(/\s*highlight-tag="([^"])+"/g,""):""}toggleOptions(){this.dontToggle||(this.showOptions=!this.showOptions),this.dontToggle=!1}titleStyle(){return{"font-style":this.storySaved?"normal":"italic"}}downloadStory(){this.dialogRef=this.dialog.open(u.p,{data:{title:this.ts.l.download,type:"select",data:[this.story.title,[".pdf",".docx",".txt",".odt"]],confirmText:this.ts.l.download,cancelText:this.ts.l.cancel},width:"50vh"}),this.dialogRef.afterClosed().subscribe(t=>{this.dialogRef=void 0,t&&(this.downloadStoryFormat=t[1]?t[1]:".pdf",this.http.get(this.downloadStoryUrl(),{responseType:"blob"}).subscribe(r=>{const c=window.document.createElement("a");c.href=window.URL.createObjectURL(r),c.download=t[0]?t[0]:this.story.title,document.body.appendChild(c),c.click(),document.body.removeChild(c)}))})}downloadStoryUrl(){return te.Z.baseurl+"story/downloadStory/"+this.story._id+"/"+this.downloadStoryFormat}toggleGrammarTags(){var t=this;return(0,h.Z)(function*(){t.showErrorTags?t.quillHighlighter.show(t.grammarErrors.filter(r=>t.checkBoxes[r.type])):t.quillHighlighter.hideAll()})()}goToRecording(){this.router.navigateByUrl("/student/record-story/"+this.story._id)}speakStory(){var t=this;return(0,h.Z)(function*(){if(t.isRecording){t.isTranscribing=!0,t.recordAudioService.stopRecording();let r=yield t.recordAudioService.getAudioTranscription();if(t.isTranscribing=!1,r){let c=t.quillEditor.getSelection(!0);t.quillEditor.insertText(c.index,r+"."),t.story.text=t.quillEditor.getText(),t.story.htmlText=t.quillEditor.root.innerHTML,t.getWordCount(r),t.storySaved=!1,t.debounceSaveStory()}}else t.recordAudioService.recordAudio();t.isRecording=!t.isRecording})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.D),e.Y36(C.$),e.Y36(_.N),e.Y36(Le.r),e.Y36(A.M),e.Y36(k.u),e.Y36(i.uw),e.Y36(tt.eN),e.Y36(s.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-dashboard"]],viewQuery:function(t,r){if(1&t&&e.Gf(Qt,5),2&t){let c;e.iGM(c=e.CRH())&&(r.rightDrawer=c.first)}},decls:16,vars:7,consts:[["class","storyTitleHeader",4,"ngIf"],["class","optionsBtnContainer",3,"click",4,"ngIf"],["autosize","",1,"bodyContainer"],["mode","side","opened","true",1,"storyListDrawer"],["storyDrawer",""],[3,"storyEmitter","hasFeedback"],[1,"storyContainer"],["class","ql-container",3,"ngStyle",4,"ngIf","ngIfElse"],["newStoryMessage",""],["mode","side","position","end",1,"rightDrawer"],["rightDrawer",""],[3,"story","closeFeedbackEmitter",4,"ngIf"],[3,"closeDictionaryEmitter",4,"ngIf"],[3,"quillHighlighter","grammarLoaded","grammarErrorsTypeDict","checkBoxes","closeGrammarEmitter",4,"ngIf"],[1,"storyTitleHeader"],["data-cy","title","contenteditable","true",1,"storyTitle",3,"ngStyle"],[4,"ngIf"],["style","color: rgba(0, 0, 0, 0.4)",4,"ngIf"],[1,"saveIcon"],["class","savedIcon",4,"ngIf"],[2,"color","rgba(0, 0, 0, 0.4)"],[1,"savedIcon"],[1,"fas","fa-check"],[1,"fas","fa-save"],[1,"optionsBtnContainer",3,"click"],[1,"optionsBtn"],["class","fas fa-chevron-down",4,"ngIf"],["class","fas fa-chevron-right",4,"ngIf"],["class","optionsBtn optionsPopupBtn",3,"ngClass","click",4,"ngIf"],["style","display: flex",3,"click",4,"ngIf"],["class","optionsBtn optionsPopupBtn",3,"click",4,"ngIf"],[1,"fas","fa-chevron-down"],[1,"fas","fa-chevron-right"],[1,"optionsBtn","optionsPopupBtn",3,"ngClass","click"],["class","material-symbols-outlined optionsBtnIcon",4,"ngIf"],["class","notRecordingBtn blink",4,"ngIf"],[1,"material-symbols-outlined","optionsBtnIcon"],[1,"notRecordingBtn","blink"],[1,"fas","fa-stop-circle"],[1,"dot-flashing"],[2,"display","flex",3,"click"],["target","_blank",1,"optionsBtn","optionsPopupBtn",2,"text-decoration","none",3,"href","click"],[1,"fas","fa-download","optionsBtnIcon"],[1,"optionsBtn","optionsPopupBtn",3,"click"],[1,"fas","fa-comment-dots","optionsBtnIcon"],[1,"fas","fa-book","optionsBtnIcon"],[1,"fas","fa-volume-up","optionsBtnIcon"],[1,"fas","fa-spell-check","optionsBtnIcon"],[1,"fas","fa-microphone","optionsBtnIcon"],[1,"ql-container",3,"ngStyle"],["quillHeightSpan",""],[1,"menuButton",3,"click"],["placeholder","",3,"modules","preserveWhitespace","debounceTime","ngModel","ngModelChange","onContentChanged","onEditorCreated"],[1,"newStoryMessage"],[3,"story","closeFeedbackEmitter"],[3,"closeDictionaryEmitter"],[3,"quillHighlighter","grammarLoaded","grammarErrorsTypeDict","checkBoxes","closeGrammarEmitter"]],template:function(t,r){if(1&t&&(e.YNc(0,Xt,8,6,"div",0),e.YNc(1,fn,11,9,"div",1),e.TgZ(2,"mat-drawer-container",2)(3,"mat-drawer",3,4)(5,"app-story-drawer",5,4),e.NdJ("storyEmitter",function(x){return r.setCurrentStory(x)})("hasFeedback",function(x){return r.hasFeedback=x}),e.qZA()(),e.TgZ(7,"div",6),e.YNc(8,hn,5,5,"div",7),e.YNc(9,mn,2,0,"ng-template",null,8,e.W1O),e.qZA(),e.TgZ(11,"mat-drawer",9,10),e.YNc(13,vn,1,1,"app-feedback-drawer",11),e.YNc(14,_n,1,0,"app-dictionary-drawer",12),e.YNc(15,bn,1,4,"app-grammar-error-drawer",13),e.qZA()()),2&t){const c=e.MAs(10);e.Q6J("ngIf",r.story),e.xp6(1),e.Q6J("ngIf",r.story),e.xp6(7),e.Q6J("ngIf",r.story)("ngIfElse",c),e.xp6(5),e.Q6J("ngIf","feedback"==r.selectedDrawer),e.xp6(1),e.Q6J("ngIf","dictionary"==r.selectedDrawer),e.xp6(1),e.Q6J("ngIf","grammar"==r.selectedDrawer)}},dependencies:[l.mk,l.O5,l.PC,Z.JJ,Z.On,Ke,$e,Me.Hw,lt.g6,Rt,jt,Jt,qt],styles:[".storyTitleHeader{display:flex;justify-content:center;margin-top:-30px;padding-bottom:20px}.storyTitle{margin:auto;overflow:auto;font-size:20px;font-weight:bolder;padding-left:20px;padding-right:20px}.saveIcon{align-self:flex-end;white-space:nowrap;color:var(--dark-text);border-style:none;font-size:11pt;padding:5px}.savedIcon{color:var(--scealai-light-brown)}.optionsBtnContainer>*{height:2rem}.optionsBtnContainer{display:flex;justify-content:space-between;flex-wrap:wrap;--options-btn-background-color-hover: lightgray;margin-left:2%;margin-right:2%}.optionsBtn{background-color:var(--scealai-yellow);border-style:none;color:#464444;margin:0;border-radius:2px;display:flex;align-items:center;padding:5px;background:rgba(223,217,200,0)}.optionsBtn:hover{background-color:var(--options-btn-background-color-hover);color:#35322f;cursor:pointer;border-radius:2}.optionsPopupBtn{margin-right:4px}.optionsBtnIcon{margin-left:5px}.notRecordingBtn{background-color:red;color:#fff;border-radius:4px;border:none;margin-left:4px;font-size:10pt;padding:4px 8px}.bodyContainer{width:100%;height:100%}.storyListDrawer{padding:40px}.storyContainer{height:100%}.ql-container{background-color:#f8f9fa;height:100%}.ql-editor{background-color:#fff;z-index:1;margin-top:20px;font-size:14pt;font-family:Times New Roman,Times,serif;min-height:70vh!important;max-height:70vh!important}.menuButton{float:left;padding-left:10px;padding-top:5px;transform:scale(2);z-index:100}.menuButton:hover{cursor:pointer}.newStoryMessage{font-weight:bolder;max-width:200px;padding-top:50px;padding-bottom:50px;height:80vh;width:100%;display:flex;align-items:flex-end}.rightDrawer{width:25%;height:100%}.blink{animation:blinker 2s linear infinite}@keyframes blinker{0%{background-color:red}50%{background-color:#700}to{background-color:red}}\n",".custom-tooltip:before{content:none!important}[data-selected]{margin:.3em}[highlight-tag-type]{border-radius:3px}span[highlight-tag-type]:hover{cursor:pointer}span:not[highlight-tag-type]{border-radius:0;padding-left:0;padding-right:0}[highlight-tag-type=LEATHAN-CAOL]{border:1px solid gray;border-radius:0!important;padding-left:0!important;padding-right:0!important}\n",'.ql-editor{overflow-y:auto}.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=times-new-roman]:before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=times-new-roman]:before{content:"Times New Roman";font-family:Times New Roman}.ql-font-times-new-roman{font-family:times new roman}.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=arial]:before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=arial]:before{content:"Arial";font-family:arial}.ql-font-arial{font-family:arial}.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=sans-serif]:before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=sans-serif]:before{content:"Sans Serif";font-family:"sans serif"}.ql-font-sans-serif{font-family:"sans serif"}.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=monospace]:before,.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=monospace]:before{content:"Monospace";font-family:"monospace"}.ql-font-monospace{font-family:"monospace"}\n'],encapsulation:2}),o})();var ae=n(9742);let pt=(()=>{class o{constructor(t){this.sanitizer=t}transform(t){return this.sanitizer.bypassSecurityTrustHtml(t)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(ke.H7,16))},o.\u0275pipe=e.Yjl({name:"safeHtml",type:o,pure:!0}),o})();function xn(o,f){if(1&o&&(e.TgZ(0,"div",14)(1,"b"),e._uU(2),e.qZA(),e._UZ(3,"grid-spinner"),e.qZA()),2&o){const t=e.oxw();e.xp6(2),e.Oqu(t.ts.l.synthesising)}}function wn(o,f){1&o&&(e._UZ(0,"span",18),e.ALo(1,"safeHtml")),2&o&&e.Q6J("innerHTML",e.lcZ(1,1,f.$implicit.outerHTML),e.oJD)}function Cn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const c=e.oxw().$implicit,x=e.oxw(2);return e.KtG(x.stopSection(c))}),e._UZ(1,"i",20),e.qZA()}}function Sn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const c=e.oxw().$implicit,x=e.oxw(2);return e.KtG(x.playSection(c))}),e._UZ(1,"i",21),e.qZA()}}function Tn(o,f){if(1&o&&(e.TgZ(0,"div",2),e.YNc(1,wn,2,3,"span",16),e.YNc(2,Cn,2,0,"button",17),e.YNc(3,Sn,2,0,"button",17),e.qZA()),2&o){const t=f.$implicit;e.xp6(1),e.Q6J("ngForOf",t.spans),e.xp6(1),e.Q6J("ngIf",!t.audio.paused),e.xp6(1),e.Q6J("ngIf",t.audio.paused)}}function Mn(o,f){if(1&o&&(e.TgZ(0,"div"),e.YNc(1,Tn,4,3,"div",15),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.chosenSections)}}function kn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"button",24),e._uU(2),e.qZA(),e.TgZ(3,"button",25),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.changeSections(c.sentences))}),e._uU(4),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Oqu(t.ts.l.paragraph),e.xp6(2),e.Oqu(t.ts.l.sentence)}}function An(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"button",25),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.changeSections(c.paragraphs))}),e._uU(2),e.qZA(),e.TgZ(3,"button",24),e._uU(4),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Oqu(t.ts.l.paragraph),e.xp6(2),e.Oqu(t.ts.l.sentence)}}function On(o,f){if(1&o&&(e.TgZ(0,"div",22)(1,"div",23),e._uU(2),e.qZA(),e.YNc(3,kn,5,2,"div",11),e.YNc(4,An,5,2,"div",11),e.qZA()),2&o){const t=e.oxw();e.xp6(2),e.hij(" ",t.ts.l.listen_by," "),e.xp6(1),e.Q6J("ngIf",t.isParagraphMode()),e.xp6(1),e.Q6J("ngIf",t.isSentenceMode())}}let Pn=(()=>{class o{constructor(t,r,c,x,M){this.storyService=t,this.route=r,this.router=c,this.ts=x,this.synthesis=M,this.paragraphs=[],this.sentences=[],this.audioFinishedLoading=!1}ngOnInit(){var t=this;return(0,h.Z)(function*(){t.storyId=t.route.snapshot.paramMap.get("id");let r=yield(0,B.z)(t.storyService.getStory(t.storyId));t.synthesis.synthesiseStory(r).then(([c,x])=>{t.paragraphs=c,t.sentences=x,t.chosenSections=t.paragraphs,t.audioFinishedLoading=!0})})()}isSentenceMode(){return this.chosenSections[0]instanceof ae.cj}isParagraphMode(){return this.chosenSections[0]instanceof ae.nv}changeSections(t){this.chosenSections=t,this.paragraphs.concat(this.sentences).forEach(c=>this.stopSection(c))}playSection(t){t.play(),t.highlight()}stopSection(t){t.stop(),t.removeHighlight()}goToDashboard(){this.router.navigateByUrl("/student/dashboard/"+this.storyId)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(_.N),e.Y36(s.gz),e.Y36(s.F0),e.Y36(g.D),e.Y36(ae.cf))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-synthesis"]],decls:18,vars:5,consts:[["src","assets/img/book.png",1,"bookImg"],[1,"page"],[1,"paragraphContainer"],[1,"bookContainerSynth"],[1,"bookHeader"],[1,"myStoriesBtn",3,"click"],[1,"fa","fa-chevron-left"],[1,"storyContainer"],[1,"storyHeader"],[1,"textContainerSynth"],["class","loaderContainer",4,"ngIf"],[4,"ngIf"],[1,"footer"],["class","btnContainer",4,"ngIf"],[1,"loaderContainer"],["class","paragraphContainer",4,"ngFor","ngForOf"],[3,"innerHTML",4,"ngFor","ngForOf"],["class","playAudioBtn",3,"click",4,"ngIf"],[3,"innerHTML"],[1,"playAudioBtn",3,"click"],[1,"fas","fa-pause"],[1,"fa","fa-play"],[1,"btnContainer"],[1,"footerText"],[1,"changeSplitBtn","selectedBtn"],[1,"changeSplitBtn",3,"click"]],template:function(t,r){1&t&&(e._UZ(0,"img",0),e.TgZ(1,"div",1),e._UZ(2,"div",2),e.TgZ(3,"div",3)(4,"div",4)(5,"div",5),e.NdJ("click",function(){return r.goToDashboard()}),e._UZ(6,"i",6),e._uU(7),e.qZA(),e._UZ(8,"div"),e.qZA(),e.TgZ(9,"div",7)(10,"div",8),e._uU(11),e.qZA(),e.TgZ(12,"div")(13,"div",9),e.YNc(14,xn,4,1,"div",10),e.YNc(15,Mn,2,1,"div",11),e.qZA(),e.TgZ(16,"div",12),e.YNc(17,On,5,3,"div",13),e.qZA()()()()()),2&t&&(e.xp6(7),e.hij(" ",r.ts.l.story,""),e.xp6(4),e.hij(" ",r.ts.l.listen_and_correct," "),e.xp6(3),e.Q6J("ngIf",!r.audioFinishedLoading),e.xp6(1),e.Q6J("ngIf",r.audioFinishedLoading),e.xp6(2),e.Q6J("ngIf",r.audioFinishedLoading))},dependencies:[l.sg,l.O5,W.P,pt],styles:['.bookHeader[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.myStoriesBtn[_ngcontent-%COMP%]{display:inline;border-style:none;color:var(--dark-text);width:100px;font-size:12pt;padding-top:10px;padding-left:5%}.myStoriesBtn[_ngcontent-%COMP%]:hover{color:var(--scealai-orange);cursor:pointer;transition:color .5s}.storyContainer[_ngcontent-%COMP%]{margin-top:10px}.storyHeader[_ngcontent-%COMP%]{background-color:var(--scealai-green);color:#fff;border-radius:4px 4px 0 0;width:90%;margin-left:5%}.playAudioBtn[_ngcontent-%COMP%]{background-color:var(--scealai-green);color:#fff;border-radius:4px;border:none;margin-left:4px;font-size:10pt;padding:4px 8px}.playAudioBtn[_ngcontent-%COMP%]:hover{background-color:var(--scealai-med-green);transition:.5s}.footerText[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:12pt;margin-right:5px}.changeSplitBtn[_ngcontent-%COMP%]:hover, .selectedBtn[_ngcontent-%COMP%]{background-color:var(--scealai-med-green)}@media only screen and (max-width: 350px){.footerText[_ngcontent-%COMP%], .changeSplitBtn[_ngcontent-%COMP%]{font-size:10pt}}@media only screen and (max-width: 300px){.footerText[_ngcontent-%COMP%], .changeSplitBtn[_ngcontent-%COMP%]{font-size:8pt}}@media only screen and (max-width: 700px){.bookImg[_ngcontent-%COMP%]{display:none}.bookContainerSynth[_ngcontent-%COMP%]{width:90%;margin-left:5%}}@media only screen and (min-width: 700px){.bookImg[_ngcontent-%COMP%]{z-index:-10;width:630px;left:50%;margin-left:-315px}.bookContainerSynth[_ngcontent-%COMP%]{width:490px;position:fixed;left:50%;margin-left:-245px;margin-top:20px}}@media only screen and (min-width: 1000px) and (min-height: 750px){.bookImg[_ngcontent-%COMP%]{z-index:-10;width:800px;height:600px;left:50%;margin-left:-400px}.bookContainerSynth[_ngcontent-%COMP%]{width:620px;height:510px;position:fixed;left:50%;margin-left:-310px;margin-top:20px}.textContainerSynth[_ngcontent-%COMP%]{height:390px}}@media only screen and (min-width: 1400px) and (min-height: 900px){.bookImg[_ngcontent-%COMP%]{z-index:-10;width:1000px;height:740px;left:50%;margin-left:-500px}.bookContainerSynth[_ngcontent-%COMP%]{width:800px;height:600px;position:fixed;left:50%;margin-left:-400px;margin-top:30px}.textContainerSynth[_ngcontent-%COMP%]{height:480px}}@media only screen and (min-width: 1900px) and (min-height: 1000px){.bookImg[_ngcontent-%COMP%]{z-index:-10;width:1200px;height:850px;left:50%;margin-left:-600px}.bookContainerSynth[_ngcontent-%COMP%]{width:980px;height:730px;position:fixed;left:50%;margin-left:-490px;margin-top:30px}.textContainerSynth[_ngcontent-%COMP%]{height:610px}.myStoriesBtn[_ngcontent-%COMP%]{width:120px}}.paragraphContainer[_ngcontent-%COMP%]     .highlightable{position:relative}.paragraphContainer[_ngcontent-%COMP%]     .highlightable:before{content:"";height:22px;width:0%;background:var(--scealai-light-blue);position:absolute;transition:var(--trans)}.paragraphContainer[_ngcontent-%COMP%]     .highlight:before{width:100%}.paragraphContainer[_ngcontent-%COMP%]     .noHighlight:before{right:0;width:0%}.paragraphContainer[_ngcontent-%COMP%]     .wordBtn:hover{background:var(--scealai-light-blue-hover);cursor:pointer}']}),o})();class En{constructor(f,t=[],r=[],c=[],x=[],M=[],O=[]){this.paragraphAudioIds=t,this.paragraphIndices=r,this.paragraphTranscriptions=c,this.sentenceAudioIds=x,this.sentenceIndices=M,this.sentenceTranscriptions=O,this.storyData=f,this.date=new Date,this.archived=!1}}var In=n(2754);function Dn(o,f){1&o&&(e.TgZ(0,"span"),e._uU(1,"*"),e.qZA())}function Fn(o,f){if(1&o&&(e.TgZ(0,"div",16),e._uU(1),e._UZ(2,"i",17),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.ts.l.saved," ")}}function Bn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div",18),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.saveRecordings())}),e._uU(1),e._UZ(2,"i",19),e.qZA()}if(2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.ts.l.save," ")}}function Zn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div",8)(1,"div",9),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.goToDashboard())}),e._UZ(2,"i",10),e._uU(3),e.qZA(),e.TgZ(4,"div",11),e._uU(5),e.YNc(6,Dn,2,0,"span",12),e.qZA(),e.TgZ(7,"div",13),e.YNc(8,Fn,3,1,"div",14),e.YNc(9,Bn,3,1,"div",15),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(3),e.hij(" ",t.ts.l.story," "),e.xp6(2),e.hij(" ",null==t.story?null:t.story.title,""),e.xp6(1),e.Q6J("ngIf",!t.recordingSaved),e.xp6(2),e.Q6J("ngIf",t.recordingSaved),e.xp6(1),e.Q6J("ngIf",!t.recordingSaved)}}function Rn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div",20),e.NdJ("click",function(){e.CHM(t),e.oxw();const c=e.MAs(5);return e.KtG(c.toggle())}),e.TgZ(1,"mat-icon"),e._uU(2,"menu"),e.qZA(),e._uU(3),e.qZA()}if(2&o){const t=e.oxw();e.xp6(3),e.hij(" ",t.ts.l.archive," ")}}const Nn=function(o){return{"font-style":o}};function Ln(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"div",21),e.NdJ("click",function(){const x=e.CHM(t).$implicit,M=e.oxw();return e.KtG(M.setCurrentRecording(x))}),e.TgZ(2,"div",22)(3,"div",23),e._uU(4),e.qZA()(),e.TgZ(5,"div",24),e._uU(6),e.ALo(7,"date"),e.qZA()(),e._UZ(8,"hr"),e.qZA()}if(2&o){const t=f.$implicit;e.xp6(1),e.uIk("id",t._id),e.xp6(2),e.Q6J("ngStyle",e.VKq(7,Nn,t.archived?"none":"italic")),e.xp6(1),e.hij(" ",null==t||null==t.storyData?null:t.storyData.title,""),e.xp6(2),e.hij(" ",e.xi3(7,4,t.date,"d/M/yy, h:mm a")," ")}}function Un(o,f){if(1&o&&(e.TgZ(0,"div",30)(1,"b"),e._uU(2),e.qZA(),e._UZ(3,"grid-spinner"),e.qZA()),2&o){const t=e.oxw(2);e.xp6(2),e.Oqu(t.ts.l.synthesising)}}function jn(o,f){1&o&&(e._UZ(0,"span",42),e.ALo(1,"safeHtml")),2&o&&e.Q6J("innerHTML",e.lcZ(1,1,f.$implicit.outerHTML),e.oJD)}function Hn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(t);const c=e.oxw().$implicit,x=e.oxw(3);return e.KtG(x.stopSection(c))}),e._UZ(1,"i",44),e.qZA()}}function Gn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(t);const c=e.oxw().$implicit,x=e.oxw(3);return e.KtG(x.playSection(c))}),e._UZ(1,"i",45),e.qZA()}}function Jn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"button",46),e.NdJ("click",function(){e.CHM(t);const c=e.oxw().index,x=e.oxw(3);return e.KtG(x.recordAudio(c))}),e._UZ(1,"i",47),e.qZA()}}function Yn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"button",48),e.NdJ("click",function(){e.CHM(t);const c=e.oxw().index,x=e.oxw(3);return e.KtG(x.stopRecording(c))}),e._UZ(1,"i",49),e.qZA()}}function zn(o,f){1&o&&e._UZ(0,"hr",50)}function qn(o,f){1&o&&(e.TgZ(0,"div",51),e._UZ(1,"div",52),e.qZA())}function Qn(o,f){if(1&o&&(e.TgZ(0,"div",53)(1,"span",54),e._uU(2),e.qZA(),e.TgZ(3,"span",55),e._uU(4),e.qZA()()),2&o){const t=e.oxw().index,r=e.oxw(3);e.xp6(2),e.hij("",r.ts.l.speech_recognition_output," "),e.xp6(2),e.Oqu(r.sectionTranscriptions[t])}}function Wn(o,f){if(1&o&&e._UZ(0,"audio",59,60),2&o){const t=e.oxw(2).index,r=e.oxw(3);e.uIk("src",r.sectionAudioSources[t],e.LSH)}}function Vn(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"button",61),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2).index,x=e.oxw(3);return e.KtG(x.deleteRecording(c))}),e._UZ(1,"i",62),e.qZA()}}function Kn(o,f){if(1&o&&(e.TgZ(0,"div",56)(1,"div",54),e._uU(2),e.qZA(),e.YNc(3,Wn,2,1,"audio",57),e.YNc(4,Vn,2,0,"button",58),e.qZA()),2&o){const t=e.oxw().index,r=e.oxw(3);e.xp6(2),e.Oqu(r.ts.l.your_recording),e.xp6(1),e.Q6J("ngIf",r.sectionAudioSources[t]),e.xp6(1),e.Q6J("ngIf",r.sectionAudioSources[t]&&!r.currentRecording.archived)}}function $n(o,f){if(1&o&&(e.TgZ(0,"div",32)(1,"div",33)(2,"div"),e.YNc(3,jn,2,3,"span",34),e.YNc(4,Hn,2,0,"button",35),e.YNc(5,Gn,2,0,"button",35),e.YNc(6,Jn,2,0,"button",36),e.YNc(7,Yn,2,0,"button",37),e.qZA(),e.YNc(8,zn,1,0,"hr",38),e.YNc(9,qn,2,0,"div",39),e.YNc(10,Qn,5,2,"div",40),e.YNc(11,Kn,5,3,"div",41),e.qZA()()),2&o){const t=f.$implicit,r=f.index,c=e.oxw(3);e.xp6(3),e.Q6J("ngForOf",t.spans),e.xp6(1),e.Q6J("ngIf",!t.audio.paused),e.xp6(1),e.Q6J("ngIf",t.audio.paused),e.xp6(1),e.Q6J("ngIf",!c.isRecording(t,r)&&!c.currentRecording.archived),e.xp6(1),e.Q6J("ngIf",c.isRecording(t,r)&&!c.currentRecording.archived),e.xp6(1),e.Q6J("ngIf",c.sectionAudioSources[r]),e.xp6(1),e.Q6J("ngIf",c.isTranscribing[r]),e.xp6(1),e.Q6J("ngIf",c.sectionTranscriptions[r]),e.xp6(1),e.Q6J("ngIf",c.sectionAudioSources[r])}}function Xn(o,f){if(1&o&&(e.TgZ(0,"div"),e.YNc(1,$n,12,9,"div",31),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.chosenSections)}}function er(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"button",67),e._uU(2),e.qZA(),e.TgZ(3,"button",68),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(3);return e.KtG(c.changeSections(c.sentences))}),e._uU(4),e.qZA()()}if(2&o){const t=e.oxw(3);e.xp6(2),e.hij(" ",t.ts.l.paragraph," "),e.xp6(2),e.hij(" ",t.ts.l.sentence," ")}}function tr(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"button",68),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(3);return e.KtG(c.changeSections(c.paragraphs))}),e._uU(2),e.qZA(),e.TgZ(3,"button",67),e._uU(4),e.qZA()()}if(2&o){const t=e.oxw(3);e.xp6(2),e.hij(" ",t.ts.l.paragraph," "),e.xp6(2),e.hij(" ",t.ts.l.sentence," ")}}function nr(o,f){if(1&o){const t=e.EpF();e.TgZ(0,"button",69),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(3);return e.KtG(c.archiveRecording())}),e._uU(1),e.qZA()}if(2&o){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.ts.l.archive_recording," ")}}function rr(o,f){if(1&o&&(e.TgZ(0,"div",63)(1,"div",64)(2,"div",65),e._uU(3),e.qZA(),e.YNc(4,er,5,2,"div",12),e.YNc(5,tr,5,2,"div",12),e.YNc(6,nr,2,1,"button",66),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(3),e.hij(" ",t.ts.l.listen_by," "),e.xp6(1),e.Q6J("ngIf",t.isParagraphMode()),e.xp6(1),e.Q6J("ngIf",t.isSentenceMode()),e.xp6(1),e.Q6J("ngIf",!t.currentRecording.archived&&t.currentRecording.storyData.text!=t.story.text)}}function or(o,f){if(1&o&&(e.TgZ(0,"div",25)(1,"div",26),e._uU(2),e.qZA(),e.TgZ(3,"div",27),e.YNc(4,Un,4,1,"div",28),e.YNc(5,Xn,2,1,"div",12),e.qZA(),e.YNc(6,rr,7,4,"div",29),e.qZA()),2&o){const t=e.oxw();e.xp6(2),e.hij(" ",t.ts.l.listen_record_compare," "),e.xp6(2),e.Q6J("ngIf",!t.audioFinishedLoading&&!t.recordingsFinishedLoading),e.xp6(1),e.Q6J("ngIf",t.audioFinishedLoading),e.xp6(1),e.Q6J("ngIf",t.audioFinishedLoading)}}const ar=[{path:"",pathMatch:"full",redirectTo:"dashboard"},{path:"contents",component:De,canActivate:[a.P]},{path:"dashboard",component:yn,canActivate:[a.P],canDeactivate:[d]},{path:"synthesis/:id",component:Pn,canActivate:[a.P],canDeactivate:[m]},{path:"record-story/:id",component:(()=>{class o{constructor(t,r,c,x,M,O,E,U,I){this.storyService=t,this.ts=r,this.sanitizer=c,this.route=x,this.router=M,this.recordingService=O,this.synthesis=E,this.engagement=U,this.dialog=I,this.story=new b,this.paragraphs=[],this.sentences=[],this.isRecordingParagraph=[],this.isRecordingSentence=[],this.isRecordingSection=[],this.paragraphAudioSources=[],this.sentenceAudioSources=[],this.sectionAudioSources=[],this.paragraphBlobs=[],this.sentenceBlobs=[],this.sectionBlobs=[],this.paragraphChunks=[],this.sentenceChunks=[],this.sectionChunks=[],this.recordingSaved=!0,this.audioFinishedLoading=!1,this.url_ASR_API="https://phoneticsrv3.lcs.tcd.ie/asr_api/recognise",this.sentenceTranscriptions=[],this.paragraphTranscriptions=[],this.sectionTranscriptions=[],this.isTranscribing=[!1],this.recordings=[],this.currentRecording=null,this.lastClickedRecordingId=""}ngOnInit(){var t=this;return(0,h.Z)(function*(){t.chunks=[],t.sectionAudioSources=t.paragraphAudioSources,t.sectionBlobs=t.paragraphBlobs,t.sectionChunks=t.paragraphChunks,t.sectionTranscriptions=t.paragraphTranscriptions,t.isRecordingSection=t.isRecordingParagraph;const r=t.route.snapshot.paramMap.get("id");t.story=yield(0,B.z)(t.storyService.getStory(r)),(0,In.TD)({audio:!0,video:!1}).then((0,h.Z)(function*(){t.story.activeRecording?t.loadRecordings():t.createNewRecording()})).catch(c=>{t.openMicRequestDialog()})})()}loadRecordings(){var t=this;return(0,h.Z)(function*(){t.recordings=yield(0,B.z)(t.recordingService.getRecordings(t.story._id)),t.recordings.sort((c,x)=>c.date>x.date?-1:1);let r=t.recordings.filter(c=>!1===c.archived);t.setCurrentRecording(r[0])})()}setCurrentRecording(t){this.currentRecording=t,this.loadSynthesis(this.currentRecording.storyData),this.loadAudio(this.currentRecording);let r=this.currentRecording._id,c=document.getElementById(r);c&&(this.lastClickedRecordingId&&document.getElementById(this.lastClickedRecordingId).classList.remove("clickedresultCard"),this.lastClickedRecordingId=r,c.classList.add("clickedresultCard"))}createNewRecording(){var t=this;return(0,h.Z)(function*(){const r=yield(0,B.z)(t.recordingService.create(new En(t.story)));t.story=yield(0,B.z)(t.storyService.updateActiveRecording(t.story._id,r._id)),t.loadRecordings()})()}archiveRecording(){var t=this;return(0,h.Z)(function*(){yield(0,B.z)(t.recordingService.updateArchiveStatus(t.currentRecording._id)),t.createNewRecording()})()}loadSynthesis(t){this.synthesis.synthesiseStory(t).then(([r,c])=>{this.paragraphs=r,this.sentences=c,this.chosenSections=this.paragraphs,this.audioFinishedLoading=!0})}loadAudio(t){var r=this;return(0,h.Z)(function*(){r.audioFinishedLoading=!1,r.paragraphAudioSources=[],r.paragraphTranscriptions=[],r.sentenceAudioSources=[],r.sentenceTranscriptions=[],r.sectionAudioSources=[],r.sectionTranscriptions=[];for(let c=0;c<t.paragraphIndices.length;++c){let x=yield(0,B.z)(r.recordingService.getAudio(t.paragraphAudioIds[c]));r.paragraphBlobs[c]=x,r.paragraphAudioSources[t.paragraphIndices[c]]=r.sanitizer.bypassSecurityTrustUrl(URL.createObjectURL(x)),r.paragraphTranscriptions[t.paragraphIndices[c]]=t.paragraphTranscriptions[t.paragraphIndices[c]]}for(let c=0;c<t.sentenceIndices.length;++c){let x=yield(0,B.z)(r.recordingService.getAudio(t.sentenceAudioIds[c]));r.sentenceBlobs[c]=x,r.sentenceAudioSources[t.sentenceIndices[c]]=r.sanitizer.bypassSecurityTrustUrl(URL.createObjectURL(x)),r.sentenceTranscriptions[t.sentenceIndices[c]]=t.sentenceTranscriptions[t.sentenceIndices[c]]}r.sectionTranscriptions=r.paragraphTranscriptions,r.sectionAudioSources=r.paragraphAudioSources})()}recordAudio(t){this.engagement.addEventForLoggedInUser(T.tw["RECORD-STORY"],this.story),navigator.mediaDevices.getUserMedia({audio:!0}).then(c=>{this.stream=c,this.recorder=new MediaRecorder(this.stream),this.sectionChunks[t]=[],this.recorder.start(),this.isRecordingSection[t]=!0,this.recorder.ondataavailable=x=>{this.sectionChunks[t].push(x.data)}}).catch()}stopRecording(t){this.recorder.stop(),this.isRecordingSection[t]=!1,this.stream.getTracks().forEach(r=>r.stop()),setTimeout(()=>{const r=new Blob(this.sectionChunks[t],{type:"audio/mp3"});this.sectionBlobs[t]=r,this.sectionAudioSources[t]=this.sanitizer.bypassSecurityTrustUrl(URL.createObjectURL(r)),this.recordingSaved=!1;const c=new FileReader;c.readAsDataURL(r),c.onloadend=function(){let x=c.result.split(";base64,")[1];this.getTranscription(x,t)}.bind(this)},500)}getTranscription(t,r){this.isTranscribing[r]=!0,this.isParagraphMode()&&(this.paragraphTranscriptions[r]=null),this.isSentenceMode()&&(this.sentenceTranscriptions[r]=null),fetch(this.url_ASR_API,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({recogniseBlob:t,developer:!0})}).then(x=>x.json()).then(x=>{let M=x.transcriptions[0].utterance;this.isParagraphMode()?(this.paragraphTranscriptions[r]=M,this.sectionTranscriptions[r]=this.paragraphTranscriptions[r]):this.isSentenceMode()&&(this.sentenceTranscriptions[r]=M,this.sectionTranscriptions[r]=this.sentenceTranscriptions[r]),this.isTranscribing[r]=!1})}deleteRecording(t){this.recordingSaved=!1,delete this.sectionAudioSources[t],delete this.sectionChunks[t],delete this.sectionBlobs[t],delete this.sectionTranscriptions[t]}saveRecordings(){var t=this;return(0,h.Z)(function*(){const r=Object.entries(t.paragraphBlobs).map(function(){var q=(0,h.Z)(function*([se,ce]){return t.recordingService.saveAudio(t.story._id,ce,se).toPromise()});return function(se){return q.apply(this,arguments)}}()),c=Object.entries(t.sentenceBlobs).map(function(){var q=(0,h.Z)(function*([se,ce]){return t.recordingService.saveAudio(t.story._id,ce,se).toPromise()});return function(se){return q.apply(this,arguments)}}()),x=yield Promise.all(r),M=yield Promise.all(c);let O=[],E=[];for(const q of x)O.push(q.index),E.push(q.fileId);let U=[],I=[];for(const q of M)U.push(q.index),I.push(q.fileId);const j={paragraphAudioIds:E,paragraphIndices:O,paragraphTranscriptions:t.paragraphTranscriptions,sentenceIndices:U,sentenceAudioIds:I,sentenceTranscriptions:t.sentenceTranscriptions};let z=yield(0,B.z)(t.recordingService.update(t.story.activeRecording,j));if(z){t.recordingSaved=!0;const q=t.recordings.indexOf(t.currentRecording);t.recordings.splice(q,1,z)}else alert("Error while saving audio")})()}isRecording(t,r){return t instanceof ae.cj?this.isRecordingSentence[r]:t instanceof ae.nv?this.isRecordingParagraph[r]:void 0}isSentenceMode(){return this.chosenSections[0]instanceof ae.cj}isParagraphMode(){return this.chosenSections[0]instanceof ae.nv}changeSections(t){this.chosenSections=t,this.paragraphs.concat(this.sentences).forEach(c=>this.stopSection(c)),this.isSentenceMode()?(this.sectionAudioSources=this.sentenceAudioSources,this.sectionBlobs=this.sentenceBlobs,this.sectionChunks=this.sentenceChunks,this.sectionTranscriptions=this.sentenceTranscriptions,this.isRecordingSection=this.isRecordingSentence):this.isParagraphMode()&&(this.sectionAudioSources=this.paragraphAudioSources,this.sectionBlobs=this.paragraphBlobs,this.sectionChunks=this.paragraphChunks,this.sectionTranscriptions=this.paragraphTranscriptions,this.isRecordingSection=this.isRecordingParagraph)}playSection(t){t.play(),t.highlight()}stopSection(t){t.stop(),t.removeHighlight()}goToDashboard(){this.router.navigateByUrl("student/dashboard")}openMicRequestDialog(){var t=this;this.dialogRef=this.dialog.open(u.p,{data:{title:this.ts.l.microphone_blocked,message:this.ts.l.page_requires_microphone,confirmText:this.ts.l.refresh,cancelText:this.ts.l.cancel},width:"50vh"}),this.dialogRef.afterClosed().subscribe(function(){var r=(0,h.Z)(function*(c){t.dialogRef=void 0,console.log(c),c?t.ngOnInit():t.goToDashboard()});return function(c){return r.apply(this,arguments)}}())}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(_.N),e.Y36(g.D),e.Y36(ke.H7),e.Y36(s.gz),e.Y36(s.F0),e.Y36(H.s),e.Y36(ae.cf),e.Y36(A.M),e.Y36(i.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-recording"]],decls:8,vars:4,consts:[[1,"content"],["class","recordingBookHeader",4,"ngIf"],["class","archiveButton",3,"click",4,"ngIf"],["autosize","",1,"archiveNavContainer"],["mode","side",1,"sidenav"],["drawer",""],[4,"ngFor","ngForOf"],["class","recordingStoryContainer",4,"ngIf"],[1,"recordingBookHeader"],[1,"myStoriesBtn",3,"click"],[1,"fa","fa-chevron-left"],[1,"bookTitle"],[4,"ngIf"],[1,"recordingSaveIcon"],["class","recordingSavedIcon",4,"ngIf"],["class","recordingUnsavedIcon",3,"click",4,"ngIf"],[1,"recordingSavedIcon"],[1,"fas","fa-check"],[1,"recordingUnsavedIcon",3,"click"],[1,"fas","fa-save"],[1,"archiveButton",3,"click"],[1,"contentSection",3,"click"],[1,"contentsLink"],[3,"ngStyle"],[1,"contentsDate"],[1,"recordingStoryContainer"],[1,"recordingStoryHeader"],[1,"textContainerSynth"],["class","loaderContainer",4,"ngIf"],["class","footer","style","padding-top: 10px",4,"ngIf"],[1,"loaderContainer"],["class","paragraphContainer",4,"ngFor","ngForOf"],[1,"paragraphContainer"],[1,"textCard"],[3,"innerHTML",4,"ngFor","ngForOf"],["class","playAudioBtn",3,"click",4,"ngIf"],["class","recordingBtn",3,"click",4,"ngIf"],["class","notRecordingBtn blink",3,"click",4,"ngIf"],["class","dividerLine",4,"ngIf"],["class","recognisedSpeechContainer",4,"ngIf"],["style","height: 40px",4,"ngIf"],["class","audioContainer",4,"ngIf"],[3,"innerHTML"],[1,"playAudioBtn",3,"click"],[1,"fas","fa-pause"],[1,"fa","fa-play"],[1,"recordingBtn",3,"click"],[1,"fas","fa-microphone"],[1,"notRecordingBtn","blink",3,"click"],[1,"fas","fa-stop-circle"],[1,"dividerLine"],[1,"recognisedSpeechContainer"],[1,"dot-flashing"],[2,"height","40px"],[2,"opacity","0.5"],[1,"recognisedSpeech"],[1,"audioContainer"],["controls","","class","audioPlayer",4,"ngIf"],["class","notRecordingBtn trashBtn",3,"click",4,"ngIf"],["controls","",1,"audioPlayer"],["audioTag",""],[1,"notRecordingBtn","trashBtn",3,"click"],[1,"fas","fa-trash-alt"],[1,"footer",2,"padding-top","10px"],[1,"btnContainer"],[1,"footerText"],["class","changeSplitBtn","style","margin-left: auto",3,"click",4,"ngIf"],[1,"changeSplitBtn","selectedBtn"],[1,"changeSplitBtn",3,"click"],[1,"changeSplitBtn",2,"margin-left","auto",3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Zn,10,5,"div",1),e.YNc(2,Rn,4,1,"div",2),e.TgZ(3,"mat-drawer-container",3)(4,"mat-drawer",4,5),e.YNc(6,Ln,9,9,"div",6),e.qZA(),e.YNc(7,or,7,4,"div",7),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("ngIf",r.story),e.xp6(1),e.Q6J("ngIf",r.recordings.length>0),e.xp6(4),e.Q6J("ngForOf",r.recordings),e.xp6(1),e.Q6J("ngIf",r.story))},dependencies:[l.sg,l.O5,l.PC,W.P,Ke,$e,Me.Hw,l.uU,pt],styles:['.content[_ngcontent-%COMP%]{width:90%;margin-left:5%;box-shadow:0 0 11px 2px #0006;border-radius:5px;border:solid 2px rgba(130,118,98,.7215686275)}.archiveNavContainer[_ngcontent-%COMP%]{height:70vh;background-color:#fff}.sidenav[_ngcontent-%COMP%]{padding:20px;width:20vw}.archiveButton[_ngcontent-%COMP%]{display:flex;margin-left:10px;margin-top:20px;font-size:16px}.archiveButton[_ngcontent-%COMP%]:hover, .contentSection[_ngcontent-%COMP%]:hover{cursor:pointer}.contentsLink[_ngcontent-%COMP%]{color:var(--dark-text);text-align:left;width:50%;text-decoration:none}.contentsLink[_ngcontent-%COMP%]:hover{text-decoration:underline;cursor:pointer}.recordingStoryContainer[_ngcontent-%COMP%]{margin-top:20px;height:80%}.textContainerSynth[_ngcontent-%COMP%]{box-shadow:0 0 11px 2px #0006;margin-left:5%;width:90%;color:var(--dark-text);background-color:#f8f9fa;text-align:left;overflow:auto;height:100%}.recordingBookHeader[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.myStoriesBtn[_ngcontent-%COMP%]{white-space:nowrap;display:inline;border-style:none;color:var(--dark-text);width:10rem;font-size:12pt;padding-top:10px}.myStoriesBtn[_ngcontent-%COMP%]:hover{color:var(--scealai-orange);cursor:pointer;transition:color .5s}.bookTitle[_ngcontent-%COMP%]{overflow:auto;color:var(--dark-text);margin-left:2em;margin-right:2em;display:inline-block;font-size:16pt}.recordingSaveIcon[_ngcontent-%COMP%]{width:10rem;color:var(--dark-text);border-style:none;font-size:11pt;padding-top:15px}.recordingSavedIcon[_ngcontent-%COMP%]{white-space:nowrap;color:var(--scealai-light-brown)}.recordingUnsavedIcon[_ngcontent-%COMP%]{background-color:var(--scealai-green);padding-left:6px;padding-right:6px;border-radius:5px;margin-top:-5px;color:#fff}.recordingUnsavedIcon[_ngcontent-%COMP%]:hover{background-color:var(--scealai-med-green);cursor:pointer;transition:.5s}.clickedresultCard[_ngcontent-%COMP%]{background-color:#eee;padding:10px;font-weight:700;border-radius:10px}.textCard[_ngcontent-%COMP%]{background-color:#fff;padding:10px;margin-top:5px;margin-bottom:10px;border-radius:5px;box-shadow:0 0 5px 3px #00000038}.playAudioBtn[_ngcontent-%COMP%]{background-color:var(--scealai-green);color:#fff;border-radius:4px;border:none;margin-left:4px;font-size:10pt;padding:4px 8px;float:right}.playAudioBtn[_ngcontent-%COMP%]:hover{background-color:var(--scealai-med-green);transition:.5s}.recordingBtn[_ngcontent-%COMP%]{background-color:var(--scealai-green);color:#fff;border-radius:4px;border:none;margin-left:4px;font-size:10pt;padding:4px 10px;float:right}.recordingBtn[_ngcontent-%COMP%]:hover{background-color:var(--scealai-med-green);transition:.5s}.notRecordingBtn[_ngcontent-%COMP%]{background-color:red;color:#fff;border-radius:4px;border:none;margin-left:4px;font-size:10pt;padding:4px 8px;float:right}.recognisedSpeech[_ngcontent-%COMP%]{color:var(--scealai-green);font-style:italic;padding-left:5px}.audioContainer[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;flex-wrap:wrap}.audioPlayer[_ngcontent-%COMP%]{width:25%;height:35px}.trashBtn[_ngcontent-%COMP%]{background-color:#be0a0a;font-size:12pt;padding-top:2px;padding-bottom:2px}.trashBtn[_ngcontent-%COMP%]:hover{background-color:#770505}.footerText[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:12pt;margin-right:5px}.changeSplitBtn[_ngcontent-%COMP%]{font-size:10pt}.selectedBtn[_ngcontent-%COMP%]{background-color:var(--scealai-med-green)}.blink[_ngcontent-%COMP%]{animation:blinker 2s linear infinite}@keyframes blinker{0%{background-color:red}50%{background-color:#700}to{background-color:red}}@media only screen and (max-width: 350px){.footerText[_ngcontent-%COMP%], .changeSplitBtn[_ngcontent-%COMP%]{font-size:10pt}}@media only screen and (max-width: 300px){.footerText[_ngcontent-%COMP%], .changeSplitBtn[_ngcontent-%COMP%]{font-size:8pt}}.paragraphContainer[_ngcontent-%COMP%]     .highlightable{position:relative}.paragraphContainer[_ngcontent-%COMP%]     .highlightable:before{content:"";height:22px;width:0%;background:var(--scealai-light-blue);position:absolute;transition:var(--trans)}.paragraphContainer[_ngcontent-%COMP%]     .highlight:before{width:100%}.paragraphContainer[_ngcontent-%COMP%]     .noHighlight:before{right:0;width:0%}.paragraphContainer[_ngcontent-%COMP%]     .wordBtn:hover{background:var(--scealai-light-blue-hover);cursor:pointer}.sentenceContainer[_ngcontent-%COMP%]     .wordBtn:hover{background:var(--scealai-light-blue-hover);cursor:pointer}']}),o})(),canActivate:[a.P],canDeactivate:[w]}];let sr=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[s.Bz.forChild(ar),s.Bz]}),o})();var cr=n(3869),dr=n(4385);let lr=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[l.ez,sr,dr.LD,Z.u5,cr.F,Bt,ut.ot,Me.Ps,lt.fi.forRoot({customOptions:[{import:"formats/font",whitelist:["sans-serif","serif","monospace","arial","times-new-roman"]}]})]}),o})()},7230:function(p){p.exports=function(v){var n={};function l(s){if(n[s])return n[s].exports;var a=n[s]={i:s,l:!1,exports:{}};return v[s].call(a.exports,a,a.exports,l),a.l=!0,a.exports}return l.m=v,l.c=n,l.d=function(s,a,u){l.o(s,a)||Object.defineProperty(s,a,{enumerable:!0,get:u})},l.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},l.t=function(s,a){if(1&a&&(s=l(s)),8&a||4&a&&"object"==typeof s&&s&&s.__esModule)return s;var u=Object.create(null);if(l.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:s}),2&a&&"string"!=typeof s)for(var g in s)l.d(u,g,function(e){return s[e]}.bind(null,g));return u},l.n=function(s){var a=s&&s.__esModule?function(){return s.default}:function(){return s};return l.d(a,"a",a),a},l.o=function(s,a){return Object.prototype.hasOwnProperty.call(s,a)},l.p="",l(l.s=90)}({17:function(v,n,l){"use strict";n.__esModule=!0,n.default=void 0;var s=l(18),a=function(){function u(){}return u.getFirstMatch=function(g,e){var i=e.match(g);return i&&i.length>0&&i[1]||""},u.getSecondMatch=function(g,e){var i=e.match(g);return i&&i.length>1&&i[2]||""},u.matchAndReturnConst=function(g,e,i){if(g.test(e))return i},u.getWindowsVersionName=function(g){switch(g){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},u.getMacOSVersionName=function(g){var e=g.split(".").splice(0,2).map(function(i){return parseInt(i,10)||0});if(e.push(0),10===e[0])switch(e[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},u.getAndroidVersionName=function(g){var e=g.split(".").splice(0,2).map(function(i){return parseInt(i,10)||0});if(e.push(0),!(1===e[0]&&e[1]<5))return 1===e[0]&&e[1]<6?"Cupcake":1===e[0]&&e[1]>=6?"Donut":2===e[0]&&e[1]<2?"Eclair":2===e[0]&&2===e[1]?"Froyo":2===e[0]&&e[1]>2?"Gingerbread":3===e[0]?"Honeycomb":4===e[0]&&e[1]<1?"Ice Cream Sandwich":4===e[0]&&e[1]<4?"Jelly Bean":4===e[0]&&e[1]>=4?"KitKat":5===e[0]?"Lollipop":6===e[0]?"Marshmallow":7===e[0]?"Nougat":8===e[0]?"Oreo":9===e[0]?"Pie":void 0},u.getVersionPrecision=function(g){return g.split(".").length},u.compareVersions=function(g,e,i){void 0===i&&(i=!1);var d=u.getVersionPrecision(g),w=u.getVersionPrecision(e),m=Math.max(d,w),h=0,y=u.map([g,e],function(b){var _=m-u.getVersionPrecision(b),C=b+new Array(_+1).join(".0");return u.map(C.split("."),function(T){return new Array(20-T.length).join("0")+T}).reverse()});for(i&&(h=m-Math.min(d,w)),m-=1;m>=h;){if(y[0][m]>y[1][m])return 1;if(y[0][m]===y[1][m]){if(m===h)return 0;m-=1}else if(y[0][m]<y[1][m])return-1}},u.map=function(g,e){var i,d=[];if(Array.prototype.map)return Array.prototype.map.call(g,e);for(i=0;i<g.length;i+=1)d.push(e(g[i]));return d},u.find=function(g,e){var i,d;if(Array.prototype.find)return Array.prototype.find.call(g,e);for(i=0,d=g.length;i<d;i+=1){var w=g[i];if(e(w,i))return w}},u.assign=function(g){for(var e,i,d=g,w=arguments.length,m=new Array(w>1?w-1:0),h=1;h<w;h++)m[h-1]=arguments[h];if(Object.assign)return Object.assign.apply(Object,[g].concat(m));var y=function(){var b=m[e];"object"==typeof b&&null!==b&&Object.keys(b).forEach(function(_){d[_]=b[_]})};for(e=0,i=m.length;e<i;e+=1)y();return g},u.getBrowserAlias=function(g){return s.BROWSER_ALIASES_MAP[g]},u.getBrowserTypeByAlias=function(g){return s.BROWSER_MAP[g]||""},u}();n.default=a,v.exports=n.default},18:function(v,n,l){"use strict";n.__esModule=!0,n.ENGINE_MAP=n.OS_MAP=n.PLATFORMS_MAP=n.BROWSER_MAP=n.BROWSER_ALIASES_MAP=void 0,n.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},n.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},n.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},n.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},n.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(v,n,l){"use strict";n.__esModule=!0,n.default=void 0;var s,a=(s=l(91))&&s.__esModule?s:{default:s},u=l(18);function g(i,d){for(var w=0;w<d.length;w++){var m=d[w];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(i,m.key,m)}}var e=function(){function i(){}var d,m;return i.getParser=function(h,y){if(void 0===y&&(y=!1),"string"!=typeof h)throw new Error("UserAgent should be a string");return new a.default(h,y)},i.parse=function(h){return new a.default(h).getResult()},d=i,m=[{key:"BROWSER_MAP",get:function(){return u.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return u.ENGINE_MAP}},{key:"OS_MAP",get:function(){return u.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return u.PLATFORMS_MAP}}],null&&g(d.prototype,null),m&&g(d,m),i}();n.default=e,v.exports=n.default},91:function(v,n,l){"use strict";n.__esModule=!0,n.default=void 0;var s=i(l(92)),a=i(l(93)),u=i(l(94)),g=i(l(95)),e=i(l(17));function i(w){return w&&w.__esModule?w:{default:w}}var d=function(){function w(h,y){if(void 0===y&&(y=!1),null==h||""===h)throw new Error("UserAgent parameter can't be empty");this._ua=h,this.parsedResult={},!0!==y&&this.parse()}var m=w.prototype;return m.getUA=function(){return this._ua},m.test=function(h){return h.test(this._ua)},m.parseBrowser=function(){var h=this;this.parsedResult.browser={};var y=e.default.find(s.default,function(b){if("function"==typeof b.test)return b.test(h);if(b.test instanceof Array)return b.test.some(function(_){return h.test(_)});throw new Error("Browser's test function is not valid")});return y&&(this.parsedResult.browser=y.describe(this.getUA())),this.parsedResult.browser},m.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},m.getBrowserName=function(h){return h?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},m.getBrowserVersion=function(){return this.getBrowser().version},m.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},m.parseOS=function(){var h=this;this.parsedResult.os={};var y=e.default.find(a.default,function(b){if("function"==typeof b.test)return b.test(h);if(b.test instanceof Array)return b.test.some(function(_){return h.test(_)});throw new Error("Browser's test function is not valid")});return y&&(this.parsedResult.os=y.describe(this.getUA())),this.parsedResult.os},m.getOSName=function(h){var y=this.getOS().name;return h?String(y).toLowerCase()||"":y||""},m.getOSVersion=function(){return this.getOS().version},m.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},m.getPlatformType=function(h){void 0===h&&(h=!1);var y=this.getPlatform().type;return h?String(y).toLowerCase()||"":y||""},m.parsePlatform=function(){var h=this;this.parsedResult.platform={};var y=e.default.find(u.default,function(b){if("function"==typeof b.test)return b.test(h);if(b.test instanceof Array)return b.test.some(function(_){return h.test(_)});throw new Error("Browser's test function is not valid")});return y&&(this.parsedResult.platform=y.describe(this.getUA())),this.parsedResult.platform},m.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},m.getEngineName=function(h){return h?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},m.parseEngine=function(){var h=this;this.parsedResult.engine={};var y=e.default.find(g.default,function(b){if("function"==typeof b.test)return b.test(h);if(b.test instanceof Array)return b.test.some(function(_){return h.test(_)});throw new Error("Browser's test function is not valid")});return y&&(this.parsedResult.engine=y.describe(this.getUA())),this.parsedResult.engine},m.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},m.getResult=function(){return e.default.assign({},this.parsedResult)},m.satisfies=function(h){var y=this,b={},_=0,C={},T=0;if(Object.keys(h).forEach(function(L){var B=h[L];"string"==typeof B?(C[L]=B,T+=1):"object"==typeof B&&(b[L]=B,_+=1)}),_>0){var A=Object.keys(b),P=e.default.find(A,function(L){return y.isOS(L)});if(P){var S=this.satisfies(b[P]);if(void 0!==S)return S}var k=e.default.find(A,function(L){return y.isPlatform(L)});if(k){var N=this.satisfies(b[k]);if(void 0!==N)return N}}if(T>0){var H=Object.keys(C),G=e.default.find(H,function(L){return y.isBrowser(L,!0)});if(void 0!==G)return this.compareVersion(C[G])}},m.isBrowser=function(h,y){void 0===y&&(y=!1);var b=this.getBrowserName().toLowerCase(),_=h.toLowerCase(),C=e.default.getBrowserTypeByAlias(_);return y&&C&&(_=C.toLowerCase()),_===b},m.compareVersion=function(h){var y=[0],b=h,_=!1,C=this.getBrowserVersion();if("string"==typeof C)return">"===h[0]||"<"===h[0]?(b=h.substr(1),"="===h[1]?(_=!0,b=h.substr(2)):y=[],y.push(">"===h[0]?1:-1)):"="===h[0]?b=h.substr(1):"~"===h[0]&&(_=!0,b=h.substr(1)),y.indexOf(e.default.compareVersions(C,b,_))>-1},m.isOS=function(h){return this.getOSName(!0)===String(h).toLowerCase()},m.isPlatform=function(h){return this.getPlatformType(!0)===String(h).toLowerCase()},m.isEngine=function(h){return this.getEngineName(!0)===String(h).toLowerCase()},m.is=function(h,y){return void 0===y&&(y=!1),this.isBrowser(h,y)||this.isOS(h)||this.isPlatform(h)},m.some=function(h){var y=this;return void 0===h&&(h=[]),h.some(function(b){return y.is(b)})},w}();n.default=d,v.exports=n.default},92:function(v,n,l){"use strict";n.__esModule=!0,n.default=void 0;var s,a=(s=l(17))&&s.__esModule?s:{default:s},u=/version\/(\d+(\.?_?\d+)+)/i;n.default=[{test:[/googlebot/i],describe:function(e){var i={name:"Googlebot"},d=a.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||a.default.getFirstMatch(u,e);return d&&(i.version=d),i}},{test:[/opera/i],describe:function(e){var i={name:"Opera"},d=a.default.getFirstMatch(u,e)||a.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/opr\/|opios/i],describe:function(e){var i={name:"Opera"},d=a.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||a.default.getFirstMatch(u,e);return d&&(i.version=d),i}},{test:[/SamsungBrowser/i],describe:function(e){var i={name:"Samsung Internet for Android"},d=a.default.getFirstMatch(u,e)||a.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/Whale/i],describe:function(e){var i={name:"NAVER Whale Browser"},d=a.default.getFirstMatch(u,e)||a.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/MZBrowser/i],describe:function(e){var i={name:"MZ Browser"},d=a.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||a.default.getFirstMatch(u,e);return d&&(i.version=d),i}},{test:[/focus/i],describe:function(e){var i={name:"Focus"},d=a.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||a.default.getFirstMatch(u,e);return d&&(i.version=d),i}},{test:[/swing/i],describe:function(e){var i={name:"Swing"},d=a.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||a.default.getFirstMatch(u,e);return d&&(i.version=d),i}},{test:[/coast/i],describe:function(e){var i={name:"Opera Coast"},d=a.default.getFirstMatch(u,e)||a.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var i={name:"Opera Touch"},d=a.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(u,e);return d&&(i.version=d),i}},{test:[/yabrowser/i],describe:function(e){var i={name:"Yandex Browser"},d=a.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(u,e);return d&&(i.version=d),i}},{test:[/ucbrowser/i],describe:function(e){var i={name:"UC Browser"},d=a.default.getFirstMatch(u,e)||a.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/Maxthon|mxios/i],describe:function(e){var i={name:"Maxthon"},d=a.default.getFirstMatch(u,e)||a.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/epiphany/i],describe:function(e){var i={name:"Epiphany"},d=a.default.getFirstMatch(u,e)||a.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/puffin/i],describe:function(e){var i={name:"Puffin"},d=a.default.getFirstMatch(u,e)||a.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/sleipnir/i],describe:function(e){var i={name:"Sleipnir"},d=a.default.getFirstMatch(u,e)||a.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/k-meleon/i],describe:function(e){var i={name:"K-Meleon"},d=a.default.getFirstMatch(u,e)||a.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/micromessenger/i],describe:function(e){var i={name:"WeChat"},d=a.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(u,e);return d&&(i.version=d),i}},{test:[/qqbrowser/i],describe:function(e){var i={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},d=a.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(u,e);return d&&(i.version=d),i}},{test:[/msie|trident/i],describe:function(e){var i={name:"Internet Explorer"},d=a.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/\sedg\//i],describe:function(e){var i={name:"Microsoft Edge"},d=a.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/edg([ea]|ios)/i],describe:function(e){var i={name:"Microsoft Edge"},d=a.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/vivaldi/i],describe:function(e){var i={name:"Vivaldi"},d=a.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/seamonkey/i],describe:function(e){var i={name:"SeaMonkey"},d=a.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/sailfish/i],describe:function(e){var i={name:"Sailfish"},d=a.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return d&&(i.version=d),i}},{test:[/silk/i],describe:function(e){var i={name:"Amazon Silk"},d=a.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/phantom/i],describe:function(e){var i={name:"PhantomJS"},d=a.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/slimerjs/i],describe:function(e){var i={name:"SlimerJS"},d=a.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var i={name:"BlackBerry"},d=a.default.getFirstMatch(u,e)||a.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var i={name:"WebOS Browser"},d=a.default.getFirstMatch(u,e)||a.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/bada/i],describe:function(e){var i={name:"Bada"},d=a.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/tizen/i],describe:function(e){var i={name:"Tizen"},d=a.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(u,e);return d&&(i.version=d),i}},{test:[/qupzilla/i],describe:function(e){var i={name:"QupZilla"},d=a.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(u,e);return d&&(i.version=d),i}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var i={name:"Firefox"},d=a.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/electron/i],describe:function(e){var i={name:"Electron"},d=a.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/MiuiBrowser/i],describe:function(e){var i={name:"Miui"},d=a.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/chromium/i],describe:function(e){var i={name:"Chromium"},d=a.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(u,e);return d&&(i.version=d),i}},{test:[/chrome|crios|crmo/i],describe:function(e){var i={name:"Chrome"},d=a.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/GSA/i],describe:function(e){var i={name:"Google Search"},d=a.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:function(e){var i=!e.test(/like android/i),d=e.test(/android/i);return i&&d},describe:function(e){var i={name:"Android Browser"},d=a.default.getFirstMatch(u,e);return d&&(i.version=d),i}},{test:[/playstation 4/i],describe:function(e){var i={name:"PlayStation 4"},d=a.default.getFirstMatch(u,e);return d&&(i.version=d),i}},{test:[/safari|applewebkit/i],describe:function(e){var i={name:"Safari"},d=a.default.getFirstMatch(u,e);return d&&(i.version=d),i}},{test:[/.*/i],describe:function(e){var i=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:a.default.getFirstMatch(i,e),version:a.default.getSecondMatch(i,e)}}}],v.exports=n.default},93:function(v,n,l){"use strict";n.__esModule=!0,n.default=void 0;var s,a=(s=l(17))&&s.__esModule?s:{default:s},u=l(18);n.default=[{test:[/Roku\/DVP/],describe:function(e){var i=a.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:u.OS_MAP.Roku,version:i}}},{test:[/windows phone/i],describe:function(e){var i=a.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:u.OS_MAP.WindowsPhone,version:i}}},{test:[/windows /i],describe:function(e){var i=a.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),d=a.default.getWindowsVersionName(i);return{name:u.OS_MAP.Windows,version:i,versionName:d}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var i={name:u.OS_MAP.iOS},d=a.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return d&&(i.version=d),i}},{test:[/macintosh/i],describe:function(e){var i=a.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),d=a.default.getMacOSVersionName(i),w={name:u.OS_MAP.MacOS,version:i};return d&&(w.versionName=d),w}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var i=a.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:u.OS_MAP.iOS,version:i}}},{test:function(e){var i=!e.test(/like android/i),d=e.test(/android/i);return i&&d},describe:function(e){var i=a.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),d=a.default.getAndroidVersionName(i),w={name:u.OS_MAP.Android,version:i};return d&&(w.versionName=d),w}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var i=a.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),d={name:u.OS_MAP.WebOS};return i&&i.length&&(d.version=i),d}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var i=a.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||a.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||a.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:u.OS_MAP.BlackBerry,version:i}}},{test:[/bada/i],describe:function(e){var i=a.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:u.OS_MAP.Bada,version:i}}},{test:[/tizen/i],describe:function(e){var i=a.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:u.OS_MAP.Tizen,version:i}}},{test:[/linux/i],describe:function(){return{name:u.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:u.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var i=a.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:u.OS_MAP.PlayStation4,version:i}}}],v.exports=n.default},94:function(v,n,l){"use strict";n.__esModule=!0,n.default=void 0;var s,a=(s=l(17))&&s.__esModule?s:{default:s},u=l(18);n.default=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var i=a.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",d={type:u.PLATFORMS_MAP.mobile,vendor:"Huawei"};return i&&(d.model=i),d}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:u.PLATFORMS_MAP.tablet}}},{test:function(e){var i=e.test(/ipod|iphone/i),d=e.test(/like (ipod|iphone)/i);return i&&!d},describe:function(e){var i=a.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:u.PLATFORMS_MAP.mobile,vendor:"Apple",model:i}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:u.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:u.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:u.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:u.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:u.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var i=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&i>=3},describe:function(){return{type:u.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:u.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:u.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:u.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:u.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:u.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:u.PLATFORMS_MAP.tv}}}],v.exports=n.default},95:function(v,n,l){"use strict";n.__esModule=!0,n.default=void 0;var s,a=(s=l(17))&&s.__esModule?s:{default:s},u=l(18);n.default=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:u.ENGINE_MAP.Blink};var i=a.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:u.ENGINE_MAP.EdgeHTML,version:i}}},{test:[/trident/i],describe:function(e){var i={name:u.ENGINE_MAP.Trident},d=a.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:function(e){return e.test(/presto/i)},describe:function(e){var i={name:u.ENGINE_MAP.Presto},d=a.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:function(e){var i=e.test(/gecko/i),d=e.test(/like gecko/i);return i&&!d},describe:function(e){var i={name:u.ENGINE_MAP.Gecko},d=a.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:u.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var i={name:u.ENGINE_MAP.WebKit},d=a.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return d&&(i.version=d),i}}],v.exports=n.default}})},7244:(p,v,n)=>{var a=n(3436)(n(2119),"DataView");p.exports=a},4994:(p,v,n)=>{var l=n(4312),s=n(6421),a=n(13),u=n(8685),g=n(6676);function e(i){var d=-1,w=null==i?0:i.length;for(this.clear();++d<w;){var m=i[d];this.set(m[0],m[1])}}e.prototype.clear=l,e.prototype.delete=s,e.prototype.get=a,e.prototype.has=u,e.prototype.set=g,p.exports=e},9215:(p,v,n)=>{var l=n(1840),s=n(4378),a=n(4981),u=n(7343),g=n(8895);function e(i){var d=-1,w=null==i?0:i.length;for(this.clear();++d<w;){var m=i[d];this.set(m[0],m[1])}}e.prototype.clear=l,e.prototype.delete=s,e.prototype.get=a,e.prototype.has=u,e.prototype.set=g,p.exports=e},1501:(p,v,n)=>{var a=n(3436)(n(2119),"Map");p.exports=a},9850:(p,v,n)=>{var l=n(638),s=n(1184),a=n(866),u=n(3771),g=n(1772);function e(i){var d=-1,w=null==i?0:i.length;for(this.clear();++d<w;){var m=i[d];this.set(m[0],m[1])}}e.prototype.clear=l,e.prototype.delete=s,e.prototype.get=a,e.prototype.has=u,e.prototype.set=g,p.exports=e},4267:(p,v,n)=>{var a=n(3436)(n(2119),"Promise");p.exports=a},6323:(p,v,n)=>{var a=n(3436)(n(2119),"Set");p.exports=a},2858:(p,v,n)=>{var l=n(9215),s=n(3720),a=n(4410),u=n(5576),g=n(2247),e=n(1585);function i(d){var w=this.__data__=new l(d);this.size=w.size}i.prototype.clear=s,i.prototype.delete=a,i.prototype.get=u,i.prototype.has=g,i.prototype.set=e,p.exports=i},443:(p,v,n)=>{var l=n(2119);p.exports=l.Symbol},3457:(p,v,n)=>{var l=n(2119);p.exports=l.Uint8Array},4243:(p,v,n)=>{var a=n(3436)(n(2119),"WeakMap");p.exports=a},6837:p=>{p.exports=function v(n,l){for(var s=-1,a=null==n?0:n.length;++s<a&&!1!==l(n[s],s,n););return n}},9779:p=>{p.exports=function v(n,l){for(var s=-1,a=null==n?0:n.length,u=0,g=[];++s<a;){var e=n[s];l(e,s,n)&&(g[u++]=e)}return g}},2271:(p,v,n)=>{var l=n(5334),s=n(7151),a=n(1503),u=n(891),g=n(8442),e=n(8159),d=Object.prototype.hasOwnProperty;p.exports=function w(m,h){var y=a(m),b=!y&&s(m),_=!y&&!b&&u(m),C=!y&&!b&&!_&&e(m),T=y||b||_||C,A=T?l(m.length,String):[],P=A.length;for(var S in m)(h||d.call(m,S))&&(!T||!("length"==S||_&&("offset"==S||"parent"==S)||C&&("buffer"==S||"byteLength"==S||"byteOffset"==S)||g(S,P)))&&A.push(S);return A}},5059:p=>{p.exports=function v(n,l){for(var s=-1,a=l.length,u=n.length;++s<a;)n[u+s]=l[s];return n}},9719:(p,v,n)=>{var l=n(5683),s=n(217),u=Object.prototype.hasOwnProperty;p.exports=function g(e,i,d){var w=e[i];(!u.call(e,i)||!s(w,d)||void 0===d&&!(i in e))&&l(e,i,d)}},3503:(p,v,n)=>{var l=n(217);p.exports=function s(a,u){for(var g=a.length;g--;)if(l(a[g][0],u))return g;return-1}},4121:(p,v,n)=>{var l=n(1989),s=n(118);p.exports=function a(u,g){return u&&l(g,s(g),u)}},9287:(p,v,n)=>{var l=n(1989),s=n(6555);p.exports=function a(u,g){return u&&l(g,s(g),u)}},5683:(p,v,n)=>{var l=n(6713);p.exports=function s(a,u,g){"__proto__"==u&&l?l(a,u,{configurable:!0,enumerable:!0,value:g,writable:!0}):a[u]=g}},4462:(p,v,n)=>{var l=n(2858),s=n(6837),a=n(9719),u=n(4121),g=n(9287),e=n(9292),i=n(9454),d=n(4444),w=n(9905),m=n(7597),h=n(6967),y=n(8794),b=n(6782),_=n(7878),C=n(4264),T=n(1503),A=n(891),P=n(3222),S=n(5940),k=n(799),N=n(118),H=n(6555),Z="[object Arguments]",xe="[object Function]",we="[object Object]",R={};R[Z]=R["[object Array]"]=R["[object ArrayBuffer]"]=R["[object DataView]"]=R["[object Boolean]"]=R["[object Date]"]=R["[object Float32Array]"]=R["[object Float64Array]"]=R["[object Int8Array]"]=R["[object Int16Array]"]=R["[object Int32Array]"]=R["[object Map]"]=R["[object Number]"]=R[we]=R["[object RegExp]"]=R["[object Set]"]=R["[object String]"]=R["[object Symbol]"]=R["[object Uint8Array]"]=R["[object Uint8ClampedArray]"]=R["[object Uint16Array]"]=R["[object Uint32Array]"]=!0,R["[object Error]"]=R[xe]=R["[object WeakMap]"]=!1,p.exports=function ge(D,ne,re,Y,fe,Q){var J,he=1&ne,me=2&ne,Ge=4&ne;if(re&&(J=fe?re(D,Y,fe,Q):re(D)),void 0!==J)return J;if(!S(D))return D;var ve=T(D);if(ve){if(J=b(D),!he)return i(D,J)}else{var oe=y(D),Se=oe==xe||"[object GeneratorFunction]"==oe;if(A(D))return e(D,he);if(oe==we||oe==Z||Se&&!fe){if(J=me||Se?{}:C(D),!he)return me?w(D,g(J,D)):d(D,u(J,D))}else{if(!R[oe])return fe?D:{};J=_(D,oe,he)}}Q||(Q=new l);var Te=Q.get(D);if(Te)return Te;Q.set(D,J),k(D)?D.forEach(function($){J.add(ge($,ne,re,$,D,Q))}):P(D)&&D.forEach(function($,ie){J.set(ie,ge($,ne,re,ie,D,Q))});var be=ve?void 0:(Ge?me?h:m:me?H:N)(D);return s(be||D,function($,ie){be&&($=D[ie=$]),a(J,ie,ge($,ne,re,ie,D,Q))}),J}},8858:(p,v,n)=>{var l=n(5940),s=Object.create,a=function(){function u(){}return function(g){if(!l(g))return{};if(s)return s(g);u.prototype=g;var e=new u;return u.prototype=void 0,e}}();p.exports=a},8247:(p,v,n)=>{var l=n(5059),s=n(1503);p.exports=function a(u,g,e){var i=g(u);return s(u)?i:l(i,e(u))}},3337:(p,v,n)=>{var l=n(443),s=n(1318),a=n(2902),e=l?l.toStringTag:void 0;p.exports=function i(d){return null==d?void 0===d?"[object Undefined]":"[object Null]":e&&e in Object(d)?s(d):a(d)}},186:(p,v,n)=>{var l=n(3337),s=n(2671);p.exports=function u(g){return s(g)&&"[object Arguments]"==l(g)}},7021:(p,v,n)=>{var l=n(8794),s=n(2671);p.exports=function u(g){return s(g)&&"[object Map]"==l(g)}},7304:(p,v,n)=>{var l=n(5946),s=n(1943),a=n(5940),u=n(2827),e=/^\[object .+?Constructor\]$/,h=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");p.exports=function y(b){return!(!a(b)||s(b))&&(l(b)?h:e).test(u(b))}},771:(p,v,n)=>{var l=n(8794),s=n(2671);p.exports=function u(g){return s(g)&&"[object Set]"==l(g)}},1083:(p,v,n)=>{var l=n(3337),s=n(6231),a=n(2671),F={};F["[object Float32Array]"]=F["[object Float64Array]"]=F["[object Int8Array]"]=F["[object Int16Array]"]=F["[object Int32Array]"]=F["[object Uint8Array]"]=F["[object Uint8ClampedArray]"]=F["[object Uint16Array]"]=F["[object Uint32Array]"]=!0,F["[object Arguments]"]=F["[object Array]"]=F["[object ArrayBuffer]"]=F["[object Boolean]"]=F["[object DataView]"]=F["[object Date]"]=F["[object Error]"]=F["[object Function]"]=F["[object Map]"]=F["[object Number]"]=F["[object Object]"]=F["[object RegExp]"]=F["[object Set]"]=F["[object String]"]=F["[object WeakMap]"]=!1,p.exports=function K(le){return a(le)&&s(le.length)&&!!F[l(le)]}},1172:(p,v,n)=>{var l=n(5488),s=n(5491),u=Object.prototype.hasOwnProperty;p.exports=function g(e){if(!l(e))return s(e);var i=[];for(var d in Object(e))u.call(e,d)&&"constructor"!=d&&i.push(d);return i}},2809:(p,v,n)=>{var l=n(5940),s=n(5488),a=n(2158),g=Object.prototype.hasOwnProperty;p.exports=function e(i){if(!l(i))return a(i);var d=s(i),w=[];for(var m in i)"constructor"==m&&(d||!g.call(i,m))||w.push(m);return w}},5334:p=>{p.exports=function v(n,l){for(var s=-1,a=Array(n);++s<n;)a[s]=l(s);return a}},5647:p=>{p.exports=function v(n){return function(l){return n(l)}}},3362:(p,v,n)=>{var l=n(3457);p.exports=function s(a){var u=new a.constructor(a.byteLength);return new l(u).set(new l(a)),u}},9292:(p,v,n)=>{p=n.nmd(p);var l=n(2119),s=v&&!v.nodeType&&v,a=s&&p&&!p.nodeType&&p,g=a&&a.exports===s?l.Buffer:void 0,e=g?g.allocUnsafe:void 0;p.exports=function i(d,w){if(w)return d.slice();var m=d.length,h=e?e(m):new d.constructor(m);return d.copy(h),h}},7e3:(p,v,n)=>{var l=n(3362);p.exports=function s(a,u){var g=u?l(a.buffer):a.buffer;return new a.constructor(g,a.byteOffset,a.byteLength)}},4098:p=>{var v=/\w*$/;p.exports=function n(l){var s=new l.constructor(l.source,v.exec(l));return s.lastIndex=l.lastIndex,s}},2533:(p,v,n)=>{var l=n(443),s=l?l.prototype:void 0,a=s?s.valueOf:void 0;p.exports=function u(g){return a?Object(a.call(g)):{}}},5208:(p,v,n)=>{var l=n(3362);p.exports=function s(a,u){var g=u?l(a.buffer):a.buffer;return new a.constructor(g,a.byteOffset,a.length)}},9454:p=>{p.exports=function v(n,l){var s=-1,a=n.length;for(l||(l=Array(a));++s<a;)l[s]=n[s];return l}},1989:(p,v,n)=>{var l=n(9719),s=n(5683);p.exports=function a(u,g,e,i){var d=!e;e||(e={});for(var w=-1,m=g.length;++w<m;){var h=g[w],y=i?i(e[h],u[h],h,e,u):void 0;void 0===y&&(y=u[h]),d?s(e,h,y):l(e,h,y)}return e}},4444:(p,v,n)=>{var l=n(1989),s=n(9383);p.exports=function a(u,g){return l(u,s(u),g)}},9905:(p,v,n)=>{var l=n(1989),s=n(3051);p.exports=function a(u,g){return l(u,s(u),g)}},4610:(p,v,n)=>{var l=n(2119);p.exports=l["__core-js_shared__"]},6713:(p,v,n)=>{var l=n(3436),s=function(){try{var a=l(Object,"defineProperty");return a({},"",{}),a}catch{}}();p.exports=s},9122:p=>{var v="object"==typeof global&&global&&global.Object===Object&&global;p.exports=v},7597:(p,v,n)=>{var l=n(8247),s=n(9383),a=n(118);p.exports=function u(g){return l(g,a,s)}},6967:(p,v,n)=>{var l=n(8247),s=n(3051),a=n(6555);p.exports=function u(g){return l(g,a,s)}},4537:(p,v,n)=>{var l=n(3819);p.exports=function s(a,u){var g=a.__data__;return l(u)?g["string"==typeof u?"string":"hash"]:g.map}},3436:(p,v,n)=>{var l=n(7304),s=n(1990);p.exports=function a(u,g){var e=s(u,g);return l(e)?e:void 0}},9519:(p,v,n)=>{var s=n(9385)(Object.getPrototypeOf,Object);p.exports=s},1318:(p,v,n)=>{var l=n(443),s=Object.prototype,a=s.hasOwnProperty,u=s.toString,g=l?l.toStringTag:void 0;p.exports=function e(i){var d=a.call(i,g),w=i[g];try{i[g]=void 0;var m=!0}catch{}var h=u.call(i);return m&&(d?i[g]=w:delete i[g]),h}},9383:(p,v,n)=>{var l=n(9779),s=n(9975),u=Object.prototype.propertyIsEnumerable,g=Object.getOwnPropertySymbols;p.exports=g?function(i){return null==i?[]:(i=Object(i),l(g(i),function(d){return u.call(i,d)}))}:s},3051:(p,v,n)=>{var l=n(5059),s=n(9519),a=n(9383),u=n(9975);p.exports=Object.getOwnPropertySymbols?function(i){for(var d=[];i;)l(d,a(i)),i=s(i);return d}:u},8794:(p,v,n)=>{var l=n(7244),s=n(1501),a=n(4267),u=n(6323),g=n(4243),e=n(3337),i=n(2827),d="[object Map]",m="[object Promise]",h="[object Set]",y="[object WeakMap]",b="[object DataView]",_=i(l),C=i(s),T=i(a),A=i(u),P=i(g),S=e;(l&&S(new l(new ArrayBuffer(1)))!=b||s&&S(new s)!=d||a&&S(a.resolve())!=m||u&&S(new u)!=h||g&&S(new g)!=y)&&(S=function(k){var N=e(k),H="[object Object]"==N?k.constructor:void 0,G=H?i(H):"";if(G)switch(G){case _:return b;case C:return d;case T:return m;case A:return h;case P:return y}return N}),p.exports=S},1990:p=>{p.exports=function v(n,l){return n?.[l]}},4312:(p,v,n)=>{var l=n(862);p.exports=function s(){this.__data__=l?l(null):{},this.size=0}},6421:p=>{p.exports=function v(n){var l=this.has(n)&&delete this.__data__[n];return this.size-=l?1:0,l}},13:(p,v,n)=>{var l=n(862),u=Object.prototype.hasOwnProperty;p.exports=function g(e){var i=this.__data__;if(l){var d=i[e];return"__lodash_hash_undefined__"===d?void 0:d}return u.call(i,e)?i[e]:void 0}},8685:(p,v,n)=>{var l=n(862),a=Object.prototype.hasOwnProperty;p.exports=function u(g){var e=this.__data__;return l?void 0!==e[g]:a.call(e,g)}},6676:(p,v,n)=>{var l=n(862);p.exports=function a(u,g){var e=this.__data__;return this.size+=this.has(u)?0:1,e[u]=l&&void 0===g?"__lodash_hash_undefined__":g,this}},6782:p=>{var n=Object.prototype.hasOwnProperty;p.exports=function l(s){var a=s.length,u=new s.constructor(a);return a&&"string"==typeof s[0]&&n.call(s,"index")&&(u.index=s.index,u.input=s.input),u}},7878:(p,v,n)=>{var l=n(3362),s=n(7e3),a=n(4098),u=n(2533),g=n(5208);p.exports=function B(Z,W,F){var K=Z.constructor;switch(W){case"[object ArrayBuffer]":return l(Z);case"[object Boolean]":case"[object Date]":return new K(+Z);case"[object DataView]":return s(Z,F);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return g(Z,F);case"[object Map]":case"[object Set]":return new K;case"[object Number]":case"[object String]":return new K(Z);case"[object RegExp]":return a(Z);case"[object Symbol]":return u(Z)}}},4264:(p,v,n)=>{var l=n(8858),s=n(9519),a=n(5488);p.exports=function u(g){return"function"!=typeof g.constructor||a(g)?{}:l(s(g))}},8442:p=>{var n=/^(?:0|[1-9]\d*)$/;p.exports=function l(s,a){var u=typeof s;return!!(a=a??9007199254740991)&&("number"==u||"symbol"!=u&&n.test(s))&&s>-1&&s%1==0&&s<a}},3819:p=>{p.exports=function v(n){var l=typeof n;return"string"==l||"number"==l||"symbol"==l||"boolean"==l?"__proto__"!==n:null===n}},1943:(p,v,n)=>{var u,l=n(4610),s=(u=/[^.]+$/.exec(l&&l.keys&&l.keys.IE_PROTO||""))?"Symbol(src)_1."+u:"";p.exports=function a(u){return!!s&&s in u}},5488:p=>{var v=Object.prototype;p.exports=function n(l){var s=l&&l.constructor;return l===("function"==typeof s&&s.prototype||v)}},1840:p=>{p.exports=function v(){this.__data__=[],this.size=0}},4378:(p,v,n)=>{var l=n(3503),a=Array.prototype.splice;p.exports=function u(g){var e=this.__data__,i=l(e,g);return!(i<0||(i==e.length-1?e.pop():a.call(e,i,1),--this.size,0))}},4981:(p,v,n)=>{var l=n(3503);p.exports=function s(a){var u=this.__data__,g=l(u,a);return g<0?void 0:u[g][1]}},7343:(p,v,n)=>{var l=n(3503);p.exports=function s(a){return l(this.__data__,a)>-1}},8895:(p,v,n)=>{var l=n(3503);p.exports=function s(a,u){var g=this.__data__,e=l(g,a);return e<0?(++this.size,g.push([a,u])):g[e][1]=u,this}},638:(p,v,n)=>{var l=n(4994),s=n(9215),a=n(1501);p.exports=function u(){this.size=0,this.__data__={hash:new l,map:new(a||s),string:new l}}},1184:(p,v,n)=>{var l=n(4537);p.exports=function s(a){var u=l(this,a).delete(a);return this.size-=u?1:0,u}},866:(p,v,n)=>{var l=n(4537);p.exports=function s(a){return l(this,a).get(a)}},3771:(p,v,n)=>{var l=n(4537);p.exports=function s(a){return l(this,a).has(a)}},1772:(p,v,n)=>{var l=n(4537);p.exports=function s(a,u){var g=l(this,a),e=g.size;return g.set(a,u),this.size+=g.size==e?0:1,this}},862:(p,v,n)=>{var s=n(3436)(Object,"create");p.exports=s},5491:(p,v,n)=>{var s=n(9385)(Object.keys,Object);p.exports=s},2158:p=>{p.exports=function v(n){var l=[];if(null!=n)for(var s in Object(n))l.push(s);return l}},3597:(p,v,n)=>{p=n.nmd(p);var l=n(9122),s=v&&!v.nodeType&&v,a=s&&p&&!p.nodeType&&p,g=a&&a.exports===s&&l.process,e=function(){try{return a&&a.require&&a.require("util").types||g&&g.binding&&g.binding("util")}catch{}}();p.exports=e},2902:p=>{var n=Object.prototype.toString;p.exports=function l(s){return n.call(s)}},9385:p=>{p.exports=function v(n,l){return function(s){return n(l(s))}}},2119:(p,v,n)=>{var l=n(9122),s="object"==typeof self&&self&&self.Object===Object&&self,a=l||s||Function("return this")();p.exports=a},3720:(p,v,n)=>{var l=n(9215);p.exports=function s(){this.__data__=new l,this.size=0}},4410:p=>{p.exports=function v(n){var l=this.__data__,s=l.delete(n);return this.size=l.size,s}},5576:p=>{p.exports=function v(n){return this.__data__.get(n)}},2247:p=>{p.exports=function v(n){return this.__data__.has(n)}},1585:(p,v,n)=>{var l=n(9215),s=n(1501),a=n(9850);p.exports=function g(e,i){var d=this.__data__;if(d instanceof l){var w=d.__data__;if(!s||w.length<199)return w.push([e,i]),this.size=++d.size,this;d=this.__data__=new a(w)}return d.set(e,i),this.size=d.size,this}},2827:p=>{var n=Function.prototype.toString;p.exports=function l(s){if(null!=s){try{return n.call(s)}catch{}try{return s+""}catch{}}return""}},1094:(p,v,n)=>{var l=n(4462);p.exports=function a(u){return l(u,4)}},217:p=>{p.exports=function v(n,l){return n===l||n!=n&&l!=l}},7151:(p,v,n)=>{var l=n(186),s=n(2671),a=Object.prototype,u=a.hasOwnProperty,g=a.propertyIsEnumerable,e=l(function(){return arguments}())?l:function(i){return s(i)&&u.call(i,"callee")&&!g.call(i,"callee")};p.exports=e},1503:p=>{p.exports=Array.isArray},6507:(p,v,n)=>{var l=n(5946),s=n(6231);p.exports=function a(u){return null!=u&&s(u.length)&&!l(u)}},891:(p,v,n)=>{p=n.nmd(p);var l=n(2119),s=n(3580),a=v&&!v.nodeType&&v,u=a&&p&&!p.nodeType&&p,e=u&&u.exports===a?l.Buffer:void 0;p.exports=(e?e.isBuffer:void 0)||s},5946:(p,v,n)=>{var l=n(3337),s=n(5940);p.exports=function i(d){if(!s(d))return!1;var w=l(d);return"[object Function]"==w||"[object GeneratorFunction]"==w||"[object AsyncFunction]"==w||"[object Proxy]"==w}},6231:p=>{p.exports=function n(l){return"number"==typeof l&&l>-1&&l%1==0&&l<=9007199254740991}},3222:(p,v,n)=>{var l=n(7021),s=n(5647),a=n(3597),u=a&&a.isMap,g=u?s(u):l;p.exports=g},5940:p=>{p.exports=function v(n){var l=typeof n;return null!=n&&("object"==l||"function"==l)}},2671:p=>{p.exports=function v(n){return null!=n&&"object"==typeof n}},799:(p,v,n)=>{var l=n(771),s=n(5647),a=n(3597),u=a&&a.isSet,g=u?s(u):l;p.exports=g},8159:(p,v,n)=>{var l=n(1083),s=n(5647),a=n(3597),u=a&&a.isTypedArray,g=u?s(u):l;p.exports=g},118:(p,v,n)=>{var l=n(2271),s=n(1172),a=n(6507);p.exports=function u(g){return a(g)?l(g):s(g)}},6555:(p,v,n)=>{var l=n(2271),s=n(2809),a=n(6507);p.exports=function u(g){return a(g)?l(g,!0):s(g)}},9975:p=>{p.exports=function v(){return[]}},3580:p=>{p.exports=function v(){return!1}},2754:(p,v,n)=>{"use strict";v.TD=void 0;var s=n(4354);Object.defineProperty(v,"TD",{enumerable:!0,get:function(){return s.requestMediaPermissions}})},4354:function(p,v,n){"use strict";var l=this&&this.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(v,"__esModule",{value:!0}),v.requestVideoPermissions=v.requestAudioPermissions=v.requestMediaPermissions=v.MediaPermissionsErrorType=void 0;const s=l(n(7230));var a,i;(i=a=v.MediaPermissionsErrorType||(v.MediaPermissionsErrorType={})).SystemPermissionDenied="SystemPermissionDenied",i.UserPermissionDenied="UserPermissionDenied",i.CouldNotStartVideoSource="CouldNotStartVideoSource",i.Generic="Generic",v.requestMediaPermissions=i=>new Promise((d,w)=>{navigator.mediaDevices.getUserMedia(i??{audio:!0,video:!0}).then(m=>{m.getTracks().forEach(h=>{h.stop()}),d(!0)}).catch(m=>{const y=s.default.getParser(window.navigator.userAgent).getBrowserName(),b=m.name,_=m.message;let C=a.Generic;"Chrome"===y?"NotAllowedError"===b?"Permission denied by system"===_?C=a.SystemPermissionDenied:"Permission denied"===_&&(C=a.UserPermissionDenied):"NotReadableError"===b&&(C=a.CouldNotStartVideoSource):"Safari"===y?"NotAllowedError"===b&&(C=a.UserPermissionDenied):"Microsoft Edge"===y?"NotAllowedError"===b?C=a.UserPermissionDenied:"NotReadableError"===b&&(C=a.CouldNotStartVideoSource):"Firefox"===y&&("NotFoundError"===b||"NotReadableError"===b?C=a.SystemPermissionDenied:"NotAllowedError"===b?C=a.UserPermissionDenied:"AbortError"===b&&(C=a.CouldNotStartVideoSource)),w({type:C,name:m.name,message:m.message})})}),v.requestAudioPermissions=()=>(0,v.requestMediaPermissions)({audio:!0,video:!1}),v.requestVideoPermissions=()=>(0,v.requestMediaPermissions)({audio:!1,video:!0})},5439:p=>{window,p.exports=function(v){var n={};function l(s){if(n[s])return n[s].exports;var a=n[s]={i:s,l:!1,exports:{}};return v[s].call(a.exports,a,a.exports,l),a.l=!0,a.exports}return l.m=v,l.c=n,l.d=function(s,a,u){l.o(s,a)||Object.defineProperty(s,a,{enumerable:!0,get:u})},l.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},l.t=function(s,a){if(1&a&&(s=l(s)),8&a||4&a&&"object"==typeof s&&s&&s.__esModule)return s;var u=Object.create(null);if(l.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:s}),2&a&&"string"!=typeof s)for(var g in s)l.d(u,g,function(e){return s[e]}.bind(null,g));return u},l.n=function(s){var a=s&&s.__esModule?function(){return s.default}:function(){return s};return l.d(a,"a",a),a},l.o=function(s,a){return Object.prototype.hasOwnProperty.call(s,a)},l.p="/dist/",l(l.s=1)}([function(v,n,l){"use strict";var s=this&&this.__awaiter||function(u,g,e,i){return new(e||(e=Promise))(function(d,w){function m(b){try{y(i.next(b))}catch(_){w(_)}}function h(b){try{y(i.throw(b))}catch(_){w(_)}}function y(b){var _;b.done?d(b.value):(_=b.value,_ instanceof e?_:new e(function(C){C(_)})).then(m,h)}y((i=i.apply(u,g||[])).next())})},a=this&&this.__generator||function(u,g){var e,i,d,w,m={label:0,sent:function(){if(1&d[0])throw d[1];return d[1]},trys:[],ops:[]};return w={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(w[Symbol.iterator]=function(){return this}),w;function h(y){return function(b){return function(_){if(e)throw new TypeError("Generator is already executing.");for(;w&&(w=0,_[0]&&(m=0)),m;)try{if(e=1,i&&(d=2&_[0]?i.return:_[0]?i.throw||((d=i.return)&&d.call(i),0):i.next)&&!(d=d.call(i,_[1])).done)return d;switch(i=0,d&&(_=[2&_[0],d.value]),_[0]){case 0:case 1:d=_;break;case 4:return m.label++,{value:_[1],done:!1};case 5:m.label++,i=_[1],_=[0];continue;case 7:_=m.ops.pop(),m.trys.pop();continue;default:if(!((d=(d=m.trys).length>0&&d[d.length-1])||6!==_[0]&&2!==_[0])){m=0;continue}if(3===_[0]&&(!d||_[1]>d[0]&&_[1]<d[3])){m.label=_[1];break}if(6===_[0]&&m.label<d[1]){m.label=d[1],d=_;break}if(d&&m.label<d[2]){m.label=d[2],m.ops.push(_);break}d[2]&&m.ops.pop(),m.trys.pop();continue}_=g.call(u,m)}catch(C){_=[6,C],i=0}finally{e=d=0}if(5&_[0])throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}([y,b])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.file2b64=void 0,n.file2b64=function(u){return s(this,void 0,void 0,function(){var g,e;return a(this,function(i){return g=new FileReader,e=new Promise(function(d,w){g.addEventListener("load",function(){var m,h=null===(m=g.result)||void 0===m?void 0:m.toString();h?d(h):w("could not convert file to base64")},!1)}),g.readAsDataURL(u),[2,e]})})}},function(v,n,l){"use strict";var s=this&&this.__awaiter||function(m,h,y,b){return new(y||(y=Promise))(function(_,C){function T(S){try{P(b.next(S))}catch(k){C(k)}}function A(S){try{P(b.throw(S))}catch(k){C(k)}}function P(S){var k;S.done?_(S.value):(k=S.value,k instanceof y?k:new y(function(N){N(k)})).then(T,A)}P((b=b.apply(m,h||[])).next())})},a=this&&this.__generator||function(m,h){var y,b,_,C,T={label:0,sent:function(){if(1&_[0])throw _[1];return _[1]},trys:[],ops:[]};return C={next:A(0),throw:A(1),return:A(2)},"function"==typeof Symbol&&(C[Symbol.iterator]=function(){return this}),C;function A(P){return function(S){return function(k){if(y)throw new TypeError("Generator is already executing.");for(;C&&(C=0,k[0]&&(T=0)),T;)try{if(y=1,b&&(_=2&k[0]?b.return:k[0]?b.throw||((_=b.return)&&_.call(b),0):b.next)&&!(_=_.call(b,k[1])).done)return _;switch(b=0,_&&(k=[2&k[0],_.value]),k[0]){case 0:case 1:_=k;break;case 4:return T.label++,{value:k[1],done:!1};case 5:T.label++,b=k[1],k=[0];continue;case 7:k=T.ops.pop(),T.trys.pop();continue;default:if(!((_=(_=T.trys).length>0&&_[_.length-1])||6!==k[0]&&2!==k[0])){T=0;continue}if(3===k[0]&&(!_||k[1]>_[0]&&k[1]<_[3])){T.label=k[1];break}if(6===k[0]&&T.label<_[1]){T.label=_[1],_=k;break}if(_&&T.label<_[2]){T.label=_[2],T.ops.push(k);break}_[2]&&T.ops.pop(),T.trys.pop();continue}k=h.call(m,T)}catch(N){k=[6,N],b=0}finally{y=_=0}if(5&k[0])throw k[1];return{value:k[0]?k[1]:void 0,done:!0}}([P,S])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.imageCompressor=void 0;var u=l(2),g=l(3),e=l(0),i=l(4),d=l(5),w=function(){function m(h,y){var b=this;this.quill=h,this.options=y||{};var _=!!y.debug;this.Logger=new d.ConsoleLogger(_,!!y.suppressErrorLogging),(0,g.warnAboutOptions)(y,this.Logger),this.imageDrop=new u.ImageDrop(h,function(A){return s(b,void 0,void 0,function(){var P;return a(this,function(S){switch(S.label){case 0:return this.Logger.log("onImageDrop",{dataUrl:A}),[4,this.downscaleImageFromUrl(A)];case 1:return P=S.sent(),this.insertToEditor(P,m.b64toBlob(P)),[2]}})})},this.Logger),this.Logger.log("fileChanged",{options:y,quill:h,debug:_});var T=this.quill.getModule("toolbar");T?T.addHandler("image",function(){return b.selectLocalImage()}):this.Logger.error("Quill toolbar module not found! need { toolbar: // options } in Quill.modules for image icon to sit in")}return m.b64toBlob=function(h){for(var y=atob(h.split(",")[1]),b=h.slice(5).split(";")[0],_=new ArrayBuffer(y.length),C=new Uint8Array(_),T=0;T<y.length;T++)C[T]=y.charCodeAt(T);return new Blob([_],{type:b})},m.prototype.selectLocalImage=function(h){var y=this;this.range=this.quill.getSelection(),this.fileHolder=document.createElement("input"),this.fileHolder.setAttribute("type","file"),this.fileHolder.setAttribute("accept","image/*"),this.fileHolder.setAttribute("style","visibility:hidden"),this.fileHolder.onchange=function(){return y.fileChanged().then(function(){return h&&h()})},document.body.appendChild(this.fileHolder),this.fileHolder.click(),window.requestAnimationFrame(function(){y.fileHolder&&document.body.removeChild(y.fileHolder)})},m.prototype.fileChanged=function(h){var y;return s(this,void 0,void 0,function(){var b,_,C,T;return a(this,function(A){switch(A.label){case 0:return(b=h||(null===(y=this.fileHolder)||void 0===y?void 0:y.files))&&b.length?(this.Logger.log("fileChanged",{file:_=b[0]}),_?[4,(0,e.file2b64)(_)]:[2]):[2];case 1:return C=A.sent(),[4,this.downscaleImageFromUrl(C)];case 2:return T=A.sent(),this.insertToEditor(T,m.b64toBlob(T)),[2]}})})},m.prototype.downscaleImageFromUrl=function(h){return s(this,void 0,void 0,function(){var y;return a(this,function(b){switch(b.label){case 0:return[4,(0,i.downscaleImage)(this.Logger,h,this.options.maxWidth,this.options.maxHeight,this.options.imageType,this.options.keepImageTypes,this.options.ignoreImageTypes,this.options.quality)];case 1:return y=b.sent(),this.Logger.log("downscaleImageFromUrl",{dataUrl:h,dataUrlCompressed:y}),[2,y]}})})},m.prototype.insertToEditor=function(h,y){if(this.options.insertIntoEditor)this.options.insertIntoEditor(h,y);else{this.Logger.log("insertToEditor",{url:h}),this.range=this.quill.getSelection();var b=this.range;if(!b)return;this.logFileSize(h),this.quill.insertEmbed(b.index,"image","".concat(h),"user"),b.index++,this.quill.setSelection(b,"api")}},m.prototype.logFileSize=function(h){var y=(Math.round(3*(h.length-22)/4)/1024).toFixed(0);this.Logger.log("estimated img size: "+y+" kb")},m}();n.imageCompressor=w,window.imageCompressor=w,n.default=w},function(v,n,l){"use strict";var s=this&&this.__awaiter||function(w,m,h,y){return new(h||(h=Promise))(function(b,_){function C(P){try{A(y.next(P))}catch(S){_(S)}}function T(P){try{A(y.throw(P))}catch(S){_(S)}}function A(P){var S;P.done?b(P.value):(S=P.value,S instanceof h?S:new h(function(k){k(S)})).then(C,T)}A((y=y.apply(w,m||[])).next())})},a=this&&this.__generator||function(w,m){var h,y,b,_,C={label:0,sent:function(){if(1&b[0])throw b[1];return b[1]},trys:[],ops:[]};return _={next:T(0),throw:T(1),return:T(2)},"function"==typeof Symbol&&(_[Symbol.iterator]=function(){return this}),_;function T(A){return function(P){return function(S){if(h)throw new TypeError("Generator is already executing.");for(;_&&(_=0,S[0]&&(C=0)),C;)try{if(h=1,y&&(b=2&S[0]?y.return:S[0]?y.throw||((b=y.return)&&b.call(y),0):y.next)&&!(b=b.call(y,S[1])).done)return b;switch(y=0,b&&(S=[2&S[0],b.value]),S[0]){case 0:case 1:b=S;break;case 4:return C.label++,{value:S[1],done:!1};case 5:C.label++,y=S[1],S=[0];continue;case 7:S=C.ops.pop(),C.trys.pop();continue;default:if(!((b=(b=C.trys).length>0&&b[b.length-1])||6!==S[0]&&2!==S[0])){C=0;continue}if(3===S[0]&&(!b||S[1]>b[0]&&S[1]<b[3])){C.label=S[1];break}if(6===S[0]&&C.label<b[1]){C.label=b[1],b=S;break}if(b&&C.label<b[2]){C.label=b[2],C.ops.push(S);break}b[2]&&C.ops.pop(),C.trys.pop();continue}S=m.call(w,C)}catch(k){S=[6,k],y=0}finally{h=b=0}if(5&S[0])throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}([A,P])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.ImageDrop=void 0;var u=l(0),g=function(){function w(m,h,y){var b=this;this.quill=m,this.onNewDataUrl=h,this.logger=y,this.quill.root.addEventListener("drop",function(_){return b.handleDrop(_)},!1),this.quill.root.addEventListener("paste",function(_){return b.handlePaste(_)},!1)}return w.prototype.handleDrop=function(m){return s(this,void 0,void 0,function(){var h,y,b,_,C,T,A;return a(this,function(P){switch(P.label){case 0:return m.preventDefault(),document.caretRangeFromPoint&&(h=document.getSelection(),y=document.caretRangeFromPoint(m.clientX,m.clientY),h&&y&&h.setBaseAndExtent(y.startContainer,y.startOffset,y.startContainer,y.startOffset)),[4,i(m)];case 1:return b=P.sent(),_=Array.from(b||[]).filter(function(S){return d(S.type)}),(C=_?.[0])?[4,(0,u.file2b64)(C)]:[3,3];case 2:return A=P.sent(),this.logger.log("handleNewImageFiles",{evt:m,files:b,filesFiltered:_,firstImage:C,base64ImageSrc:A}),this.onNewDataUrl(A),[2];case 3:return[4,e(m)];case 4:return(T=P.sent())?[4,(0,u.file2b64)(T)]:[3,6];case 5:return A=P.sent(),this.logger.log("handleNewImageFiles",{evt:m,blob:T,base64ImageSrc:A}),this.onNewDataUrl(A),[2];case 6:return[2]}})})},w.prototype.handlePaste=function(m){var h,y;return s(this,void 0,void 0,function(){var b,_,C,T;return a(this,function(A){switch(A.label){case 0:return b=Array.from((null===(h=m?.clipboardData)||void 0===h?void 0:h.items)||[]),this.logger.log("handlePaste",{files:b,evt:m}),_=b.filter(function(P){return d(P.type)}),this.logger.log("handlePaste",{images:_,evt:m}),_.length?_.filter(function(P){return"text/html"!==P.type}).length?(m.preventDefault(),(C=null===(y=_.pop())||void 0===y?void 0:y.getAsFile())?[4,(0,u.file2b64)(C)]:[2]):(this.logger.log("handlePaste also detected html"),[2]):[2];case 1:return T=A.sent(),this.logger.log("handleNewImageFiles",{base64ImageSrc:T}),this.onNewDataUrl(T),[2]}})})},w}();function e(w){var m;return s(this,void 0,void 0,function(){var h;return a(this,function(y){switch(y.label){case 0:return(h=null===(m=w.dataTransfer)||void 0===m?void 0:m.getData("URL"))?[4,fetch(h)]:[3,3];case 1:return[4,y.sent().blob()];case 2:return[2,y.sent()];case 3:return[2]}})})}function i(w){var m;return s(this,void 0,void 0,function(){return a(this,function(h){return[2,null===(m=w?.dataTransfer)||void 0===m?void 0:m.files]})})}function d(w){return!!w.match(/^image\/(gif|jpe?g|a?png|svg|webp|bmp)/i)}n.ImageDrop=g},function(v,n,l){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.warnAboutOptions=void 0,n.warnAboutOptions=function(s,a){s.maxWidth=s.maxWidth||1e3,s.maxHeight=s.maxHeight||1e3,s.maxWidth&&"number"!=typeof s.maxWidth&&(a.warn("[config error] 'maxWidth' is required to be a \"number\" (in pixels), \nreceived: ".concat(s.maxWidth,"\n-> using default 1000")),s.maxWidth=1e3),s.maxHeight&&"number"!=typeof s.maxHeight&&(a.warn("[config error] 'maxHeight' is required to be a \"number\" (in pixels), \nreceived: ".concat(s.maxHeight,"\n-> using default 1000")),s.maxHeight=1e3),s.quality&&"number"!=typeof s.quality&&(a.warn("quill.imageCompressor: [config error] 'quality' is required to be a \"number\", \nreceived: ".concat(s.quality,"\n-> using default 0.7")),s.quality=.7),!s.imageType||"string"==typeof s.imageType&&s.imageType.startsWith("image/")||(a.warn('quill.imageCompressor: [config error] \'imageType\' is required be in the form of "image/png" or "image/jpeg" etc ..., \nreceived: '.concat(s.imageType,"\n-> using default image/jpeg")),s.imageType="image/jpeg"),s.keepImageTypes||(s.keepImageTypes=[]),s.keepImageTypes&&!Array.isArray(s.keepImageTypes)&&(a.warn("quill.imageCompressor: [config error] 'keepImageTypes' is required to be a \"array\", received: ".concat(s.keepImageTypes," -> using default []")),s.keepImageTypes=[]),s.ignoreImageTypes||(s.ignoreImageTypes=[]),s.ignoreImageTypes&&!Array.isArray(s.ignoreImageTypes)&&(a.warn("quill.imageCompressor: [config error] 'ignoreImageTypes' is required to be a \"array\", received: ".concat(s.ignoreImageTypes," -> using default []")),s.ignoreImageTypes=[]),s.insertIntoEditor&&"function"!=typeof s.insertIntoEditor&&(a.warn("quill.imageCompressor: [config error] 'insertIntoEditor' is required to be a \"function\", received: ".concat(s.insertIntoEditor," -> using default undefined")),s.insertIntoEditor=void 0)}},function(v,n,l){"use strict";var s=this&&this.__awaiter||function(u,g,e,i){return new(e||(e=Promise))(function(d,w){function m(b){try{y(i.next(b))}catch(_){w(_)}}function h(b){try{y(i.throw(b))}catch(_){w(_)}}function y(b){var _;b.done?d(b.value):(_=b.value,_ instanceof e?_:new e(function(C){C(_)})).then(m,h)}y((i=i.apply(u,g||[])).next())})},a=this&&this.__generator||function(u,g){var e,i,d,w,m={label:0,sent:function(){if(1&d[0])throw d[1];return d[1]},trys:[],ops:[]};return w={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(w[Symbol.iterator]=function(){return this}),w;function h(y){return function(b){return function(_){if(e)throw new TypeError("Generator is already executing.");for(;w&&(w=0,_[0]&&(m=0)),m;)try{if(e=1,i&&(d=2&_[0]?i.return:_[0]?i.throw||((d=i.return)&&d.call(i),0):i.next)&&!(d=d.call(i,_[1])).done)return d;switch(i=0,d&&(_=[2&_[0],d.value]),_[0]){case 0:case 1:d=_;break;case 4:return m.label++,{value:_[1],done:!1};case 5:m.label++,i=_[1],_=[0];continue;case 7:_=m.ops.pop(),m.trys.pop();continue;default:if(!((d=(d=m.trys).length>0&&d[d.length-1])||6!==_[0]&&2!==_[0])){m=0;continue}if(3===_[0]&&(!d||_[1]>d[0]&&_[1]<d[3])){m.label=_[1];break}if(6===_[0]&&m.label<d[1]){m.label=d[1],d=_;break}if(d&&m.label<d[2]){m.label=d[2],m.ops.push(_);break}d[2]&&m.ops.pop(),m.trys.pop();continue}_=g.call(u,m)}catch(C){_=[6,C],i=0}finally{e=d=0}if(5&_[0])throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}([y,b])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.downscaleImage=void 0,n.downscaleImage=function(u,g,e,i,d,w,m,h){return s(this,void 0,void 0,function(){var y,b,_,C,T,A,P,S;return a(this,function(k){switch(k.label){case 0:return y=g.split(";")[0].split(":")[1],d=d||"image/jpeg",h=h||.7,(b=new Image).src=g,[4,new Promise(function(N){b.onload=function(){N()}})];case 1:return k.sent(),_=function(N,H,G,L){if(G&&L&&N<=G&&H<=L)return[N,H];if(G&&N>G){var B=G,Z=Math.floor(H/N*B);if(L&&Z>L){var W=L;return[Math.floor(N/H*W),W]}return[B,Z]}return L&&H>L?(Z=L,[B=Math.floor(N/H*Z),Z]):[H,N]}(b.width,b.height,e,i),C=_[0],T=_[1],(A=document.createElement("canvas")).width=C,A.height=T,P=A.getContext("2d"),"image/jpeg"===d&&(P.fillStyle="#FFFFFF",P.fillRect(0,0,b.width,b.height)),m?.includes(y)?[2,g]:(w?.includes(y)&&(d=y),P.drawImage(b,0,0,C,T),S=A.toDataURL(d,h),u.log("downscaling image...",{args:{dataUrl:g,maxWidth:e,maxHeight:i,imageType:d,ignoreImageTypes:m,keepImageTypes:w,imageQuality:h},newHeight:T,newWidth:C}),[2,S])}})})}},function(v,n,l){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ConsoleLogger=void 0;var s=function(){function a(u,g){this.debug=u,this.suppressErrorLogging=g}return a.prototype.prefixString=function(){return"</> quill-image-compress: "},Object.defineProperty(a.prototype,"log",{get:function(){return this.debug?console.log.bind(console,this.prefixString()):function(){}},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"error",{get:function(){return this.suppressErrorLogging?function(){}:console.error.bind(console,this.prefixString())},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"warn",{get:function(){return this.suppressErrorLogging?function(){}:console.warn.bind(console,this.prefixString())},enumerable:!1,configurable:!0}),a}();n.ConsoleLogger=s}])}}]);