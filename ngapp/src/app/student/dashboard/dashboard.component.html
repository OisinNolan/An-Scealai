<!-- STORY TITLE HEADER-->
<div class="storyTitleHeader">
  <!-- TITLE -->
  <div class="storyTitle" [ngStyle]="titleStyle()" data-cy="title">
    {{ story?.title ?? "..." }}
    <span *ngIf="!storySaved">*</span>
    <span style="color: rgba(0, 0, 0, 0.4)" *ngIf="story.createdWithPrompts">{{
      ts.l.made_using_prompts
    }}</span>
  </div>

  <!-- SAVE ICON  -->
  <div class="saveIcon">
    <div *ngIf="storySaved" class="savedIcon">
      {{ ts.l.saved }} <i class="fas fa-check"></i>
    </div>
    <div *ngIf="!storySaved" class="savedIcon">
      {{ ts.l.saving }}
      <i class="fas fa-save"> </i>
    </div>
  </div>
</div>

<!-- STORY OPTIONS TOOL BAR -->
<div class="optionsBtnContainer" (click)="toggleOptions()">
  <div class="optionsBtn">
    <i *ngIf="!showOptions" class="fas fa-chevron-down"></i>
    <i *ngIf="showOptions" class="fas fa-chevron-right"></i>
  </div>

  <!-- SPEECH TO TEXT-->
  <div
    *ngIf="showOptions"
    class="optionsBtn optionsPopupBtn"
    (click)="this.dontToggle = true; speakStory()"
    [ngClass]="{ disableDiv: isTranscribing }"
  >
    {{ ts.l.speak }}
    <!-- Google icon, index.html-->
    <span *ngIf="!isRecording" class="material-symbols-outlined optionsBtnIcon"
      >speech_to_text</span
    >
    <button
      *ngIf="isRecording && !isTranscribing"
      class="notRecordingBtn blink"
    >
      <i class="fas fa-stop-circle"></i>
    </button>
    <div *ngIf="isTranscribing"><div class="dot-flashing"></div></div>
  </div>

  <!-- DOWNLOAD -->
  <div *ngIf="showOptions" style="display: flex" (click)="dontToggle = true">
    <button
      (click)="downloadStory()"
      style="text-decoration: none"
      class="optionsBtn optionsPopupBtn"
      target="_blank"
      href="{{ downloadStoryUrl() }}"
    >
      {{ ts.l.download }}
      <i class="fas fa-download optionsBtnIcon"></i>
    </button>
  </div>

  <!-- FEEDBACK -->
  <div
    *ngIf="showOptions"
    class="optionsBtn optionsPopupBtn"
    (click)="this.dontToggle = true; getFeedback()"
  >
    {{ ts.l.feedback }}
    <i class="fas fa-comment-dots optionsBtnIcon"></i>
    <span class="notificationBtn" *ngIf="hasNewFeedback()">1</span>
  </div>

  <!-- DICTIONARY -->
  <div
    *ngIf="showOptions"
    class="optionsBtn optionsPopupBtn"
    (click)="
      this.dontToggle = true; this.dictionaryVisible = !this.dictionaryVisible
    "
  >
    {{ ts.l.dictionary }}
    <i class="fas fa-book optionsBtnIcon"></i>
  </div>

  <!-- AUDIO CHECK -->
  <div
    *ngIf="showOptions"
    class="optionsBtn optionsPopupBtn"
    (click)="this.dontToggle = true; goToSynthesis()"
  >
    {{ ts.l.audio_check }}
    <i class="fas fa-volume-up optionsBtnIcon"></i>
  </div>

  <!-- GRAMMAR CHECK -->
  <div
    *ngIf="showOptions"
    class="optionsBtn optionsPopupBtn"
    (click)="this.dontToggle = true; toggleGrammarTags()"
  >
    {{ toggleGrammarButton() }}
    <i class="fas fa-spell-check optionsBtnIcon"></i>
  </div>

  <!-- RECORDINGS -->
  <div
    *ngIf="showOptions"
    [hidden]="story.text && story.text.length === 0"
    class="optionsBtn optionsPopupBtn"
    (click)="this.dontToggle = true; goToRecording()"
  >
    {{ ts.l.recordings }}
    <i class="fas fa-microphone optionsBtnIcon"></i>
  </div>
</div>

<!-- BODY CONTAINER-->
<mat-drawer-container class="bodyContainer" autosize>
  <mat-drawer #drawer class="example-sidenav" mode="side">
    <p>Auto-resizing sidenav</p>
    <p *ngIf="showFiller">Lorem, ipsum dolor sit amet consectetur.</p>
    <button (click)="showFiller = !showFiller" mat-raised-button>
      Toggle extra text
    </button>
  </mat-drawer>

  <div class="example-sidenav-content">
    <button type="button" mat-button (click)="drawer.toggle()">
      Toggle sidenav
    </button>
    <button type="button" mat-button (click)="drawer2.toggle()">
      Toggle sidenav 2
    </button>
  </div>

  <mat-drawer #drawer2 class="example-sidenav" mode="side" position="end">
    <p>Auto-resizing sidenav</p>
    <p *ngIf="showFiller">Lorem, ipsum dolor sit amet consectetur.</p>
    <button (click)="showFiller = !showFiller" mat-raised-button>
      Toggle extra text
    </button>
  </mat-drawer>
</mat-drawer-container>
